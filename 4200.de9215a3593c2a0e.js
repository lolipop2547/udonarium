(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4200],{4200:(de,ve,fe)=>{fe(9993),Opal.modules["bcdice/dice_table/table"]=function(n){var j,d,i,c,f,p,N,V,T,P=[],a=n.nil,s=n.module,e=n.klass,B=n.hash2,y=n.defs,K=n.truthy,$=n.def,C=n.rb_minus;return j=P,d=T=[s(P[0],"BCDice")].concat(j),i=V=[s(T[0],"DiceTable")].concat(d),f=[c=e(V[0],null,"Table")].concat(i),p=n.$r(f),(N=c.$$prototype).times=N.sides=N.name=N.items=a,y(c,"$from_i18n",function(D,m){var o=a;return o=p("I18n").$t(D,B(["locale"],{locale:m})),this.$new(o["$[]"]("name"),o["$[]"]("type"),o["$[]"]("items"))},2),$(c,"$initialize",function(D,m,b){var o=this,l=a;return o.name=D,o.items=b.$freeze(),l=/(\d+)D(\d+)/i.$match(m),K(l)||o.$raise(p("ArgumentError"),"Unexpected table type: "+m),o.times=l["$[]"](1).$to_i(),o.sides=l["$[]"](2).$to_i()},3),$(c,"$roll",function(D){var b,m=this;return b=D.$roll_sum(m.times,m.sides),m.$choice(b)},1),$(c,"$choice",function(D){var b,m=this;return b=C(D,m.times),p("RollResult").$new(m.name,D,m.items["$[]"](b))},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(n){var L,q,c,f,p,N,R,Z,M,P=[],a=n.nil,s=n.module,e=n.klass,B=n.hash2,y=n.defs,K=n.def,$=n.rb_plus,C=n.rb_times,Y=n.rb_minus;return L=P,q=M=[s(P[0],"BCDice")].concat(L),c=Z=[s(M[0],"DiceTable")].concat(q),p=[f=e(Z[0],null,"D66GridTable")].concat(c),N=n.$r(p),(R=f.$$prototype).name=R.items=a,y(f,"$from_i18n",function(m,b){var l=a;return l=N("I18n").$t(m,B(["locale","raise"],{locale:b,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("items"))},2),K(f,"$initialize",function(m,b){return this.name=m,this.items=b.$freeze()},2),K(f,"$roll",function(m){var o,l,w,h,E;return o=m.$roll_once(6),l=m.$roll_once(6),w=$(C(o,10),l),h=Y(o,1),E=Y(l,1),N("RollResult").$new(this.name,w,this.items["$[]"](h)["$[]"](E))},1)},Opal.modules["bcdice/arithmetic/node"]=function(n){var d,k,p,o,l,R,D,c,V,P=[],a=n.nil,s=n.$$$,e=n.module,B=n.klass,y=n.def,K=n.send2,$=n.find_super,C=n.eqeq,Y=n.const_set,j=n.eqeqeq,L=n.rb_divide,T=n.alias;return d=P,k=V=[e(P[0],"BCDice")].concat(d),p=c=[e(V[0],"Arithmetic")].concat(k),R=[e(c[0],"Node")].concat(p),D=n.$r(R),(l=(o=B(R[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=a,y(o,"$initialize",function(h,E,A){var v=this;return v.lhs=h,v.op=E,v.rhs=A},3),y(o,"$eval",function(h){var v,E=this,A=a;return A=E.lhs.$eval(h),v=E.rhs.$eval(h),A.$send(E.op,v)},1),y(o,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()},0),y(o,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"},0),y(o,"$op_for_s_exp",function(){return this.op},0),function(m,b,o){var l=B(m,b,"DivideBase"),w=[l].concat(o),h=n.$r(w),E=l.$$prototype;E.lhs=E.rhs=E.op=a,y(l,"$initialize",function A(v,z){return delete A.$$p,K(this,$(this,"initialize",A,!1,!0),"initialize",[v,"/",z],null)},2),y(l,"$eval",function(v){var G,F,z=this;return G=z.lhs.$eval(v),F=z.rhs.$eval(v),C(F,0)&&z.$raise(h("ZeroDivisionError")),z.$divide_and_round(G,F,v)},1),y(l,"$output",function A(){var v=A.$$p||a,z=this;return delete A.$$p,""+K(z,$(z,"output",A,!1,!0),"output",[],v)+z.$rounding_method()},0),l.$private(),y(l,"$rounding_method",function(){return s(this.$class(),"ROUNDING_METHOD")},0),y(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),y(l,"$divide_and_round",function(v,z,G){return this.$raise(h("NotImplementedError"))},3)}(R[0],D("BinaryOp"),R),function(m,b,o){var l=B(m,b,"DivideWithGameSystemDefault"),w=[l].concat(o),h=n.$r(w);Y(w[0],"ROUNDING_METHOD",""),l.$private(),y(l,"$divide_and_round",function(A,v,z){var G;return j(s(h("RoundType"),"CEIL"),G=z)?L(A.$to_f(),v).$ceil():j(s(h("RoundType"),"ROUND"),G)?L(A.$to_f(),v).$round():L(A,v).$floor()},3)}(R[0],D("DivideBase"),R),function(m,b,o){var l=B(m,b,"DivideWithCeil"),w=[l].concat(o);Y(w[0],"ROUNDING_METHOD","C"),l.$private(),y(l,"$divide_and_round",function(E,A,v){return L(E.$to_f(),A).$ceil()},3)}(R[0],D("DivideBase"),R),function(m,b,o){var l=B(m,b,"DivideWithRound"),w=[l].concat(o);Y(w[0],"ROUNDING_METHOD","R"),l.$private(),y(l,"$divide_and_round",function(E,A,v){return L(E.$to_f(),A).$round()},3)}(R[0],D("DivideBase"),R),function(m,b,o){var l=B(m,b,"DivideWithFloor"),w=[l].concat(o);Y(w[0],"ROUNDING_METHOD","F"),l.$private(),y(l,"$divide_and_round",function(E,A,v){return L(E,A).$to_i()},3)}(R[0],D("DivideBase"),R),function(m,b){var o=B(m,null,"Negative");o.$$prototype.body=a,y(o,"$initialize",function(h){return this.body=h},1),y(o,"$eval",function(h){return this.body.$eval(h)["$-@"]()},1),y(o,"$output",function(){return"-"+this.body.$output()},0),y(o,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(R[0]),function(m,b){var o=B(m,null,"Parenthesis");o.$$prototype.expr=a,y(o,"$initialize",function(h){return this.expr=h},1),y(o,"$eval",function(h){return this.expr.$eval(h)},1),y(o,"$output",function(){return"("+this.expr.$output()+")"},0),y(o,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(R[0]),function(m,b){var o=B(m,null,"Number");return o.$$prototype.value=a,y(o,"$initialize",function(h){return this.value=h},1),y(o,"$eval",function(h){return this.value},1),y(o,"$output",function(){return this.value.$to_s()},0),T(o,"s_exp","output")}(R[0])},Opal.modules["racc/parser"]=function(n){var m,o,l,a=[],s=n.$r(a),e=n.nil,B=n.$$$,y=n.module,K=n.klass,$=n.truthy,C=n.const_set,Y=n.defs,j=n.gvars,L=n.rb_lt,T=n.send,M=n.to_a,d=n.rb_minus,q=n.def,V=n.to_ary,Z=n.neqeq,k=n.rb_plus,i=n.eqeq,c=n.rb_ge,f=n.rb_gt,p=n.eqeqeq,N=n.rb_le,R=n.rb_times;return m=a,o=[y(a[0],"Racc")].concat(m),l=n.$r(o),K(o[0],l("StandardError"),"ParseError"),$(B("::","ParseError","skip_raise")?"constant":e)||C(a[0],"ParseError",B(s("Racc"),"ParseError")),function(D,m){var A,v,z,G,F,l=[y(D,"Racc")].concat(m),w=n.$r(l);return $(w("Racc_No_Extensions","skip_raise")?"constant":e)||C(l[0],"Racc_No_Extensions",!1),A=l,z=[v=K(l[0],null,"Parser")].concat(A),G=n.$r(z),(F=v.$$prototype).yydebug=F.racc_debug_out=F.racc_error_status=F.racc_t=F.racc_vstack=F.racc_val=F.racc_state=F.racc_tstack=e,C(z[0],"Racc_Runtime_Version","1.4.6"),C(z[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),C(z[0],"Racc_Runtime_Core_Version_R","1.4.6"),C(z[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),C(z[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),C(z[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),C(z[0],"Racc_Runtime_Core_Version",G("Racc_Runtime_Core_Version_R")),C(z[0],"Racc_Runtime_Core_Revision",G("Racc_Runtime_Core_Revision_R")),C(z[0],"Racc_Runtime_Type","ruby"),Y(G("Parser"),"$racc_runtime_type",function(){return G("Racc_Runtime_Type")},0),q(v,"$_racc_setup",function(){var u,g,r=this,_=e,t=e,x=e;return null==j.stderr&&(j.stderr=e),$(B(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),$(null!=(u=r.yydebug)&&u!==e?"instance-variable":e)||(r.yydebug=!1),$(r.yydebug)&&($(null!=(g=r.racc_debug_out)&&g!==e?"instance-variable":e)||(r.racc_debug_out=j.stderr),r.racc_debug_out=$(_=r.racc_debug_out)?_:j.stderr),t=B(r.$class(),"Racc_arg"),$(L(t.$size(),14))&&(T(t,"[]=",M(x=[13,!0])),d(x.length,1)),t},0),q(v,"$_racc_init_sysvars",function(){var u=this;return u.racc_state=[0],u.racc_tstack=[],u.racc_vstack=[],u.racc_t=e,u.racc_val=e,u.racc_read_next=!0,u.racc_user_yyerror=!1,u.racc_error_status=0},0),q(v,"$do_parse",function(){return this.$__send__(G("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),q(v,"$next_token",function(){return this.$raise(G("NotImplementedError"),this.$class()+"#next_token is not defined")},0),q(v,"$_racc_do_parse_rb",function(u,g){var r,t=this,x=e,O=e,U=e,ne=e,ce=e,J=e,ee=e,H=e;return r=V(u),x=null==r[0]?e:r[0],O=null==r[1]?e:r[1],U=null==r[2]?e:r[2],ne=null==r[3]?e:r[3],ce=null==r[10]?e:r[10],t.$_racc_init_sysvars(),J=ee=H=e,T(t,"catch",["racc_end_parse"],function W(){var re,te,S=null==W.$$s?this:W.$$s,se=e;for(null==S.racc_state&&(S.racc_state=e),null==S.racc_read_next&&(S.racc_read_next=e),null==S.racc_t&&(S.racc_t=e),null==S.yydebug&&(S.yydebug=e),null==S.racc_val&&(S.racc_val=e);$(!0);)for($(H=ne["$[]"](S.racc_state["$[]"](-1)))?($(S.racc_read_next)&&Z(S.racc_t,0)&&(te=S.$next_token(),re=V(te),J=null==re[0]?e:re[0],S.racc_val=null==re[1]?e:re[1],S.racc_t=$(J)?$(se=ce["$[]"](J))?se:1:0,$(S.yydebug)&&S.$racc_read_token(S.racc_t,J,S.racc_val),S.racc_read_next=!1),H=k(H,S.racc_t),$(c(H,0))&&$(ee=x["$[]"](H))&&i(O["$[]"](H),S.racc_state["$[]"](-1))||(ee=U["$[]"](S.racc_state["$[]"](-1)))):ee=U["$[]"](S.racc_state["$[]"](-1));$(ee=S.$_racc_evalact(ee,u)););},{$$arity:0,$$s:t})},2),q(v,"$yyparse",function(u,g){return this.$__send__(G("Racc_YY_Parse_Method"),u,g,this.$_racc_setup(),!0)},2),q(v,"$_racc_yyparse_rb",function(u,g,r,_){var t,O=this,U=e,ne=e,X=e,ce=e,ee=e,H=e,W=e;return t=V(r),U=null==t[0]?e:t[0],ne=null==t[1]?e:t[1],X=null==t[2]?e:t[2],ce=null==t[3]?e:t[3],ee=null==t[10]?e:t[10],O.$_racc_init_sysvars(),H=e,W=e,T(O,"catch",["racc_end_parse"],function ie(){var S=null==ie.$$s?this:ie.$$s;for(null==S.racc_state&&(S.racc_state=e);!$(W=ce["$[]"](S.racc_state["$[]"](-1)));)for(;$(H=S.$_racc_evalact(X["$[]"](S.racc_state["$[]"](-1)),r)););return T(u,"__send__",[g],function se(ae,_e){var Q=null==se.$$s?this:se.$$s,ue=e,le=e;for(null==Q.racc_t&&(Q.racc_t=e),null==Q.racc_state&&(Q.racc_state=e),null==Q.racc_read_next&&(Q.racc_read_next=e),null==ae&&(ae=e),null==_e&&(_e=e),Q.racc_t=$(ae)?$(ue=ee["$[]"](ae))?ue:1:0,Q.racc_val=_e,Q.racc_read_next=!1,W=k(W,Q.racc_t),$(c(W,0))&&$(H=U["$[]"](W))&&i(ne["$[]"](W),Q.racc_state["$[]"](-1))||(H=X["$[]"](Q.racc_state["$[]"](-1)));$(H=Q.$_racc_evalact(H,r)););for(;$($(ue=$(le=(W=ce["$[]"](Q.racc_state["$[]"](-1)))["$!"]())?le:Q.racc_read_next["$!"]())?ue:Q.racc_t["$=="](0));)for($(W)&&$(W=k(W,Q.racc_t))&&$(c(W,0))&&$(H=U["$[]"](W))&&i(ne["$[]"](W),Q.racc_state["$[]"](-1))||(H=X["$[]"](Q.racc_state["$[]"](-1)));$(H=Q.$_racc_evalact(H,r)););},{$$arity:2,$$s:S})},{$$arity:0,$$s:O})},4),q(v,"$_racc_evalact",function(u,g){var r,X,t=this,x=e,O=e,ne=e,ce=e,J=e,ee=e,H=e;if(x=null==(r=V(g))[0]?e:r[0],O=null==r[1]?e:r[1],ne=null==r[3]?e:r[3],X=null==r[11]?e:r[11],ce=null==r[12]?e:r[12],$(f(u,0))&&$(L(u,X)))$(f(t.racc_error_status,0))&&(i(t.racc_t,1)||(t.racc_error_status=d(t.racc_error_status,1))),t.racc_vstack.$push(t.racc_val),t.racc_state.$push(u),t.racc_read_next=!0,$(t.yydebug)&&(t.racc_tstack.$push(t.racc_t),t.$racc_shift(t.racc_t,t.racc_tstack,t.racc_vstack));else if($(L(u,0))&&$(f(u,ce["$-@"]()))){if(J=T(t,"catch",["racc_jump"],function W(){var ie=null==W.$$s?this:W.$$s;return null==ie.racc_state&&(ie.racc_state=e),ie.racc_state.$push(ie.$_racc_do_reduce(g,u)),!1},{$$arity:0,$$s:t}),$(J)){if(p(1,ee=J))return t.racc_user_yyerror=!0,ce["$-@"]();if(p(2,ee))return X;t.$raise("[Racc Bug] unknown jump code")}}else if(i(u,X))$(t.yydebug)&&t.$racc_accept(),t.$throw("racc_end_parse",t.racc_vstack["$[]"](0));else{if(i(u,ce["$-@"]())){for(p(0,ee=t.racc_error_status)?$(g["$[]"](21))||t.$on_error(t.racc_t,t.racc_val,t.racc_vstack):p(3,ee)&&(i(t.racc_t,0)&&t.$throw("racc_end_parse",e),t.racc_read_next=!0),t.racc_user_yyerror=!1,t.racc_error_status=3;$(!0)&&!($(H=ne["$[]"](t.racc_state["$[]"](-1)))&&(H=k(H,1),$(c(H,0))&&$(u=x["$[]"](H))&&i(O["$[]"](H),t.racc_state["$[]"](-1))));)$(N(t.racc_state.$size(),1))&&t.$throw("racc_end_parse",e),t.racc_state.$pop(),t.racc_vstack.$pop(),$(t.yydebug)&&(t.racc_tstack.$pop(),t.$racc_e_pop(t.racc_state,t.racc_tstack,t.racc_vstack));return u}t.$raise("[Racc Bug] unknown action "+u.$inspect())}return $(t.yydebug)&&t.$racc_next_state(t.racc_state["$[]"](-1),t.racc_state),e},2),q(v,"$_racc_do_reduce",function(u,g){var r,ce,ee,S,se,ae,Q,t=this,O=e,U=e,ne=e,X=e,J=e,H=e,W=e,ie=e,re=e,te=e,_e=e,oe=e,$e=e,ue=e;return O=null==(r=V(u))[4]?e:r[4],U=null==r[5]?e:r[5],ne=null==r[6]?e:r[6],X=null==r[7]?e:r[7],ce=null==r[8]?e:r[8],J=null==r[9]?e:r[9],ee=null==r[13]?e:r[13],H=t.racc_state,W=t.racc_vstack,ie=t.racc_tstack,re=R(g,-3),te=J["$[]"](re),S=J["$[]"](k(re,1)),se=J["$[]"](k(re,2)),ae=[],$(t.yydebug)&&(_e=ie["$[]"](te["$-@"](),te)),oe=W["$[]"](te["$-@"](),te),$(t.yydebug)&&($e=[te["$-@"](),te,ae],T(ie,"[]=",M($e)),d($e.length,1)),$e=[te["$-@"](),te,ae],T(W,"[]=",M($e)),d($e.length,1),$e=[te["$-@"](),te,ae],T(H,"[]=",M($e)),d($e.length,1),$(ee)?W.$push(t.$__send__(se,oe,W,oe["$[]"](0))):W.$push(t.$__send__(se,oe,W)),ie.$push(S),$(t.yydebug)&&t.$racc_reduce(_e,S,ie,W),Q=d(S,ce),$(re=X["$[]"](Q))&&(re=k(re,H["$[]"](-1)),$(c(re,0))&&$(ue=O["$[]"](re))&&i(U["$[]"](re),Q))?ue:ne["$[]"](Q)},2),q(v,"$on_error",function(u,g,r){var t,_=this;return _.$raise(G("ParseError"),_.$sprintf("\nparse error on value %s (%s)",g.$inspect(),$(t=_.$token_to_str(u))?t:"?"))},3),q(v,"$yyerror",function(){return this.$throw("racc_jump",1)},0),q(v,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),q(v,"$yyerrok",function(){return this.racc_error_status=0},0),q(v,"$racc_read_token",function(u,g,r){var _=this;return _.racc_debug_out.$print("read    "),_.racc_debug_out.$print(g.$inspect(),"(",_.$racc_token2str(u),") "),_.racc_debug_out.$puts(r.$inspect()),_.racc_debug_out.$puts()},3),q(v,"$racc_shift",function(u,g,r){var _=this;return _.racc_debug_out.$puts("shift   "+_.$racc_token2str(u)),_.$racc_print_stacks(g,r),_.racc_debug_out.$puts()},3),q(v,"$racc_reduce",function(u,g,r,_){var t=this,x=e;return(x=t.racc_debug_out).$print("reduce "),$(u["$empty?"]())?x.$print(" <none>"):T(u,"each",[],function O(U){return null==U&&(U=e),x.$print(" ",(null==O.$$s?this:O.$$s).$racc_token2str(U))},{$$arity:1,$$s:t}),x.$puts(" --\x3e "+t.$racc_token2str(g)),t.$racc_print_stacks(r,_),t.racc_debug_out.$puts()},4),q(v,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),q(v,"$racc_e_pop",function(u,g,r){var _=this;return _.racc_debug_out.$puts("error recovering mode: pop token"),_.$racc_print_states(u),_.$racc_print_stacks(g,r),_.racc_debug_out.$puts()},3),q(v,"$racc_next_state",function(u,g){var r=this;return r.racc_debug_out.$puts("goto    "+u),r.$racc_print_states(g),r.racc_debug_out.$puts()},2),q(v,"$racc_print_stacks",function(u,g){var _=e;return(_=this.racc_debug_out).$print("        ["),T(u,"each_index",[],function t(x){return null==x&&(x=e),_.$print(" (",(null==t.$$s?this:t.$$s).$racc_token2str(u["$[]"](x))," ",g["$[]"](x).$inspect(),")")},{$$arity:1,$$s:this}),_.$puts(" ]")},2),q(v,"$racc_print_states",function(u){var r=e;return(r=this.racc_debug_out).$print("        ["),T(u,"each",[],function(t){return null==t&&(t=e),r.$print(" ",t)},1),r.$puts(" ]")},1),q(v,"$racc_token2str",function(u){var r;return $(r=B(this.$class(),"Racc_token_to_s_table")["$[]"](u))?r:this.$raise("[Racc Bug] can't convert token "+u+" to string")},1),q(v,"$token_to_str",function(u){return B(this.$class(),"Racc_token_to_s_table")["$[]"](u)},1)}(a[0],a)},Opal.modules.strscan=function(n){var M,d,q,V,Z,P=[],a=n.nil,e=n.def,B=n.truthy,y=n.eqeqeq,K=n.Opal,$=n.send,C=n.to_a,Y=n.rb_minus,j=n.alias;return M=P,q=[d=(0,n.klass)(P[0],null,"StringScanner")].concat(M),V=n.$r(q),(Z=d.$$prototype).pos=Z.string=Z.working=Z.matched=Z.prev_pos=Z.match=a,d.$attr_reader("pos","matched"),e(d,"$initialize",function(i){var c=this;return c.string=i,c.pos=0,c.matched=a,c.working=i,c.match=[]},1),d.$attr_reader("string"),e(d,"$beginning_of_line?",function(){var i=this;return 0===i.pos||"\n"===i.string.charAt(i.pos-1)},0),e(d,"$scan",function(i){var c=this,f=(i=c.$anchor(i)).exec(c.working);return null==f?c.matched=a:"object"==typeof f?(c.prev_pos=c.pos,c.pos+=f[0].length,c.working=c.working.substring(f[0].length),c.matched=f[0],c.match=f,f[0]):"string"==typeof f?(c.pos+=f.length,c.working=c.working.substring(f.length),f):a},1),e(d,"$scan_until",function(i){var c=this;i=c.$anchor(i);for(var N,f=c.pos,p=c.working;;){if(N=i.exec(p),f+=1,p=p.substr(1),null!=N)return c.matched=c.string.substr(c.pos,f-c.pos-1+N[0].length),c.match=N,c.prev_pos=f-1,c.pos=f,c.working=p.substr(N[0].length),c.matched;if(0===p.length)return c.match=[],c.matched=a}},1),e(d,"$[]",function(i){var f;if(B(this.match["$empty?"]()))return a;y(V("Symbol"),f=i)?i=i.$to_s():y(V("String"),f)||(i=K["$coerce_to!"](i,V("Integer"),"to_int"));var p=this.match;return i<0&&(i+=p.length),i<0||i>=p.length||null==p[i]?a:p[i]},1),e(d,"$check",function(i){var c=this,f=(i=c.$anchor(i)).exec(c.working);return c.matched=null==f?a:f[0]},1),e(d,"$check_until",function(i){var c=this,f=c.prev_pos,p=c.pos,N=c.$scan_until(i);return N!==a&&(c.matched=N.substr(-1),c.working=c.string.substr(p)),c.prev_pos=f,c.pos=p,N},1),e(d,"$peek",function(i){return this.working.substring(0,i)},1),e(d,"$eos?",function(){return 0===this.working.length},0),e(d,"$exist?",function(i){var f=i.exec(this.working);return null==f?a:0==f.index?0:f.index+1},1),e(d,"$skip",function(i){var c=this,f=(i=c.$anchor(i)).exec(c.working);if(null==f)return c.match=[],c.matched=a;var p=f[0],N=p.length;return c.matched=p,c.match=f,c.prev_pos=c.pos,c.pos+=N,c.working=c.working.substring(N),N},1),e(d,"$skip_until",function(i){var f=this.$scan_until(i);return f===a?a:(this.matched=f.substr(-1),f.length)},1),e(d,"$get_byte",function(){var i=this,c=a;return i.pos<i.string.length?(i.prev_pos=i.pos,i.pos+=1,c=i.matched=i.working.substring(0,1),i.working=i.working.substring(1)):i.matched=a,c},0),e(d,"$match?",function(i){var c=this,f=(i=c.$anchor(i)).exec(c.working);return null==f?a:(c.prev_pos=c.pos,f[0].length)},1),e(d,"$pos=",function(i){var c=this;return i<0&&(i+=c.string.$length()),c.pos=i,c.working=c.string.slice(i)},1),e(d,"$matched_size",function(){return this.matched===a?a:this.matched.length},0),e(d,"$post_match",function(){var i=this;return i.matched===a?a:i.string.substr(i.pos)},0),e(d,"$pre_match",function(){var i=this;return i.matched===a?a:i.string.substr(0,i.prev_pos)},0),e(d,"$reset",function(){var i=this;return i.working=i.string,i.matched=a,i.pos=0},0),e(d,"$rest",function(){return this.working},0),e(d,"$rest?",function(){return 0!==this.working.length},0),e(d,"$rest_size",function(){return this.$rest().$size()},0),e(d,"$terminate",function(){var c,i=this;return i.match=a,c=[i.string.$length()],$(i,"pos=",C(c)),c[Y(c.length,1)]},0),e(d,"$unscan",function(){var i=this;return i.pos=i.prev_pos,i.prev_pos=a,i.match=a,i},0),j(d,"bol?","beginning_of_line?"),j(d,"getch","get_byte"),d.$private(),e(d,"$anchor",function(i){var c=i.toString().match(/\/([^\/]+)$/);return c=c?c[1]:void 0,new RegExp("^(?:"+i.source+")",c)},1)},Opal.modules["bcdice/normalize"]=function(n){var $,L,Y,P=[],a=n.nil,s=n.module,e=n.eqeqeq,B=n.def,y=n.eqeq;return $=P,Y=[s(P[0],"BCDice")].concat($),(L=s(Y[0],"Normalize")).$module_function(),B(L,"$comparison_operator",function(M){var d;return e(/<=|=</,d=M)?"<=":e(/>=|=>/,d)?">=":e(/<>|!=|=!/,d)?"!=":e(/</,d)?"<":e(/>/,d)?">":e(/=/,d)?"==":a},1),B(L,"$target_number",function(M){return y(M,"?")?M:M.$to_i()},1)},Opal.modules["bcdice/common_command/lexer"]=function(n){var j,d,i,c,f,p,V,T,P=n.top,a=[],s=n.nil,e=n.module,B=n.klass,y=n.const_set,K=n.hash2,$=n.truthy,C=n.def;return P.$require("strscan"),P.$require("bcdice/normalize"),j=a,d=T=[e(a[0],"BCDice")].concat(j),i=V=[e(T[0],"CommonCommand")].concat(d),f=[c=B(V[0],null,"Lexer")].concat(i),p=n.$r(f),c.$$prototype.scanner=s,y(f[0],"SYMBOLS",K(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),C(c,"$initialize",function(D){var b;return D=$(b=D.$split(" ",2).$first())?b:"",this.scanner=p("StringScanner").$new(D)},1),C(c,"$next_token",function(){var D=this,m=s,b=s,o=s,w=s;return $(D.scanner["$eos?"]())?[!1,"$"]:$(m=D.scanner.$scan(/\d+/))?["NUMBER",m.$to_i()]:$(b=D.scanner.$scan(/[<>!=]+/))?["CMP_OP",p("Normalize").$comparison_operator(b)]:(o=D.scanner.$getch().$upcase(),[$(w=p("SYMBOLS")["$[]"](o))?w:o.$to_sym(),o])},0),C(c,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/arithmetic/parser"]=function(n){var L,q,f,D,m,b,o,l,w,h,E,A,G,p,N,R,Z,k,M,P=n.top,a=[],s=n.nil,e=n.$$$,B=n.module,y=n.klass,K=n.defs,$=n.def,C=n.hash,Y=n.const_set;return P.$require("racc/parser.rb"),P.$require("bcdice/common_command/lexer"),P.$require("bcdice/arithmetic/node"),L=a,q=M=[B(a[0],"BCDice")].concat(L),Z=[B(M[0],"Arithmetic")].concat(q),k=n.$r(Z),f=Z,N=[p=y(Z[0],e(k("Racc"),"Parser"),"Parser")].concat(f),R=n.$r(N),p.$$prototype.lexer=s,K(p,"$parse",function(r){return this.$new().$parse(r)},1),$(p,"$parse",function(r){try{return this.lexer=e(e(R("BCDice"),"CommonCommand"),"Lexer").$new(r),this.$do_parse()}catch(t){if(!n.rescue(t,[R("ParseError")]))throw t;try{return s}finally{n.pop_exception()}}},1),p.$private(),$(p,"$next_token",function(){return this.lexer.$next_token()},0),D=[8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,s,s,4,5,4,5,7,9,7,s,s,10,11,s,10,11,22,26,24,25,27],m=[0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,s,s,12,12,13,13,12,1,13,s,s,16,16,s,1,1,16,21,21,21,21],b=[-2,40,-6,s,0,8,s,10,s,1,18,20,28,30,s,s,37,s,4,14,s,47,s,s,s,s,s,s],o=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],l=[14,15,23,1,18,19,s,s,20,21,16],w=[3,3,4,1,2,2,s,s,3,3,1],h=[s,3,-6,-4,-19,s],E=[s,s,2,3,s,6],A=[0,0,"racc_error",3,14,"_reduce_1",3,14,"_reduce_2",1,14,"_reduce_none",3,15,"_reduce_4",4,15,"_reduce_5",1,15,"_reduce_none",0,17,"_reduce_7",1,17,"_reduce_8",1,17,"_reduce_9",1,17,"_reduce_10",1,17,"_reduce_11",2,16,"_reduce_12",2,16,"_reduce_13",1,16,"_reduce_none",3,18,"_reduce_15",1,18,"_reduce_16"],G=C(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),Y(N[0],"Racc_arg",[D,m,o,b,l,w,E,h,13,A,G,28,17,!0]),Y(N[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),Y(N[0],"Racc_debug_parser",!1),$(p,"$_reduce_1",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"BinaryOp").$new(r["$[]"](0),"+",r["$[]"](2))},3),$(p,"$_reduce_2",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"BinaryOp").$new(r["$[]"](0),"-",r["$[]"](2))},3),$(p,"$_reduce_4",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"BinaryOp").$new(r["$[]"](0),"*",r["$[]"](2))},3),$(p,"$_reduce_5",function(r,_,t){return r["$[]"](3).$new(r["$[]"](0),r["$[]"](2))},3),$(p,"$_reduce_7",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(p,"$_reduce_8",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"DivideWithCeil")},3),$(p,"$_reduce_9",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"DivideWithCeil")},3),$(p,"$_reduce_10",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"DivideWithRound")},3),$(p,"$_reduce_11",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"DivideWithFloor")},3),$(p,"$_reduce_12",function(r,_,t){return r["$[]"](1)},3),$(p,"$_reduce_13",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"Negative").$new(r["$[]"](1))},3),$(p,"$_reduce_15",function(r,_,t){return r["$[]"](1)},3),$(p,"$_reduce_16",function(r,_,t){return e(e(R("Arithmetic"),"Node"),"Number").$new(r["$[]"](0))},3),$(p,"$_reduce_none",function(r,_,t){return r["$[]"](0)},3)},Opal.modules["bcdice/arithmetic"]=function(n){var $,L,d,V,Z,T,M,Y,P=n.top,a=[],s=n.nil,e=n.module,B=n.send,y=n.def;return P.$require("bcdice/arithmetic/node"),P.$require("bcdice/arithmetic/parser"),$=a,L=Y=[e(a[0],"BCDice")].concat($),M=[T=e(Y[0],"Arithmetic")].concat(L),V=[d=n.get_singleton_class(T)].concat(M),Z=n.$r(V),y(d,"$eval",function(i,c){var f;try{return(f=Z("Parser").$parse(i))===s||null==f?s:B(f,"eval",[c])}catch(N){if(!n.rescue(N,[Z("ZeroDivisionError")]))throw N;try{return s}finally{n.pop_exception()}}},2)},Opal.queue(function(n){var k,p,o,l,w,h,R,D,c,P=n.top,a=[],s=n.nil,e=n.$$$,B=n.module,y=n.klass,K=n.const_set,$=n.send2,C=n.find_super,Y=n.def,j=n.truthy,L=n.send,T=n.rb_le,M=n.rb_ge,d=n.rb_plus,q=n.rb_lt,V=n.hash2;return P.$require("bcdice/dice_table/table"),P.$require("bcdice/dice_table/d66_grid_table"),P.$require("bcdice/arithmetic"),k=a,p=c=[B(a[0],"BCDice")].concat(k),R=[B(c[0],"GameSystem")].concat(p),D=n.$r(R),o=R,w=[l=y(R[0],D("Base"),"AngelGear")].concat(o),h=n.$r(w),l.$$prototype.randomizer=s,K(w[0],"ID","AngelGear"),K(w[0],"NAME","\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon"),K(w[0],"SORT_KEY","\u3048\u3093\u305b\u308b\u304d\u30422"),K(w[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u3000nAG[s][\xb1a]\n[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\nn:\u5224\u5b9a\u5024\ns:\u6280\u80fd\u5024\na:\u4fee\u6b63\n\uff08\u4f8b\uff09\n12AG 10AG3\xb120\n\n\u30fb\u611f\u60c5\u8868\u3000ET\n"),Y(l,"$initialize",function A(v){var G=this;return delete A.$$p,$(G,C(G,"initialize",A,!1,!0),"initialize",[v],null),G.sort_barabara_dice=!0},1),Y(l,"$eval_game_system_specific_command",function(v){var z,F=s;return j(F=/^(\d+)AG(\d+)?(([+\-]\d+)*)$/.$match(v))?this.$resolute_action(F["$[]"](1).$to_i(),(z=F["$[]"](2))===s||null==z?s:L(z,"to_i",[]),F["$[]"](3),v):this.$roll_tables(v,h("TABLES"))},1),Y(l,"$resolute_action",function(v,z,G,F){var g,x,u=s,r=s,_=s,t=s;return g=(u=this.randomizer.$roll_barabara(v,6).$sort()).$join(","),r=0,_=0,j(z)&&(_=L(u,"count",[],function(U){return null==U&&(U=s),T(U,z)},1),j(G["$empty?"]())||(r=h("Arithmetic").$eval(G,e(h("RoundType"),"FLOOR")))),j(M(d(_,r),100))&&(t="(\u798f\u97f3\u767a\u751f)"),x="("+F+") \uff1e "+_+"["+g+"]"+this.$format("%+d",r)+" \uff1e \u6210\u529f\u6570: "+d(_,r)+t,j(M(d(_,r),100))?h("Result").$critical(x):q(0,d(_,r))?h("Result").$success(x):h("Result").$failure(x)},4),K(w[0],"TABLES",V(["ET"],{ET:e(h("DiceTable"),"D66GridTable").$new("\u611f\u60c5\u8868",[["\u597d\u5947\u5fc3\uff08\u597d\u5947\u5fc3\uff09","\u61a7\u308c\uff08\u3042\u3053\u304c\u308c\uff09","\u5c0a\u656c\uff08\u305d\u3093\u3051\u3044\uff09","\u4ef2\u9593\u610f\u8b58\uff08\u306a\u304b\u307e\u3044\u3057\u304d\uff09","\u6bcd\u6027\u611b\uff08\u307c\u305b\u3044\u3042\u3044\uff09","\u611f\u5fc3\uff08\u304b\u3093\u3057\u3093\uff09"],["\u7d14\u611b\uff08\u3058\u3085\u3093\u3042\u3044\uff09","\u53cb\u60c5\uff08\u3086\u3046\u3058\u3087\u3046\uff09","\u540c\u60c5\uff08\u3069\u3046\u3058\u3087\u3046\uff09","\u7236\u6027\u611b\uff08\u3075\u305b\u3044\u3042\u3044\uff09","\u5e78\u798f\u611f\uff08\u3053\u3046\u3075\u304f\u304b\u3093\uff09","\u4fe1\u983c\uff08\u3057\u3093\u3089\u3044\uff09"],["\u7af6\u4e89\u5fc3\uff08\u304d\u3087\u3046\u305d\u3046\u3057\u3093\uff09","\u89aa\u8fd1\u611f\uff08\u3057\u3093\u304d\u3093\u304b\u3093\uff09","\u307e\u3054\u3053\u308d","\u597d\u610f\uff08\u3053\u3046\u3044\uff09","\u6709\u70ba\uff08\u3086\u3046\u3044\uff09","\u5d07\u62dd\uff08\u3059\u3046\u306f\u3044\uff09"],["\u5927\u5acc\u3044\uff08\u3060\u3044\u304d\u3089\u3044\uff09","\u59ac\u307f\uff08\u306d\u305f\u307f\uff09","\u4fae\u8511\uff08\u3076\u3079\u3064\uff09","\u8150\u308c\u7e01\uff08\u304f\u3055\u308c\u3048\u3093\uff09","\u6050\u6016\uff08\u304d\u3087\u3046\u3075\uff09","\u52a3\u7b49\u611f\uff08\u308c\u3063\u3068\u3046\u304b\u3093\uff09"],["\u504f\u611b\uff08\u3078\u3093\u3042\u3044\uff09","\u5bc2\u3057\u3055\uff08\u3055\u3073\u3057\u3055\uff09","\u6190\u61ab\uff08\u308c\u3093\u3073\u3093\uff09","\u95d8\u4e89\u5fc3\uff08\u3068\u3046\u305d\u3046\u3057\u3093\uff09","\u98df\u50b7\uff08\u3057\u3087\u304f\u3057\u3087\u3046\uff09","\u5618\u3064\u304d\uff08\u3046\u305d\u3064\u304d\uff09"],["\u7518\u3048\uff08\u3042\u307e\u3048\uff09","\u82db\u7acb\u3061\uff08\u3044\u3089\u3060\u3061\uff09","\u4e0b\u5fc3\uff08\u3057\u305f\u3054\u3053\u308d\uff09","\u618e\u60aa\uff08\u305e\u3046\u304a\uff09","\u7591\u60d1\uff08\u304e\u308f\u304f\uff09","\u652f\u914d\uff08\u3057\u306f\u3044\uff09"]])}).$freeze()),l.$register_prefix("\\d+AG",h("TABLES").$keys())})}}]);