(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1175],{1175:($e,ie,ne)=>{ne(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(n){var z,I,T,j,y,x,B,E,q=[],t=n.nil,$=n.$$$,p=n.module,S=n.hash2,M=n.truthy,R=n.def;return z=q,I=E=[p(q[0],"BCDice")].concat(z),B=[x=p(E[0],"ArithmeticEvaluator")].concat(I),j=[T=n.get_singleton_class(x)].concat(B),y=n.$r(j),R(T,"$eval",function(H,K){var w,V=t;if(null==K)K=S([],{});else if(!K.$$is_hash)throw n.ArgumentError.$new("expected kwargs");return null==(w=K.$$smap.round_type)&&(w=$(y("RoundType"),"FLOOR")),M(H)&&M(V=y("Arithmetic").$eval(H,w))?V:0},-2)},Opal.modules["bcdice/dice_table/range_table"]=function(n){var B,y,V,d,F,m,U,H,k,q=[],t=n.nil,$=n.module,p=n.klass,S=n.const_set,M=n.send,R=n.truthy,c=n.def,z=n.to_a,e=n.rb_minus,E=n.eqeqeq,L=n.rb_times,I=n.rb_plus;return B=q,y=k=[$(q[0],"BCDice")].concat(B),V=H=[$(k[0],"DiceTable")].concat(y),F=[d=p(H[0],null,"RangeTable")].concat(V),m=n.$r(F),(U=d.$$prototype).name=U.items=U.num_of_dice=U.num_of_sides=U.formatter=t,S(F[0],"RollResult",M(m("Struct"),"new",["sum","values","content","formatted"],function h(){return(null==h.$$s?this:h.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:d})),S(F[0],"Item",m("Struct").$new("range","content")),S(F[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),S(F[0],"DEFAULT_FORMATTER",M(d,"lambda",[],function(_,r){return null==_&&(_=t),null==r&&(r=t),_.$name()+"("+r.$sum()+") \uff1e "+r.$content()},2)),d.$attr_reader("name"),d.$attr_reader("num_of_dice"),d.$attr_reader("num_of_sides"),c(d,"$initialize",function h(_,r,o){var u,l=h.$$p||t,s=this,i=t;return delete h.$$p,s.name=_.$freeze(),s.formatter=R(u=l)?u:m("DEFAULT_FORMATTER"),i=m("DICE_ROLL_METHOD_RE").$match(r),R(i)||s.$raise(m("ArgumentError"),s.name+": invalid dice roll method: "+r),s.num_of_dice=i["$[]"](1).$to_i(),s.num_of_sides=i["$[]"](2).$to_i(),s.$store(o)},3),c(d,"$fetch",function(_){var o,r=this;return o=M(r.items,"find",[],function(s){return null==s&&(s=t),s.$range()["$include?"](_)},1),R(o)||r.$raise(m("RangeError"),r.name+": value is out of range: "+_),o},1),c(d,"$roll",function(_){var l,s,u,r=this,o=t;return l=(o=_.$roll_barabara(r.num_of_dice,r.num_of_sides)).$sum(),s=m("RollResult").$new(l,o,r.$fetch(l).$content()),u=[r.formatter["$[]"](r,s)],M(s,"formatted=",z(u)),e(u.length,1),s},1),d.$private(),c(d,"$store",function(_){var o,l,r=this;return o=M(_,"map",[],function s(u,i){return null==u&&(u=t),null==i&&(i=t),[(null==s.$$s?this:s.$$s).$coerce_to_int_range(u),i]},{$$arity:2,$$s:r}),l=M(o,"sort_by",[],function(u,i){return null==u&&(u=t),null==i&&(i=t),u.$min()},2),r.$assert_min_sum_is_covered(l),r.$assert_max_sum_is_covered(l),r.$assert_no_gap_or_overlap_in_ranges(l),r.items=M(l,"map",[],function(u,i){return null==u&&(u=t),null==i&&(i=t),m("Item").$new(u,i.$freeze()).$freeze()},2).$freeze(),r},1),c(d,"$coerce_to_int_range",function(_){var o;return E(m("Integer"),o=_)?m("Range").$new(_,_):E(m("Range"),o)&&R(_.$begin()["$is_a?"](m("Integer")))&&R(_.$end()["$is_a?"](m("Integer")))?_:this.$raise(m("TypeError"),this.name+": "+_+" ("+_.$class()+") must be an Integer or a Range with Integers ")},1),c(d,"$assert_min_sum_is_covered",function(_){var o,r=this,l=t;return o=r.num_of_dice,l=_.$first()["$[]"](0),R(l["$include?"](o))||r.$raise(m("RangeError"),r.name+": min value ("+o+") is not covered: "+l),r},1),c(d,"$assert_max_sum_is_covered",function(_){var o,r=this,l=t;return o=L(r.num_of_dice,r.num_of_sides),l=_.$last()["$[]"](0),R(l["$include?"](o))||r.$raise(m("RangeError"),r.name+": max value ("+o+") is not covered: "+l),r},1),c(d,"$assert_no_gap_or_overlap_in_ranges",function(_){return M(_,"each_cons",[2],function o(l,s){var A,a,u=null==o.$$s?this:o.$$s,i=t,C=t;return null==u.name&&(u.name=t),null==l&&(l=t),null==s&&(s=t),i=l["$[]"](0),C=s["$[]"](0),A=i.$max(),a=I(A,1),R(C["$include?"](A))&&u.$raise(m("RangeError"),u.name+": Range overlap: "+i+" and "+C),R(C["$include?"](a))?t:u.$raise(m("RangeError"),u.name+": Range gap: "+i+" and "+C)},{$$arity:2,$$s:this}),this},1)},Opal.queue(function(n){var w,m,l,s,u,i,C,h,_,d,q=n.top,t=[],$=n.nil,p=n.$$$,S=n.module,M=n.klass,R=n.const_set,c=n.truthy,z=n.eqeqeq,e=n.hash2,E=n.def,L=n.send,I=n.neqeq,x=n.rb_ge,B=n.rb_le,T=n.eqeq,k=n.rb_gt,j=n.rb_lt,y=n.rb_plus,P=n.rb_minus,H=n.range;return q.$require("bcdice/arithmetic_evaluator"),q.$require("bcdice/dice_table/range_table"),w=t,m=d=[S(t[0],"BCDice")].concat(w),h=[S(d[0],"GameSystem")].concat(m),_=n.$r(h),l=h,u=[s=M(h[0],_("Base"),"MetalHead")].concat(l),i=n.$r(u),(C=s.$$prototype).round_type=C.randomizer=$,R(u[0],"ID","MetalHead"),R(u[0],"NAME","\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9"),R(u[0],"SORT_KEY","\u3081\u305f\u308b\u3078\u3064\u3068"),R(u[0],"HELP_MESSAGE","\u30fb\u30a2\u30d3\u30ea\u30c6\u30a3\u30ed\u30fc\u30eb  AR>=\u76ee\u6a19\u5024\n\u30fb\u30b9\u30ad\u30eb\u30ed\u30fc\u30eb      SR<=\u76ee\u6a19\u5024(%)\n\u30fb\u547d\u4e2d\u5224\u5b9a\u30ed\u30fc\u30eb    HR<=\u76ee\u6a19\u5024(%)\n\n  \u4f8b\uff09AR>=5\n  \u4f8b\uff09SR<=(40+25)\n  \u4f8b\uff09HR<=(50-10)\n\n  \u3053\u308c\u3089\u306e\u30ed\u30fc\u30eb\u3067\u6210\u5426\u3001\u7d76\u5bfe\u6210\u529f/\u7d76\u5bfe\u5931\u6557\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb/\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30c1\u30e3\u30fc\u30c8  CC\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u30c1\u30e3\u30fc\u30c8  \u5c04\u6483\u30fb\u6295\u64f2\u7528:ACL  \u683c\u95d8\u7528:ACS\n\u30fb\u6226\u95d8\u7d50\u679c\u30c1\u30e3\u30fc\u30c8      CRCsn   s=\u8010\u4e45\u30ec\u30d9\u30eb(SUV) n=\u6570\u5024\n\n  \u4f8b\uff09CRCA61 SUV=A\u3092\u5bfe\u8c61\u3068\u3057\u305f\u6570\u502461(62\u306b\u5909\u63db\u3055\u308c\u308b)\u306e\u6226\u95d8\u7d50\u679c\u3092\u53c2\u7167\u3059\u308b\u3002\n  \u4f8b\uff09CRCM98 \u5bfe\u7269\u3067\u6570\u502498\u306e\u6226\u95d8\u7d50\u679c\u3092\u53c2\u7167\u3059\u308b\u3002\n"),s.$register_prefix("AR","SR","HR<=","CC","ACT","ACL","ACS","CRC[A-Z]"),E(s,"$eval_game_system_specific_command",function(a){var v,f=this,b=$,W=$,g=$,D=$;return v=f.$roll_tables(a,i("TABLES")),c(v)?v:z(/^CRC(\w)(\d+)$/,b=a)?(W=i("Regexp").$last_match(1),g=i("Regexp").$last_match(2),f.$mh_crc_table(W,g)):z(/^HR<=(.+)/,b)?(D=i("ArithmeticEvaluator").$eval(i("Regexp").$last_match(1),e(["round_type"],{round_type:f.round_type})),f.$rollHit(D)):$},1),E(s,"$change_text",function(a){return a=L(a,"gsub",[/^(S)?AR/i],function(){return i("Regexp").$last_match(1)+"2D6"},0),L(a,"gsub",[/^(S)?SR/i],function(){return i("Regexp").$last_match(1)+"1D100"},0)},1),E(s,"$result_2d6",function(a,f,v,b,W){return I(b,">=")?$:c(x(f,12))?i("Result").$critical("\u7d76\u5bfe\u6210\u529f"):c(B(f,2))?i("Result").$fumble("\u7d76\u5bfe\u5931\u6557"):$},5),E(s,"$rollHit",function(a){var v;return"(1D100<="+a+") \uff1e "+(v=this.randomizer.$roll_once(100))+this.$getHitResult(v,v,a)},1),E(s,"$result_1d100",function(a,f,v,b){return T(v,"<=")?c(B(f,5))?i("Result").$critical("\u7d76\u5bfe\u6210\u529f"):c(x(f,96))?i("Result").$fumble("\u7d76\u5bfe\u5931\u6557"):$:$},4),E(s,"$getHitResult",function(a,f,v){var g;return g=a["$%"](100)["$%"](10),this.$debug("total_n",a),c(k(a,v))?" \uff1e \u5931\u6557":T(g,1)?" \uff1e \u6210\u529f\uff08\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff09":T(g,0)?" \uff1e \u5931\u6557\uff08\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\uff09":" \uff1e \u6210\u529f"},3),E(s,"$mh_crc_table",function(a,f){var b,W,v=this,g=$,D=$,Q=$,J=$,N=$,G=$;return b=["\u6226\u95d8\u7d50\u679c\u30c1\u30e3\u30fc\u30c8",f],W=" \uff1e ",a=a.$to_s().$upcase(),g=f.$to_i(),c(j(g,1))?y(b,["\u6570\u5024\u304c\u4e0d\u6b63\u3067\u3059"]).$join(W):(D=g["$%"](10),v.$debug("num_d1["+D+"]"),T(D,1)&&(g=y(g,1)),T(D,0)&&(g=P(g,1)),D=g["$%"](10),v.$debug("num_d1["+D+"]"),Q=[$,$,"\u8155\u90e8","\u8155\u90e8","\u811a\u90e8","\u811a\u90e8","\u80f4\u90e8","\u80f4\u90e8","\u80f4\u90e8","\u982d\u90e8"],J=e(["S","A","B","C","D","E","F","G","M"],{S:[e(["N"],{N:2}),e(["LW"],{LW:16}),e(["MD"],{MD:46}),e(["MW"],{MW:56}),e(["HD"],{HD:76}),e(["HW"],{HW:96}),e(["MO"],{MO:106}),e(["K"],{K:116})],A:[e(["LW"],{LW:2}),e(["MW"],{MW:46}),e(["HW"],{HW:76}),e(["MO"],{MO:96}),e(["K"],{K:116})],B:[e(["LW"],{LW:2}),e(["MW"],{MW:36}),e(["HW"],{HW:66}),e(["MO"],{MO:96}),e(["K"],{K:106})],C:[e(["LW"],{LW:2}),e(["MW"],{MW:26}),e(["HW"],{HW:66}),e(["MO"],{MO:86}),e(["K"],{K:106})],D:[e(["LW"],{LW:2}),e(["MW"],{MW:26}),e(["HW"],{HW:46}),e(["MO"],{MO:76}),e(["K"],{K:96})],E:[e(["LW"],{LW:2}),e(["MW"],{MW:26}),e(["HW"],{HW:39}),e(["MO"],{MO:54}),e(["K"],{K:76})],F:[e(["LW"],{LW:2}),e(["MW"],{MW:16}),e(["HW"],{HW:39}),e(["MO"],{MO:54}),e(["K"],{K:66})],G:[e(["LW"],{LW:2}),e(["MW"],{MW:6}),e(["HW"],{HW:16}),e(["MO"],{MO:26}),e(["K"],{K:39})],M:[e(["0"],{0:2}),e(["1"],{1:22}),e(["2"],{2:42}),e(["3"],{3:62}),e(["4"],{4:82}),e(["5"],{5:92}),e(["6"],{6:102}),e(["8"],{8:112})]}),c(J["$[]"](a)["$nil?"]())?y(b,["\u8010\u4e45\u30ec\u30d9\u30eb(SUV)["+a+"]","\u8010\u4e45\u30ec\u30d9\u30eb(SUV)\u306e\u5024\u304c\u4e0d\u6b63\u3067\u3059"]).$join(W):(N="",L(J["$[]"](a),"each",[],function O(X){return null==X&&(X=$),L(X,"each",[],function ee(Y,Z){return null==Y&&(Y=$),null==Z&&(Z=$),(null==ee.$$s?this:ee.$$s).$debug("suv["+a+"] "+X+" "+Y+" "+Z),c(B(Z,g))?N=Y:$},{$$arity:2,$$s:null==O.$$s?this:O.$$s})},{$$arity:1,$$s:v}),G=[],I(g,f.$to_i())&&G.$push(g.$to_s()),T(a,"M")?G.$push("\u8010\u7269","HP["+N+"]"):G.$push("\u8010\u4e45\u30ec\u30d9\u30eb(SUV)["+a+"]","\u90e8\u4f4d["+Q["$[]"](D)+"] \uff1a \u640d\u50b7\u7a2e\u5225["+N+"]"),y(b,G).$join(W)))},2),R(u[0],"TABLE_ROLL_RESULT_FORMATTER",L(s,"lambda",[],function(a,f){return null==a&&(a=$),null==f&&(f=$),[a.$name(),f.$sum(),f.$content()].$join(" \uff1e ")},2)),R(u[0],"TABLES",e(["CC","ACL","ACS"],{CC:L(p(i("DiceTable"),"RangeTable"),"new",["\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30c1\u30e3\u30fc\u30c8","1D10",[[1,"\u76f8\u624b\u306f\u77e5\u899a\u7cfb\u306b\u591a\u5927\u306a\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u305f\u3002PER\u30921\u306b\u3057\u3066\u982d\u90e8\u306bHW\u306e\u30c0\u30e1\u30fc\u30b8\u3001\u304a\u3088\u3073\u5fc3\u7406\u30c1\u30a7\u30c3\u30af\u3002"],[2,"\u76f8\u624b\u306e\u904b\u52d5\u795e\u7d4c\u3092\u65ad\u3061\u5207\u3063\u305f\u3002DEX\u30921\u306b\u3057\u3066\u8155\u90e8\u306bHW\u306e\u30c0\u30e1\u30fc\u30b8\u3001\u304a\u3088\u3073\u5fc3\u7406\u30c1\u30a7\u30c3\u30af\u3002\u3055\u3089\u306b\u8155\u306b\u6301\u3063\u3066\u3044\u305f\u6b66\u5668\u306a\u3069\u306f\u843d\u3068\u3057\u3066\u3057\u307e\u3046\u3002"],[3,"\u76f8\u624b\u306e\u79fb\u52d5\u624b\u6bb5\u306f\u5b8c\u5168\u306b\u596a\u308f\u308c\u305f\u3002REF\u30921\u306b\u3057\u3066\u811a\u90e8\u306bHW\u30c0\u30e1\u30fc\u30b8\u3068\u5fc3\u7406\u30c1\u30a7\u30c3\u30af\u3002\u307e\u305f\u3001\u6b21\u56de\u304b\u3089\u306e\u3053\u3061\u3089\u306e\u653b\u6483\u306f\u5fc5\u305a\u547d\u4e2d\u3059\u308b\u3002"],[H(4,5,!1),"\u76f8\u624b\u306e\u6025\u6240\u306b\u547d\u4e2d\u3002\u6fc0\u75db\u306e\u305f\u3081\u6c17\u7d76\u3057\u305f\u4e0a\u3001\u80f4\u306bHW\u30c0\u30e1\u30fc\u30b8\u3002"],[6,"\u52b9\u679c\u7684\u306a\u4e00\u6483\u3002\u80f4\u306bHW\u30c0\u30e1\u30fc\u30b8\u3002\u5fc3\u7406\u30c1\u30a7\u30c3\u30af\u3002"],[7,"\u52b9\u679c\u7684\u306a\u4e00\u6483\u3002\u80f4\u306bMO\u30c0\u30e1\u30fc\u30b8\u3002\u5fc3\u7406\u30c1\u30a7\u30c3\u30af\u3002"],[H(8,10,!1),"\u541b\u306e\u4e00\u6483\u306f\u76f8\u624b\u306e\u4e2d\u67a2\u3092\u5b8c\u5168\u306b\u7834\u58ca\u3057\u305f\u3002\u5373\u6b7b\u3067\u3042\u308b\u3002"]]],i("TABLE_ROLL_RESULT_FORMATTER").$to_proc()),ACL:L(p(i("DiceTable"),"RangeTable"),"new",["\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u30c1\u30e3\u30fc\u30c8\uff08\u5c04\u6483\u30fb\u6295\u64f2\uff09","1D10",[[H(1,7,!1),"\u3055\u3055\u3044\u306a\u30df\u30b9\u3002\u7279\u306b\u30da\u30ca\u30eb\u30c6\u30a3\u30fc\u306f\u306a\u3044\u3002"],[8,"\u4e0d\u767a\u3001\u307e\u305f\u306f\u30b8\u30e3\u30e0\u3002\u5f3e\u3092\u53d6\u308a\u51fa\u3055\u306d\u3070\u306a\u3089\u306a\u3044\u7269\u306f\u6b21\u306e\u30bf\u30fc\u30f3\u306f\u5c04\u6483\u3067\u304d\u306a\u3044\u3002"],[9,"\u3055\u3055\u3044\u306a\u6545\u969c\u3002\u53ef\u80fd\u306a\u3089\u6b21\u306e\u30bf\u30fc\u30f3\u304b\u3089\u500b\u5225\u6b66\u5668\u306e\u30b9\u30ad\u30eb\u30ed\u30fc\u30eb\u3067\u4fee\u7406\u3092\u884c\u3048\u308b\u3002"],[10,"\u6b66\u5668\u306e\u66b4\u767a\u3001\u307e\u305f\u306f\u7206\u767a\u3002\u982d\u90e8HW\u306e\u5fc3\u7406\u52b9\u679c\u30ed\u30fc\u30eb\u3002\u3055\u3089\u306b\u3001\u305d\u306e\u6b66\u5668\u306f\u7834\u58ca\u3055\u308cPER\u3068DEX\u306e\u3069\u3061\u3089\u304b\u3001\u307e\u305f\u306f\u4e21\u65b9\u306b\u8a082\u30dd\u30a4\u30f3\u30c8\u306e\u30de\u30a4\u30ca\u30b9\u3092\u4e0e\u3048\u308b\u3002\uff08\u9060\u9694\u64cd\u4f5c\u306e\u5834\u5408\u3001\u5c04\u624b\u3078\u306e\u88ab\u5bb3\u306f\u7121\u3057\uff09"]]],i("TABLE_ROLL_RESULT_FORMATTER").$to_proc()),ACS:L(p(i("DiceTable"),"RangeTable"),"new",["\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u30c1\u30e3\u30fc\u30c8\uff08\u683c\u95d8\uff09","1D10",[[H(1,3,!1),"\u8db3\u3092\u6ed1\u3089\u305b\u3066\u8ee2\u5012\u3057\u3001\u8d77\u304d\u4e0a\u304c\u308b\u307e\u3067\u76f8\u624b\u306b+20\u306e\u547d\u4e2d\u4fee\u6b63\u3092\u4e0e\u3048\u308b\u3002"],[H(4,6,!1),"\u624b\u3092\u6ed1\u3089\u305b\u3066\u3001\u6b66\u5668\u3092\u843d\u3068\u3059\u3002\u7d20\u624b\u306e\u6642\u306f\u95a2\u4fc2\u306a\u3044\u3002"],[H(7,9,!1),"\u4f7f\u7528\u6b66\u5668\u306e\u7834\u58ca\u3002\u7d20\u624b\u6226\u95d8\u306e\u3068\u304d\u306fMW\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002"],[10,"\u624b\u3092\u6ed1\u3089\u305b\u3001\u4e0d\u5e78\u306b\u3082\u6b66\u5668\u306f\u98db\u3093\u3067\u3044\u304d\u30015m\u4ee5\u5185\u306b\u4eba\u304c\u3044\u308c\u3070\u8ab0\u304b\u306b\u523a\u3055\u308b\u304b\u3001\u307e\u305f\u306f\u6253\u6483\u3092\u4e0e\u3048\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u30e9\u30f3\u30c0\u30e0\u306b\u6c7a\u5b9a\u3057\u3001\u666e\u901a\u3069\u304a\u308a\u5224\u5b9a\u3092\u7d9a\u3051\u308b\u3002\u7d20\u624b\u306e\u3068\u304d\u306f\u95a2\u4fc2\u306a\u3044\u3002"]]],i("TABLE_ROLL_RESULT_FORMATTER").$to_proc())}).$freeze())})}}]);