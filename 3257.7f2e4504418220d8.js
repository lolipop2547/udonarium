(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3257],{3257:(J,Q,F)=>{F(9993),Opal.modules["bcdice/game_system/Torg"]=function(o){var L,j,x,s,d,$,G,h,D,I=[],r=o.nil,T=o.module,S=o.klass,y=o.const_set,R=o.send,g=o.def,b=o.truthy,C=o.to_ary,k=o.rb_gt,c=o.rb_plus,M=o.neqeq,q=o.eqeq,K=o.eqeqeq,N=o.rb_lt,p=o.rb_minus,U=o.rb_le,B=o.rb_divide;return L=I,j=D=[T(I[0],"BCDice")].concat(L),G=[T(D[0],"GameSystem")].concat(j),h=o.$r(G),x=G,d=[s=S(G[0],h("Base"),"Torg")].concat(x),$=o.$r(d),s.$$prototype.randomizer=r,y(d[0],"ID","Torg"),y(d[0],"NAME","\u30c8\u30fc\u30b0"),y(d[0],"SORT_KEY","\u3068\u304a\u304f"),y(d[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u3000(TGm)\n\u3000TORG\u5c02\u7528\u306e\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n\u3000"TG(\u6280\u80fd\u57fa\u672c\u5024)"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u5404\u7a2e\u8868\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u4e00\u822c\u7d50\u679c\u8868 \u6210\u529f\u5ea6\u51fa\u529b\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u5a01\u5727/\u5a01\u5687 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cITx or INTIMIDATEx or TESTx\u300d\n\u3000\u30fb\u6311\u767a/\u30c8\u30ea\u30c3\u30af \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cTTx or TAUNTx or TRICKx or CTx\u300d\n\u3000\u30fb\u9593\u5408\u3044 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cMTx or MANEUVERx\u300d\n\u3000\u30fb\u30aa\u30fc\u30ba\uff08\u4e00\u822c\u4eba\uff09\u30c0\u30e1\u30fc\u30b8\u3000\u300cODTx or ORDSx or ODAMAGEx\u300d\n\u3000\u30fb\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u30fc\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),s.$register_prefix("TG","1R20","RT","Result","IT","Intimidate","Test","TT","Taunt","Trick","CT","MT","Maneuver","ODT","ords","odamage","DT","damage","BT","bonus","total"),g(s,"$replace_text",function(t){return t=(t=(t=(t=(t=(t=(t=t.$gsub(/Result/i,"RT")).$gsub(/(Intimidate|Test)/i,"IT")).$gsub(/(Taunt|Trick|CT)/i,"TT")).$gsub(/Maneuver/i,"MT")).$gsub(/(ords|odamage)/i,"ODT")).$gsub(/damage/i,"DT")).$gsub(/(bonus|total)/i,"BT"),(t=R(t,"gsub",[/TG(\d+)/i],function(){return"1R20+"+$("Regexp").$last_match(1)},0)).$gsub(/TG/i,"1R20")},1),g(s,"$torg_check",function(t){var _,e,i=this,n=r,a=r,u=r,l=r,f=r,v=r;return b(/(^|\s)S?(1R20([+-]\d+)*)(\s|$)/i["$=~"](t))?(t=$("Regexp").$last_match(2),n=$("Regexp").$last_match(3),i.$debug(n),b(n)&&(n=$("ArithmeticEvaluator").$eval(n)),i.$debug(n),n=n.$to_i(),e=i.$torg_dice(),u=null==(_=C(e))[1]?r:_[1],l=null==_[2]?r:_[2],f=i.$get_torg_bonus(a=null==_[0]?r:_[0]),v=b(n)?b(k(n,0))?f+"["+l+"]+"+n:f+"["+l+"]"+n:f+"["+l+"]",v=c(v,c(" \uff1e ",c(f,n).$to_s())),M(a,u)&&(v=c(v,c(c("(\u6280\u80fd\u7121",c(i.$get_torg_bonus(u),n).$to_s()),")"))),v="("+t+") \uff1e "+v):r},1),g(s,"$torg_dice",function(){var e=r,i=r,n=r,a=r,u=r,l=r;for(e=!0,i=!0,n=0,a=0,u="";b(e);)l=this.randomizer.$roll_once(20),n=c(n,l),b(i)&&(a=c(a,l)),b(u["$empty?"]())||(u=c(u,",")),u=c(u,l.$to_s()),q(l,20)?i=!1:M(l,10)&&(e=!1,i=!1);return[n,a,u]},0),g(s,"$eval_game_system_specific_command",function(t){var _,e,a,i=this,n=r,u=r,l=r,f=r,v=r,O=r,A=r;return n=t.$upcase(),n=i.$replace_text(n),b(a=i.$torg_check(n))?a:(u="1",l="",f=0,b(/([RITMDB]T)(\d+([+\-]\d+)*)/i["$=~"](n))?(v=$("Regexp").$last_match(1),O=$("Regexp").$last_match(2),K("RT",A=v)?(f=$("ArithmeticEvaluator").$eval(O),u=i.$get_torg_success_level(f),l="\u4e00\u822c\u7d50\u679c"):K("IT",A)?(f=$("ArithmeticEvaluator").$eval(O),u=i.$get_torg_interaction_result_intimidate_test(f),l="\u5a01\u5727/\u5a01\u5687"):K("TT",A)?(f=$("ArithmeticEvaluator").$eval(O),u=i.$get_torg_interaction_result_taunt_trick(f),l="\u6311\u767a/\u30c8\u30ea\u30c3\u30af"):K("MT",A)?(f=$("ArithmeticEvaluator").$eval(O),u=i.$get_torg_interaction_result_maneuver(f),l="\u9593\u5408\u3044"):K("DT",A)?(f=$("ArithmeticEvaluator").$eval(O),b(n["$=~"](/ODT/i))?(u=i.$get_torg_damage_ords(f),l="\u30aa\u30fc\u30ba\u30c0\u30e1\u30fc\u30b8"):(u=i.$get_torg_damage_posibility(f),l="\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8")):K("BT",A)&&(e=i.$get_torg_bonus_text(O),u=null==(_=C(e))[0]?r:_[0],f=null==_[1]?r:_[1],l="\u30dc\u30fc\u30ca\u30b9"),M(l,"")&&(u=l+"\u8868["+f+"] \uff1e "+u),u):r)},1),g(s,"$get_torg_success_level",function(t){return this.$get_torg_table_result(t,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])},1),g(s,"$get_torg_interaction_result_intimidate_test",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(s,"$get_torg_interaction_result_taunt_trick",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(s,"$get_torg_interaction_result_maneuver",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u75b2\u52b4"],[10,"\u840e\u7e2e\uff0f\u75b2\u52b4"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(s,"$get_torg_table_result",function(t,_){var e=r;return e="1",function(){var i=o.new_brk();try{R(_,"each",[],function(a){var u;return null==a&&(a=r),u=a["$[]"](0),b(k(u,t))&&o.brk(r,i),e=a["$[]"](1)},{$$arity:1,$$brk:i})}catch(n){if(n===i)return n.$v;throw n}}(),e},2),g(s,"$get_torg_damage_ords",function(t){return this.$get_torg_damage(t,4,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15",[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"O3"],[5,"K3"],[6,"\u8ee2\u5012 K\uff0fO4"],[7,"\u8ee2\u5012 K\uff0fO5"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO9"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO10"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO11"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO12"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO13"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO14"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15"]])},1),g(s,"$get_torg_damage_posibility",function(t){return this.$get_torg_damage(t,3,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5",[[0,"1"],[1,"1"],[2,"O1"],[3,"K2"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 O2"],[7,"\u8ee2\u5012 K2"],[8,"\u8ee2\u5012 K2"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K5"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])},1),g(s,"$get_torg_damage",function(t,_,e,i){var a=r,u=r;return b(N(t,0))?"1":(a=p(i.$length(),1),b(U(t,a))?this.$get_torg_table_result(t,i):(u=B(p(t,a),2).$to_i(),c(c("",c(u,_).$to_s()),e)))},4),g(s,"$get_torg_bonus_text",function(t){var n,_=this,e=r,i=r,a=r,u=r;return i=(e=t.$split(/\+/)).$shift().$to_i(),n=$("ArithmeticEvaluator").$eval(e.$join("+")),a=_.$get_torg_bonus(i),_.$debug("TORG BT resultValue",a),_.$debug("TORG BT mod",n),q(n,0)?u=a.$to_s():(u=_.$getTorgBonusOutputTextWhenModDefined(i,a,n),i=i+"+"+n),[u,i]},1),g(s,"$getTorgBonusOutputTextWhenModDefined",function(t,_,e){var i=this;return i.$debug("getTorgBonusOutputTextWhenModDefined value, mod",t,e),b(k(e,0))?_+"["+t+"]+"+e+" \uff1e "+c(_,e):(i.$debug("resultValue",_),i.$debug("mod",e),_+"["+t+"]"+e+" \uff1e "+c(_,e))},3),g(s,"$get_torg_bonus",function(t){var i=r,n=r;return i=this.$get_torg_table_result(t,[[1,-12],[2,-10],[3,-8],[5,-5],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),b(k(t,20))&&(n=c(B(p(t,21),5).$to_i(),1),i=c(i,n)),i},1)},Opal.queue(function(o){var p,L,G,h,E,P,D,Y,B,r=[],T=o.nil,S=o.module,y=o.klass,R=o.const_set,g=o.def,b=o.truthy,C=o.rb_lt,k=o.rb_minus,c=o.rb_le,M=o.rb_divide,q=o.rb_plus,K=o.rb_times;return o.top.$require("bcdice/game_system/Torg"),p=r,L=B=[S(r[0],"BCDice")].concat(p),D=[S(B[0],"GameSystem")].concat(L),Y=o.$r(D),G=D,E=[h=y(D[0],Y("Torg"),"Torg1_5")].concat(G),P=o.$r(E),R(E[0],"ID","Torg1.5"),R(E[0],"NAME","\u30c8\u30fc\u30b01.5\u7248"),R(E[0],"SORT_KEY","\u3068\u304a\u304f1.5"),h.$register_prefix(P("Torg").$prefixes()),g(h,"$get_torg_success_level",function(s){return this.$get_torg_table_result(s,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])},1),g(h,"$get_torg_interaction_result_intimidate_test",function(s){return this.$get_torg_table_result(s,[[0,"\u840e\u7e2e"],[5,"\u6280\u80fd\u306a\u3057"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(h,"$get_torg_interaction_result_taunt_trick",function(s){return this.$get_torg_table_result(s,[[0,"\u840e\u7e2e"],[5,"\u6280\u80fd\u306a\u3057"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(h,"$get_torg_interaction_result_maneuver",function(s){return this.$get_torg_table_result(s,[[0,"\u75b2\u52b4"],[5,"\u840e\u7e2e"],[10,"\u6280\u80fd\u306a\u3057"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),g(h,"$get_torg_damage_ords",function(s){return this.$get_torg_damage(s,4,8,[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"K2"],[5,"\u8ee2\u5012 O3"],[6,"\u8ee2\u5012 K3"],[7,"\u8ee2\u5012 K\uff0fO4"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO4"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO5"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO6"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO6"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO7"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO8"]])},1),g(h,"$get_torg_damage_posibility",function(s){return this.$get_torg_damage(s,3,5,[[0,"1"],[1,"1"],[2,"O1"],[3,"K1"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 K2"],[7,"\u8ee2\u5012 O3"],[8,"\u8ee2\u5012 K3"],[9,"\u8ee2\u5012 K\uff0fO3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO4"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO5"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])},1),g(h,"$get_torg_damage",function(s,d,$,w){var t=T,_=T;return b(C(s,0))?"1":(t=k(w.$length(),1),b(c(s,t))?this.$get_torg_table_result(s,w):(_=M(k(s,t),2).$to_i(),q(d,K(_,1))+"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO"+q($,K(_,1))))},4)})}}]);