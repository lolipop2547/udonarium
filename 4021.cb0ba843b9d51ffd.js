(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4021],{4021:($e,le,ne)=>{ne(9993),Opal.modules["bcdice/game_system/EarthDawn"]=function(l){var X,O,C,q,A,k,Q,L,te,Y,j=[],i=l.nil,r=l.module,J=l.klass,K=l.const_set,P=l.send2,U=l.find_super,T=l.def,c=l.truthy,v=l.rb_gt,z=l.rb_lt,R=l.rb_minus,D=l.eqeqeq,o=l.rb_plus,m=l.neqeq,H=l.eqeq,B=l.rb_ge,V=l.send;return X=j,O=Y=[r(j[0],"BCDice")].concat(X),L=[r(Y[0],"GameSystem")].concat(O),te=l.$r(L),C=L,A=[q=J(L[0],te("Base"),"EarthDawn")].concat(C),k=l.$r(A),(Q=q.$$prototype).string=Q.isFailed=i,K(A[0],"ID","EarthDawn"),K(A[0],"NAME","\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3"),K(A[0],"SORT_KEY","\u3042\u3042\u3059\u3068\u304a\u3093"),K(A[0],"HELP_MESSAGE","\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3000(xEn+k)\n\u30b9\u30c6\u30c3\u30d7x\u3001\u76ee\u6a19\u5024n(\u7701\u7565\u53ef\u80fd\uff09\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9k(D2-D20)\u3067\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u632f\u308a\u8db3\u3057\u3082\u81ea\u52d5\u3002\n\u4f8b\uff099E\u300010E8\u300010E+D12\n"),q.$register_prefix("\\d+e"),T(q,"$initialize",function p(b){var $=this;return delete p.$$p,P($,U($,"initialize",p,!1,!0),"initialize",[b],null),$.sort_add_dice=!0},1),T(q,"$eval_game_system_specific_command",function(b){return this.$ed_step(b)},1),T(q,"$ed_step",function(b){return this.$getStepResult(b)},1),T(q,"$getStepResult",function(b){var s=this,$=i,g=i,n=i,t=i,e=i,u=i,a=i,d=i,S=i,f=i,_=i,h=i,x=i,E=i,y=i,M=i,G=i,F=i,w=i,N=i;return!c(/(\d+)E(\d+)?(\+)?(\d+)?(d\d+)?/i["$=~"](b))||($=0,s.isFailed=!0,g=k("Regexp").$last_match(1).$to_i(),n=0,t=!1,e=0,u=0,c(v(g,40))&&(g=40),c(k("Regexp").$last_match(2))&&(n=k("Regexp").$last_match(2).$to_i(),c(v(n,43))&&(n=42)),c(k("Regexp").$last_match(3))&&(t=k("Regexp").$last_match(3).$to_i()),c(k("Regexp").$last_match(4))&&(e=k("Regexp").$last_match(4).$to_i()),c(k("Regexp").$last_match(5))&&(u=k("Regexp").$last_match(5)),c(z(n,0)))?i:(d=(a=s.$getStepTable())["$[]"](0)["$[]"](R(g,1)),S=a["$[]"](1)["$[]"](R(g,1)),f=a["$[]"](2)["$[]"](R(g,1)),_=a["$[]"](3)["$[]"](R(g,1)),h=a["$[]"](4)["$[]"](R(g,1)),x=a["$[]"](5)["$[]"](R(g,1)),E=a["$[]"](6)["$[]"](R(g,1)),c(t)&&(D(/d20/i,y=u)?S=o(S,e):D(/d12/i,y)?f=o(f,e):D(/d10/i,y)?_=o(_,e):D(/d8/i,y)?h=o(h,e):D(/d6/i,y)?x=o(x,e):D(/d4/i,y)?E=o(E,e):d=o(d,e)),s.string="",s.$debug("d20step, d12step, d10step, d8step, d6step, d4step",S,f,_,h,x,E),$=o($,s.$rollStep(20,S)),$=o($,s.$rollStep(12,f)),$=o($,s.$rollStep(10,_)),$=o($,s.$rollStep(8,h)),$=o($,s.$rollStep(6,x)),$=o($,s.$rollStep(4,E)),c(v(d,0))&&(s.string=o(s.string,"+")),m(d,0)&&(s.string=o(s.string,d.$to_s()),$=o($,d)),s.string=o(s.string," \uff1e "+$),M="\u30b9\u30c6\u30c3\u30d7"+g+" \uff1e "+s.string,H(n,0)||(s.string=o(s.string," \uff1e "),G=a["$[]"](7)["$[]"](R(n,1)),F=a["$[]"](8)["$[]"](R(n,1)),w=a["$[]"](9)["$[]"](R(n,1)),N=a["$[]"](11)["$[]"](R(n,1)),s.string=c(s.isFailed)?o(s.string,"\u81ea\u52d5\u5931\u6557"):c(B($,G))?o(s.string,"\u6700\u826f\u6210\u529f"):c(B($,F))?o(s.string,"\u512a\u6210\u529f"):c(B($,w))?o(s.string,"\u826f\u6210\u529f"):c(B($,n))?o(s.string,"\u6210\u529f"):c(z($,N))?o(s.string,"\u5927\u5931\u6557"):o(s.string,"\u5931\u6557"),M="\u30b9\u30c6\u30c3\u30d7"+g+">="+n+" \uff1e "+s.string),M)},1),T(q,"$getStepTable",function(){return[[-2,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[0,0,0,0,0,1,0,0,0,1,1,2,1,0,0,0,1,0,0,0,1,1,2,1,1,1,1,2,1,1,1,2,3,2,1,1,1,2,1,1,0,0,1,0,0,0,1,0,0,0,1,1,2,1],[0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,2,1,1,1,2,2,1,1,1,1,2,1,1,1,0,0,1,0,0,1,0,0,0,1,0,1,0,0],[0,0,0,1,0,0,0,2,1,1,0,0,0,0,1,0,0,0,2,1,1,0,0,0,0,1,0,0,0,2,1,0,0,0,0,1,0,0,0,2,0,0,0,0,1,0,0,0,2,1,1,0,0,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[6,8,10,12,14,17,19,20,22,24,25,27,29,32,33,35,37,38,39,41,42,44,45,47,48,49,51,52,54,55,56,58,59,60,62,64,65,67,68,70,71,72],[4,6,8,10,11,13,15,16,18,19,21,22,24,26,27,29,30,32,33,34,35,37,38,40,41,42,43,45,46,47,48,49,51,52,53,55,56,58,59,60,61,62],[2,4,6,7,9,10,12,13,14,15,17,18,20,21,22,24,25,26,27,28,29,31,32,33,34,35,36,38,39,40,41,42,43,45,46,47,48,50,51,52,53,54],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],[0,1,1,1,1,2,2,3,4,5,5,6,6,7,8,8,9,10,11,12,13,13,14,15,16,17,18,18,18,20,21,22,23,23,24,25,26,26,27,28,29,30]]},0),T(q,"$rollStep",function(b,s){var $=this,g=i;return $.$debug("rollStep diceType, diceCount, @string",b,s,$.string),g=0,c(v(s,0))&&(c($.string["$empty?"]())||($.string=o($.string,"+")),$.string=o($.string,s+"d"+b+"["),$.$debug("rollStep @string",$.string),V(s,"times",[],function n(t){var u=null==n.$$s?this:n.$$s,a=i,d=i;for(null==u.randomizer&&(u.randomizer=i),null==u.string&&(u.string=i),null==t&&(t=i),a=u.randomizer.$roll_once(b),m(a,1)&&(u.isFailed=!1),d=a;H(a,b);)a=u.randomizer.$roll_once(b),d=o(d,a);return g=o(g,d),m(t,0)&&(u.string=o(u.string,",")),u.string=o(u.string,d.$to_s())},{$$arity:1,$$s:$}),$.string=o($.string,"]")),g},2)},Opal.queue(function(l){var O,re,Q,p,b,s,$,C,q,L,i=[],r=l.nil,J=l.module,K=l.klass,P=l.const_set,U=l.send2,T=l.find_super,c=l.def,v=l.truthy,z=l.send,R=l.to_a,D=l.rb_minus,o=l.rb_lt,m=l.rb_plus,H=l.eqeq,B=l.rb_gt,V=l.rb_le,W=l.rb_divide,X=l.to_ary,I=l.rb_ge,Y=l.neqeq;return l.top.$require("bcdice/game_system/EarthDawn"),O=i,re=L=[J(i[0],"BCDice")].concat(O),C=[J(L[0],"GameSystem")].concat(re),q=l.$r(C),Q=C,b=[p=K(C[0],q("EarthDawn"),"EarthDawn3")].concat(Q),s=l.$r(b),($=p.$$prototype).string=$.isFailed=r,P(b[0],"ID","EarthDawn3"),P(b[0],"NAME","\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248"),P(b[0],"SORT_KEY","\u3042\u3042\u3059\u3068\u304a\u30933"),P(b[0],"HELP_MESSAGE","\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3000(xEn+k)\n\u30b9\u30c6\u30c3\u30d7x\u3001\u76ee\u6a19\u5024n(\u7701\u7565\u53ef\u80fd\uff09\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9k(D2\uff5eD20)\u3067\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u632f\u308a\u8db3\u3057\u3082\u81ea\u52d5\u3002\n\u4f8b\uff09\u30b9\u30c6\u30c3\u30d710\uff1a10E\n\u3000\u3000\u30b9\u30c6\u30c3\u30d710\u3001\u76ee\u6a19\u50248\uff1a10E8\n\u3000\u3000\u30b9\u30c6\u30c3\u30d712\u3001\u76ee\u6a19\u50248\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9D12\uff1a10E8+1D6\n"),p.$register_prefix("\\d+e"),c(p,"$initialize",function g(n){var e=this;return delete g.$$p,U(e,T(e,"initialize",g,!1,!0),"initialize",[n],null),e.sort_add_dice=!0},1),c(p,"$eval_game_system_specific_command",function(n){return this.$ed_step(n)},1),c(p,"$ed_step",function(n){return this.$getStepResult(n)},1),c(p,"$getStepResult",function(n){var t=this,e=r,u=r,a=r,d=r,S=r,f=r,_=r,h=r,x=r,E=r,M=r,G=r;return!v(/^(\d+)E(\d+)?(\+(\d*)D(\d+))?(\+\d)?/i["$=~"](n))||(e=0,t.isFailed=!0,u=s("Regexp").$last_match(1).$to_i(),a=[s("Regexp").$last_match(2).$to_i(),20].$min(),d=s("Regexp").$last_match(3)["$nil?"]()["$!"](),S=[1,s("Regexp").$last_match(4).$to_i()].$max(),f=s("Regexp").$last_match(5).$to_i(),_=s("Regexp").$last_match(6).$to_i(),h=s("Hash").$new(0),v(d)&&(z(h,"[]=",R(x=[f,S])),D(x.length,1)),v(o(a,0)))?r:(E=t.$getStepInfo(u),t.$debug("stepInfo",E),t.string="",z([20,12,10,8,6,4],"each",[],function F(w){return null==w&&(w=r),e=m(e,(null==F.$$s?this:F.$$s).$rollStep(w,E.$shift()))},{$$arity:1,$$s:t}),M=E.$shift(),z(h,"each",[],function F(w,N){return null==w&&(w=r),null==N&&(N=r),e=m(e,(null==F.$$s?this:F.$$s).$rollStep(w,N))},{$$arity:2,$$s:t}),t.string=m(t.string,m(t.$getModifyText(M),t.$getModifyText(_))),e=m(e,m(M,_)),t.string=m(t.string," \uff1e "+e),G="\u30b9\u30c6\u30c3\u30d7"+u+" \uff1e "+t.string,H(a,0)||(t.string=m(t.string,m(" \uff1e ",t.$getSuccess(a,e))),G="\u30b9\u30c6\u30c3\u30d7"+u+">="+a+" \uff1e "+t.string),G)},1),c(p,"$getModifyText",function(n){var t=this;return t.string="",H(n,0)||(v(B(n,0))&&(t.string=m(t.string,"+")),t.string=m(t.string,n.$to_s())),t.string},1),c(p,"$getBaseStepTable",function(){return[[1,[0,0,0,0,1,0,-3]],[2,[0,0,0,0,1,0,-2]],[3,[0,0,0,0,1,0,-1]],[4,[0,0,0,0,1,0,0]],[5,[0,0,0,1,0,0,0]],[6,[0,0,1,0,0,0,0]],[7,[0,1,0,0,0,0,0]]]},0),c(p,"$getStepInfo",function(n){var u,t=this,e=r,a=r,d=r,S=r,f=r,_=r,h=r,x=r;return u=(e=t.$getBaseStepTable()).$last().$first(),v(V(n,u))?t.$get_table_by_number(n,e):(a=[0,1,0,0,0,0,0],d=D(D(n,u),1),f=[0,0,0,0,0,0,0],_=W(d,(S=[[0,0,0,0,2,0,0],[0,0,0,1,1,0,0],[0,0,0,2,0,0,0],[0,0,1,1,0,0,0],[0,0,2,0,0,0,0],[0,1,1,0,0,0,0],[0,2,0,0,0,0,0]]).$size()).$to_i(),z(_,"times",[],function E(){return(null==E.$$s?this:E.$$s).$addStepToResult(f,a)},{$$arity:0,$$s:t}),h=d["$%"](S.$size()),x=S["$[]"](h),t.$addStepToResult(f,x),f)},1),c(p,"$addStepToResult",function(n,t){return z(n.$size(),"times",[],function(u){var a;return null==u&&(u=r),a=[u,m(n["$[]"](u),t["$[]"](u))],z(n,"[]=",R(a)),a[D(a.length,1)]},1),n},2),c(p,"$getSuccess",function(n,t){var e,a=this,d=r,S=r,f=r,_=r,h=r,x=r,E=r;return v(a.isFailed)?"\u81ea\u52d5\u5931\u6557":(d=a.$getSuccessTable(),S=a.$get_table_by_number(n,d),f=null==(e=X(S))[0]?r:e[0],_=null==e[1]?r:e[1],h=null==e[2]?r:e[2],x=null==e[3]?r:e[3],E=null==e[4]?r:e[4],v(I(t,null==e[5]?r:e[5]))?"Extraordinary(\u6975\u4e0a)":v(I(t,E))?"Excelent(\u6700\u9ad8)":v(I(t,x))?"Good(\u4e0a\u51fa\u6765)":v(I(t,h))?"Average(\u305d\u3053\u305d\u3053)":v(I(t,_))?"Poor(\u304a\u7c97\u672b)":v(I(t,f))?"Pathetic(\u60e8\u3081)":r)},2),c(p,"$getSuccessTable",function(){return[[2,[0,1,2,5,7,9]],[3,[0,1,3,6,8,10]],[4,[0,1,4,7,10,12]],[5,[1,2,5,8,11,14]],[6,[1,2,6,9,13,17]],[7,[1,3,7,11,15,19]],[8,[1,4,8,13,16,20]],[9,[1,5,9,15,18,22]],[10,[1,6,10,16,20,24]],[11,[1,6,11,17,21,25]],[12,[1,7,12,18,23,27]],[13,[1,7,13,20,25,29]],[14,[1,8,14,21,26,31]],[15,[1,9,15,23,27,31]],[16,[1,10,16,24,28,33]],[17,[1,11,17,25,30,34]],[18,[1,12,18,26,31,36]],[19,[1,12,19,28,33,37]],[20,[1,13,20,29,34,39]],[21,[1,14,21,30,36,41]],[22,[1,15,22,31,37,42]],[23,[1,16,23,33,38,43]],[24,[1,16,24,34,39,44]],[25,[1,17,25,35,41,46]],[26,[1,18,26,36,42,47]],[27,[1,19,27,37,43,49]],[28,[1,19,28,39,45,50]],[29,[1,21,29,40,46,51]],[30,[1,21,30,41,47,53]],[31,[1,22,31,42,48,54]],[32,[1,23,32,43,49,55]],[33,[1,24,33,45,51,57]],[34,[1,24,34,46,52,58]],[35,[1,25,35,47,53,60]],[36,[1,26,36,48,54,60]],[37,[1,27,37,49,56,62]],[38,[1,28,38,51,57,63]],[39,[1,29,39,52,58,64]],[40,[1,30,40,53,59,66]]]},0),c(p,"$rollStep",function(n,t){var e=this,u=r;return e.$debug("rollStep diceType, diceCount, @string",n,t,e.string),u=0,v(B(t,0))&&(v(e.string["$empty?"]())||(e.string=m(e.string,"+")),e.string=m(e.string,t+"d"+n+"["),e.$debug("rollStep @string",e.string),z(t,"times",[],function a(d){var f=null==a.$$s?this:a.$$s,_=r,h=r;for(null==f.randomizer&&(f.randomizer=r),null==f.string&&(f.string=r),null==d&&(d=r),_=f.randomizer.$roll_once(n),Y(_,1)&&(f.isFailed=!1),h=_;H(_,n);)_=f.randomizer.$roll_once(n),h=m(h,_);return u=m(u,h),Y(d,0)&&(f.string=m(f.string,",")),f.string=m(f.string,h.$to_s())},{$$arity:1,$$s:e}),e.string=m(e.string,"]")),u},2)})}}]);