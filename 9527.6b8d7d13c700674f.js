(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[9527],{9527:(be,ge,he)=>{he(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(r){var I,K,G,Z,B,W,U,x,Y=[],$=r.nil,t=r.$$$,e=r.module,p=r.hash2,E=r.truthy,M=r.def;return I=Y,K=x=[e(Y[0],"BCDice")].concat(I),U=[W=e(x[0],"ArithmeticEvaluator")].concat(K),Z=[G=r.get_singleton_class(W)].concat(U),B=r.$r(Z),M(G,"$eval",function(f,P){var V,H=$;if(null==P)P=p([],{});else if(!P.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(V=P.$$smap.round_type)&&(V=t(B("RoundType"),"FLOOR")),E(f)&&E(H=B("Arithmetic").$eval(f,V))?H:0},-2)},Opal.modules["i18n/backend/fallbacks"]=function(r){var Z,f,V,H,B,m,Y=[],$=r.nil,t=r.$$$,e=r.module,p=r.class_variable_set,E=r.truthy,M=r.class_variable_get,a=r.def,I=r.send,C=r.to_a,x=r.rb_minus,q=r.send2,K=r.find_super,W=r.hash2,U=r.find_block_super,G=r.neqeq;return Z=Y,m=[B=e(Y[0],"I18n")].concat(Z),p(m[0],"@@fallbacks",$),f=r.get_singleton_class(B),V=[f].concat(m),H=r.$r(V),a(f,"$fallbacks",function(){var w=$;return p(V[1],"@@fallbacks",E(null!=V[1].$$cvars["@@fallbacks"]?"class variable":$)&&E(w=M(V[1],"@@fallbacks",!1))?w:t(t(H("I18n"),"Locale"),"Fallbacks").$new()),E(w=H("Thread").$current()["$[]"]("i18n_fallbacks"))?w:M(V[1],"@@fallbacks",!1)},0),a(f,"$fallbacks=",function(y){var w;return p(V[1],"@@fallbacks",E(y["$is_a?"](H("Array")))?t(t(H("I18n"),"Locale"),"Fallbacks").$new(y):y),w=["i18n_fallbacks",M(V[1],"@@fallbacks",!1)],I(H("Thread").$current(),"[]=",C(w)),w[x(w.length,1)]},1),function(f,P){var y,w,A,u,H=[e(f,"Backend")].concat(P);return y=H,A=[w=e(H[0],"Fallbacks")].concat(y),u=r.$r(A),a(w,"$translate",function d(o,_,c){try{var n=d.$$p||$,i=this,v=$,g=$;return delete d.$$p,null==c&&(c=u("EMPTY_HASH")),E(c.$fetch("fallback",!0))?E(c["$[]"]("fallback_in_progress"))?q(i,K(i,"translate",d,!1,!0),"translate",[o,_,c],n):(E(c["$[]"]("default"))&&(v=i["$extract_non_symbol_default!"](c)),g=c.$merge(W(["fallback_in_progress"],{fallback_in_progress:!0})),I(u("I18n").$fallbacks()["$[]"](o),"each",[],function b(l){var T=null==b.$$s?this:b.$$s;null==l&&(l=$);try{return I(T,"catch",["exception"],function L(){var s=null==L.$$s?this:L.$$s,j=$;if(j=q(s,U(s,"translate",L.$$def||b.$$def||d,!1,!1),"translate",[l,_,g],null),E(j["$nil?"]()))return $;G(o.$to_s(),l.$to_s())&&s.$on_fallback(o,l,_,c),r.ret(j)},{$$arity:0,$$s:T})}catch(L){if(!r.rescue(L,[t(u("I18n"),"InvalidLocale")]))throw L;try{return $}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),E(c["$key?"]("default"))&&E(c["$[]"]("default")["$nil?"]())?$:E(v)?q(i,K(i,"translate",d,!1,!0),"translate",[o,$,c.$merge(W(["default"],{default:v}))],null):i.$throw("exception",t(u("I18n"),"MissingTranslation").$new(o,_,c))):q(i,K(i,"translate",d,!1,!0),"translate",[o,_,c],n)}catch(b){if(b===r.returner)return b.$v;throw b}},-3),a(w,"$extract_non_symbol_default!",function(o){var c,_=$,n=$;return _=[o["$[]"]("default")].$flatten(),c=I(_,"detect",[],function(v){return null==v&&(v=$),v["$is_a?"](u("Symbol"))["$!"]()},1),E(c)&&(n=["default",_["$[]"](0,_.$index(c))],I(o,"[]=",C(n)),x(n.length,1)),c},1),a(w,"$exists?",function d(o,_,c){try{var n=d.$$p||$,i=this;return delete d.$$p,null==c&&(c=u("EMPTY_HASH")),E(c.$fetch("fallback",!0))?(I(u("I18n").$fallbacks()["$[]"](o),"each",[],function v(g){var b=null==v.$$s?this:v.$$s;null==g&&(g=$);try{if(!E(q(b,U(b,"exists?",v.$$def||d,!1,!1),"exists?",[g,_],null)))return $;r.ret(!0)}catch(l){if(!r.rescue(l,[t(u("I18n"),"InvalidLocale")]))throw l;try{return $}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):q(i,K(i,"exists?",d,!1,!0),"exists?",[o,_,c],n)}catch(v){if(v===r.returner)return v.$v;throw v}},-3),w.$private(),a(w,"$on_fallback",function(o,_,c,n){return $},4)}(m[0],m)},Opal.modules["bcdice/randomizer"]=function(r){var B,k,y,w,A,u,f,P,Y=[],$=r.nil,t=r.$$$,p=r.klass,E=r.const_set,M=r.def,a=r.truthy,I=r.rb_gt,C=r.rb_plus,x=r.rb_le,q=r.send,K=r.rb_minus,W=r.eqeq,U=r.rb_times,G=r.eqeqeq,X=r.rb_ge;return B=Y,f=[(0,r.module)(Y[0],"BCDice")].concat(B),P=r.$r(f),k=f,w=[y=p(f[0],null,"Randomizer")].concat(k),A=r.$r(w),(u=y.$$prototype).rand_results=u.detailed_rand_results=$,E(w[0],"UPPER_LIMIT_DICE_TIMES",200),E(w[0],"UPPER_LIMIT_DICE_SIDES",1e3),E(w[0],"UPPER_LIMIT_RANDS",1e4),M(y,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),y.$attr_reader("rand_results"),y.$attr_reader("detailed_rand_results"),E(w[0],"DetailedRandResult",A("Struct").$new("kind","sides","value")),M(y,"$roll_barabara",function(o,_){var c=this;return a(I(C(c.rand_results.$size(),o),A("UPPER_LIMIT_RANDS")))&&c.$raise(A("TooManyRandsError")),a(x(o,0))||a(I(o,A("UPPER_LIMIT_DICE_TIMES")))?[]:q(A("Array"),"new",[o],function n(){return(null==n.$$s?this:n.$$s).$roll_once(_)},{$$arity:0,$$s:c})},2),M(y,"$roll_sum",function(o,_){return this.$roll_barabara(o,_).$sum()},2),M(y,"$roll_once",function(o){var c=$;return a(x(o,0))||a(I(o,A("UPPER_LIMIT_DICE_SIDES")))?0:(c=this.$rand_inner(o),this.$push_to_detail("normal",o,c),c)},1),M(y,"$roll_index",function(o){return K(this.$roll_once(o),1)},1),M(y,"$roll_tens_d10",function(){var c,_=$;return _=this.$rand_inner(10),W(_,10)&&(_=0),c=U(_,10),this.$push_to_detail("tens_d10",10,c),c},0),M(y,"$roll_d9",function(){var _;return _=K(this.$rand_inner(10),1),this.$push_to_detail("d9",10,_),_},0),M(y,"$roll_d66",function(o){var n,c=$;return c=q(A("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),G(t(A("D66SortType"),"ASC"),n=o)?c["$sort!"]():G(t(A("D66SortType"),"DESC"),n)&&c["$sort!"]()["$reverse!"](),C(U(c["$[]"](0),10),c["$[]"](1))},1),y.$private(),M(y,"$rand_inner",function(o){var c,_=this;return a(X(_.rand_results.$size(),A("UPPER_LIMIT_RANDS")))&&_.$raise(A("TooManyRandsError")),c=_.$random(o),_.rand_results["$<<"]([c,o]),c},1),M(y,"$random",function(o){return C(A("Kernel").$rand(o),1)},1),M(y,"$push_to_detail",function(o,_,c){var i;return i=A("DetailedRandResult").$new(o,_,c),this.detailed_rand_results.$push(i)},3),p(f[0],P("StandardError"),"TooManyRandsError"),$},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var a,q,X,Z,B,m,f,W,C,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.truthy;return a=Y,q=C=[t(Y[0],"BCDice")].concat(a),X=W=[t(C[0],"DiceTable")].concat(q),B=[Z=e(W[0],null,"RollResult")].concat(X),m=r.$r(B),(f=Z.$$prototype).table_name=f.value=f.body=$,p(Z,"$initialize",function(V,H,k){var y=this;return y.table_name=V,y.value=H,y.body=k},3),Z.$attr_reader("table_name"),Z.$attr_reader("value"),Z.$attr_reader("body"),p(Z,"$to_s",function(){var V=this;return V.table_name+"("+V.value+") \uff1e "+V.body},0),p(Z,"$last_body",function(){var V=this;return E(V.body["$is_a?"](m("RollResult")))?V.body.$last_body():V.body},0),p(Z,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var I,K,Z,B,m,f,P,U,x,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.truthy,E=r.def,M=r.rb_minus;return I=Y,K=x=[t(Y[0],"BCDice")].concat(I),Z=U=[t(x[0],"DiceTable")].concat(K),m=[B=e(U[0],null,"ChainTable")].concat(Z),f=r.$r(m),(P=B.$$prototype).times=P.sides=P.items=P.name=$,E(B,"$initialize",function(H,k,y){var w=this,A=$;return w.name=H,w.items=y.$freeze(),A=/(\d+)D(\d+)/i.$match(k),p(A)||w.$raise(f("ArgumentError"),"Unexpected table type: "+k),w.times=A["$[]"](1).$to_i(),w.sides=A["$[]"](2).$to_i()},3),E(B,"$roll",function(H){var y,w,k=this,A=$;return y=H.$roll_sum(k.times,k.sides),w=M(y,k.times),A=k.items["$[]"](w),p(A["$respond_to?"]("roll"))&&(A=A.$roll(H)),f("RollResult").$new(k.name,y,A)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var q,G,f,P,V,H,k,Z,W,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.hash2,E=r.defs,M=r.def,a=r.rb_plus,I=r.rb_times,C=r.rb_minus;return q=Y,G=W=[t(Y[0],"BCDice")].concat(q),f=Z=[t(W[0],"DiceTable")].concat(G),V=[P=e(Z[0],null,"D66GridTable")].concat(f),H=r.$r(V),(k=P.$$prototype).name=k.items=$,E(P,"$from_i18n",function(w,A){var d=$;return d=H("I18n").$t(w,p(["locale","raise"],{locale:A,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items"))},2),M(P,"$initialize",function(w,A){return this.name=w,this.items=A.$freeze()},2),M(P,"$roll",function(w){var u,d,o,_,c;return u=w.$roll_once(6),d=w.$roll_once(6),o=a(I(u,10),d),_=C(u,1),c=C(d,1),H("RollResult").$new(this.name,o,this.items["$[]"](_)["$[]"](c))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var C,W,m,f,P,V,G,X,q,$=[],t=r.nil,e=r.module,p=r.klass,E=r.hash2,M=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),C=$,W=q=[e($[0],"BCDice")].concat(C),G=[e(q[0],"DiceTable")].concat(W),X=r.$r(G),m=G,P=[f=p(G[0],X("D66GridTable"),"D66HalfGridTable")].concat(m),V=r.$r(P),M(f,"$from_i18n",function(k,y){var A=t;return A=V("I18n").$t(k,E(["locale","raise"],{locale:y,raise:!0})),this.$new(A["$[]"]("name"),A["$[]"]("items_1_2_3"),A["$[]"]("items_4_5_6"))},2),a(f,"$initialize",function(k,y,w){return this.name=k,this.items=[y,y,y,w,w,w].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var C,W,m,f,P,V,G,X,q,$=[],t=r.nil,e=r.module,p=r.klass,E=r.hash2,M=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),C=$,W=q=[e($[0],"BCDice")].concat(C),G=[e(q[0],"DiceTable")].concat(W),X=r.$r(G),m=G,P=[f=p(G[0],X("D66GridTable"),"D66OneThirdTable")].concat(m),V=r.$r(P),M(f,"$from_i18n",function(k,y){var A=t;return A=V("I18n").$t(k,E(["locale","raise"],{locale:y,raise:!0})),this.$new(A["$[]"]("name"),A["$[]"]("items_1_2"),A["$[]"]("items_3_4"),A["$[]"]("items_5_6"))},2),a(f,"$initialize",function(k,y,w,A){return this.name=k,this.items=[y,y,w,w,A,A].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var W,Z,V,H,k,y,w,m,G,Y=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,E=r.hash2,M=r.defs,a=r.def,I=r.eqeqeq,C=r.rb_plus,x=r.rb_times,q=r.truthy;return W=Y,Z=G=[e(Y[0],"BCDice")].concat(W),V=m=[e(G[0],"DiceTable")].concat(Z),k=[H=p(m[0],null,"D66Table")].concat(V),y=r.$r(k),(w=H.$$prototype).sort_type=w.items=w.name=$,M(H,"$from_i18n",function(u,d){var c,_=$;return _=y("I18n").$t(u,E(["locale"],{locale:d})),c=y("D66SortType").$const_get(_["$[]"]("d66_sort_type")),this.$new(_["$[]"]("name"),c,_["$[]"]("items"))},2),a(H,"$initialize",function(u,d,o){var _=this;return _.name=u,_.sort_type=d,_.items=o.$freeze()},3),a(H,"$roll",function(u){var d=this,o=$,_=$,c=$,n=$;return o=u.$roll_barabara(2,6),I(t(y("D66SortType"),"ASC"),_=d.sort_type)?o["$sort!"]():I(t(y("D66SortType"),"DESC"),_)&&o["$sort!"]()["$reverse!"](),c=C(x(o["$[]"](0),10),o["$[]"](1)),n=q(_=d.items["$[]"](c))?_:d.items["$[]"](c.$to_s()),q(n["$respond_to?"]("roll"))&&(n=n.$roll(u)),y("RollResult").$new(d.name,c,n)},1),a(H,"$choice",function(u){return y("RollResult").$new(this.name,u,this.items["$[]"](u))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var X,f,V,H,B,$=[],t=r.nil,e=r.module,p=r.klass,E=r.hash2,M=r.send,a=r.to_ary,I=r.rb_plus,C=r.rb_times,x=r.to_a,q=r.rb_minus,K=r.send2,W=r.find_super,U=r.def;return r.top.$require("bcdice/dice_table/d66_table"),X=$,f=B=[e($[0],"BCDice")].concat(X),V=[e(B[0],"DiceTable")].concat(f),H=r.$r(V),U(p(V[0],H("D66Table"),"D66LeftRangeTable"),"$initialize",function A(u,d,o){var n;return delete A.$$p,n=E([],{}),M(o,"each",[],function(v){var g,T;return null==v&&(v=t),g=a(v),T=null==g[1]?t:g[1],M(null==g[0]?t:g[0],"each",[],function(s){return null==s&&(s=t),M(T,"each_with_index",[],function(R,ie){var le,_e;return null==R&&(R=t),null==ie&&(ie=t),le=I(C(s,10),I(ie,1)),M(n,"[]=",x(_e=[le,R])),_e[q(_e.length,1)]},2)},1)},1),K(this,W(this,"initialize",A,!1,!0),"initialize",[u,d,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var x,U,m,f,P,V,H,X,K,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.truthy,M=r.rb_minus,a=r.rb_plus,I=r.rb_times;return x=Y,U=K=[t(Y[0],"BCDice")].concat(x),m=X=[t(K[0],"DiceTable")].concat(U),P=[f=e(X[0],null,"D66ParityTable")].concat(m),V=r.$r(P),(H=f.$$prototype).odd=H.even=H.name=$,p(f,"$initialize",function(y,w,A){var u=this;return u.name=y,u.odd=w.$freeze(),u.even=A.$freeze()},3),p(f,"$roll",function(y){var u,o,_,w=this,A=$;return A=y.$roll_once(6),u=y.$roll_once(6),o=(E(A["$odd?"]())?w.odd:w.even)["$[]"](M(u,1)),_=a(I(A,10),u),V("RollResult").$new(w.name,_,o)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var C,W,B,m,f,P,V,G,q,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.rb_plus,M=r.rb_times,a=r.send;return C=Y,W=q=[t(Y[0],"BCDice")].concat(C),B=G=[t(q[0],"DiceTable")].concat(W),f=[m=e(G[0],null,"D66RangeTable")].concat(B),P=r.$r(f),(V=m.$$prototype).items=V.name=$,p(m,"$initialize",function(k,y){return this.name=k,this.items=y.$freeze()},2),p(m,"$roll",function(k){var w,A,u,d=$;return w=k.$roll_once(6),A=k.$roll_once(6),u=E(M(w,10),A),d=a(this.items,"find",[],function(_){return null==_&&(_=$),_["$[]"](0)["$include?"](u)},1),P("RollResult").$new(this.name,u,d["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var U,B,H,k,y,w,A,f,X,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.const_set,E=r.send,M=r.truthy,a=r.def,I=r.to_a,C=r.rb_minus,x=r.eqeqeq,q=r.rb_times,K=r.rb_plus;return U=Y,B=X=[t(Y[0],"BCDice")].concat(U),H=f=[t(X[0],"DiceTable")].concat(B),y=[k=e(f[0],null,"RangeTable")].concat(H),w=r.$r(y),(A=k.$$prototype).name=A.items=A.num_of_dice=A.num_of_sides=A.formatter=$,p(y[0],"RollResult",E(w("Struct"),"new",["sum","values","content","formatted"],function u(){return(null==u.$$s?this:u.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:k})),p(y[0],"Item",w("Struct").$new("range","content")),p(y[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(y[0],"DEFAULT_FORMATTER",E(k,"lambda",[],function(d,o){return null==d&&(d=$),null==o&&(o=$),d.$name()+"("+o.$sum()+") \uff1e "+o.$content()},2)),k.$attr_reader("name"),k.$attr_reader("num_of_dice"),k.$attr_reader("num_of_sides"),a(k,"$initialize",function u(d,o,_){var i,c=u.$$p||$,n=this,v=$;return delete u.$$p,n.name=d.$freeze(),n.formatter=M(i=c)?i:w("DEFAULT_FORMATTER"),v=w("DICE_ROLL_METHOD_RE").$match(o),M(v)||n.$raise(w("ArgumentError"),n.name+": invalid dice roll method: "+o),n.num_of_dice=v["$[]"](1).$to_i(),n.num_of_sides=v["$[]"](2).$to_i(),n.$store(_)},3),a(k,"$fetch",function(d){var _,o=this;return _=E(o.items,"find",[],function(n){return null==n&&(n=$),n.$range()["$include?"](d)},1),M(_)||o.$raise(w("RangeError"),o.name+": value is out of range: "+d),_},1),a(k,"$roll",function(d){var c,n,i,o=this,_=$;return c=(_=d.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),n=w("RollResult").$new(c,_,o.$fetch(c).$content()),i=[o.formatter["$[]"](o,n)],E(n,"formatted=",I(i)),C(i.length,1),n},1),k.$private(),a(k,"$store",function(d){var _,c,o=this;return _=E(d,"map",[],function n(i,v){return null==i&&(i=$),null==v&&(v=$),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),v]},{$$arity:2,$$s:o}),c=E(_,"sort_by",[],function(i,v){return null==i&&(i=$),null==v&&(v=$),i.$min()},2),o.$assert_min_sum_is_covered(c),o.$assert_max_sum_is_covered(c),o.$assert_no_gap_or_overlap_in_ranges(c),o.items=E(c,"map",[],function(i,v){return null==i&&(i=$),null==v&&(v=$),w("Item").$new(i,v.$freeze()).$freeze()},2).$freeze(),o},1),a(k,"$coerce_to_int_range",function(d){var _;return x(w("Integer"),_=d)?w("Range").$new(d,d):x(w("Range"),_)&&M(d.$begin()["$is_a?"](w("Integer")))&&M(d.$end()["$is_a?"](w("Integer")))?d:this.$raise(w("TypeError"),this.name+": "+d+" ("+d.$class()+") must be an Integer or a Range with Integers ")},1),a(k,"$assert_min_sum_is_covered",function(d){var _,o=this,c=$;return _=o.num_of_dice,c=d.$first()["$[]"](0),M(c["$include?"](_))||o.$raise(w("RangeError"),o.name+": min value ("+_+") is not covered: "+c),o},1),a(k,"$assert_max_sum_is_covered",function(d){var _,o=this,c=$;return _=q(o.num_of_dice,o.num_of_sides),c=d.$last()["$[]"](0),M(c["$include?"](_))||o.$raise(w("RangeError"),o.name+": max value ("+_+") is not covered: "+c),o},1),a(k,"$assert_no_gap_or_overlap_in_ranges",function(d){return E(d,"each_cons",[2],function _(c,n){var b,l,i=null==_.$$s?this:_.$$s,v=$,g=$;return null==i.name&&(i.name=$),null==c&&(c=$),null==n&&(n=$),v=c["$[]"](0),g=n["$[]"](0),b=v.$max(),l=K(b,1),M(g["$include?"](b))&&i.$raise(w("RangeError"),i.name+": Range overlap: "+v+" and "+g),M(g["$include?"](l))?$:i.$raise(w("RangeError"),i.name+": Range gap: "+v+" and "+g)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var C,W,B,H,k,y,w,f,G,q,Y=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,E=r.send,M=r.def,a=r.rb_minus;return C=Y,W=q=[e(Y[0],"BCDice")].concat(C),B=G=[e(q[0],"DiceTable")].concat(W),H=f=[p(G[0],null,"SaiFicSkillTable")].concat(B),y=[k=p(f[0],null,"Category")].concat(H),w=r.$r(y),k.$$prototype.name=$,M(k,"$initialize",function(d,o,_,c){var n=this;return n.name=d,n.skills=E(o.$map(),"with_index",[2],function(v,g){return null==v&&(v=$),null==g&&(g=$),t(w("SaiFicSkillTable"),"Skill").$new(d,v,_,g,c)},2),n.dice=_},4),M(k,"$roll",function(d){return this.$skills()["$[]"](a(d.$roll_sum(2,6),2))},1),M(k,"$to_s",function(){return this.name},0),k.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var a,q,X,P,V,B,W,C,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.hash2;return a=Y,q=C=[t(Y[0],"BCDice")].concat(a),X=W=[t(C[0],"DiceTable")].concat(q),B=[e(W[0],null,"SaiFicSkillTable")].concat(X),(V=(P=e(B[0],null,"Skill")).$$prototype).s_format=V.category_dice=V.row_dice=V.category_name=V.name=$,p(P,"$initialize",function(k,y,w,A,u){var d=this;return d.category_name=k,d.name=y,d.category_dice=w,d.row_dice=A,d.s_format=u},5),p(P,"$to_s",function(){var k=this;return k.$format(k.s_format,E(["category_dice","row_dice","category_name","skill_name"],{category_dice:k.category_dice,row_dice:k.row_dice,category_name:k.category_name,skill_name:k.name}))},0),P.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var Z,P,w,A,u,d,o,H,m,Y=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,E=r.klass,M=r.hash2,a=r.send,C=r.defs,x=r.const_set,q=r.to_ary,K=r.def,W=r.truthy,U=r.rb_minus,G=r.rb_plus;return Y.$require("bcdice/dice_table/sai_fic_skill_table/category"),Y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),Z=$,P=m=[p($[0],"BCDice")].concat(Z),w=H=[p(m[0],"DiceTable")].concat(P),u=[A=E(H[0],null,"SaiFicSkillTable")].concat(w),d=r.$r(u),(o=A.$$prototype).rtt=o.rtt_format=o.rct=o.rct_format=o.rttn=o.rttn_format=o.categories=t,C(A,"$from_i18n",function(c,n,i){var v,g,b,s,L=t;if(null==i)i=M([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(v=i.$$smap.rtt)&&(v=t),null==(g=i.$$smap.rct)&&(g=t),null==(b=i.$$smap.rttn)&&(b=t),s=(L=d("I18n").$t("RTT",M(["locale","raise","default"],{locale:n,raise:!1,default:M([],{})})).$merge(d("I18n").$t(c,M(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),L=a(L,"select",[],function(R,ie){return null==R&&(R=t),null==ie&&(ie=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](R)},2),this.$new(s,r.to_hash(L).$merge(M(["rtt","rct","rttn"],{rtt:v,rct:g,rttn:b})))},-3),x(u[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),x(u[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),x(u[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),x(u[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),K(A,"$initialize",function(c,n){var i,v,g,b,l,T,L,s=this;if(null==n)n=M([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=t),null==(v=n.$$smap.rct)&&(v=t),null==(g=n.$$smap.rttn)&&(g=t),null==(b=n.$$smap.rtt_format)&&(b=d("DEFAULT_RTT")),null==(l=n.$$smap.rct_format)&&(l=d("DEFAULT_RCT")),null==(T=n.$$smap.rttn_format)&&(T=d("DEFAULT_RTTN")),null==(L=n.$$smap.s_format)&&(L=d("DEFAULT_S")),s.categories=a(c.$map(),"with_index",[1],function(R,ie){var le,oe,ue;return null==R&&(R=t),null==ie&&(ie=t),oe=null==(le=q(R))[0]?t:le[0],ue=null==le[1]?t:le[1],e(d("SaiFicSkillTable"),"Category").$new(oe,ue,ie,L)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),s.rtt=i,s.rct=v,s.rttn=g.$to_a(),s.rtt_format=b,s.rct_format=l,s.rttn_format=T},-2),x(u[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),A.$attr_reader("categories"),K(A,"$roll_command",function(c,n){var v,i=this,g=t,b=t;return W(["RTT",i.rtt]["$include?"](v=n))?i.$format_skill(i.rtt_format,i.$roll_skill(c)):W(["RCT",i.rct]["$include?"](v))?(g=i.$roll_category(c),i.$format(i.rct_format,M(["category_dice","category_name"],{category_dice:g.$dice(),category_name:g.$name()}))):W(b=d("RTTN").$index(v))||W(b=i.rttn.$index(v))?i.$format_skill(i.rttn_format,i.categories["$[]"](b).$roll(c)):t},2),K(A,"$roll_category",function(c){return this.categories["$[]"](U(c.$roll_once(6),1))},1),K(A,"$roll_skill",function(c){return this.$roll_category(c).$roll(c)},1),K(A,"$prefixes",function(){var c=this;return G(["RTT[1-6]?","RCT",c.rtt,c.rct],c.rttn).$compact()},0),A.$private(),K(A,"$format_skill",function(c,n){return this.$format(c,M(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var x,U,m,f,P,V,H,X,K,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.hash2,E=r.defs,M=r.truthy,a=r.def,I=r.rb_minus;return x=Y,U=K=[t(Y[0],"BCDice")].concat(x),m=X=[t(K[0],"DiceTable")].concat(U),P=[f=e(X[0],null,"Table")].concat(m),V=r.$r(P),(H=f.$$prototype).times=H.sides=H.name=H.items=$,E(f,"$from_i18n",function(y,w){var u=$;return u=V("I18n").$t(y,p(["locale"],{locale:w})),this.$new(u["$[]"]("name"),u["$[]"]("type"),u["$[]"]("items"))},2),a(f,"$initialize",function(y,w,A){var u=this,d=$;return u.name=y,u.items=A.$freeze(),d=/(\d+)D(\d+)/i.$match(w),M(d)||u.$raise(V("ArgumentError"),"Unexpected table type: "+w),u.times=d["$[]"](1).$to_i(),u.sides=d["$[]"](2).$to_i()},3),a(f,"$roll",function(y){var A,w=this;return A=y.$roll_sum(w.times,w.sides),w.$choice(A)},1),a(f,"$choice",function(y){var A,w=this;return A=I(y,w.times),V("RollResult").$new(w.name,y,w.items["$[]"](A))},1)},Opal.modules["bcdice/dice_table"]=function(r){var Y=r.top;return Y.$require("bcdice/dice_table/roll_result"),Y.$require("bcdice/dice_table/chain_table"),Y.$require("bcdice/dice_table/d66_grid_table"),Y.$require("bcdice/dice_table/d66_half_grid_table"),Y.$require("bcdice/dice_table/d66_one_third_table"),Y.$require("bcdice/dice_table/d66_left_range_table"),Y.$require("bcdice/dice_table/d66_parity_table"),Y.$require("bcdice/dice_table/d66_range_table"),Y.$require("bcdice/dice_table/d66_table"),Y.$require("bcdice/dice_table/range_table"),Y.$require("bcdice/dice_table/sai_fic_skill_table"),Y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var E,C,q,a,Y=[],t=r.module,e=r.const_set;return E=Y,C=a=[t(Y[0],"BCDice")].concat(E),q=[t(a[0],"D66SortType")].concat(C),e(q[0],"NO_SORT","no_sort"),e(q[0],"ASC","asc"),e(q[0],"DESC","desc"),function(I,C){var q=[t(I,"RoundType")].concat(C);return e(q[0],"CEIL","ceil"),e(q[0],"FLOOR","floor"),e(q[0],"ROUND","round")}(a[0],a)},Opal.modules["bcdice/translate"]=function(r){var a,q,K,W,U,C,Y=[],$=r.nil,t=r.module,e=r.hash2,E=r.def;return a=Y,q=C=[t(Y[0],"BCDice")].concat(a),W=[K=t(C[0],"Translate")].concat(q),U=r.$r(W),E(K,"$translate",function(X,Z){var B,m=this;if(null==m.locale&&(m.locale=$),null==Z)Z=e([],{});else if(!Z.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return B=r.kwrestargs(Z,{}),U("I18n").$translate(X,e(["locale","raise"],{locale:m.locale,raise:!0}).$merge(r.to_hash(B)))},-2)},Opal.modules["bcdice/result"]=function(r){var C,U,B,G,Z,q,Y=[],$=r.nil,e=r.klass,p=r.send,E=r.to_a,M=r.rb_minus,a=r.def;return C=Y,U=q=[(0,r.module)(Y[0],"BCDice")].concat(C),[G=e(q[0],null,"Result")].concat(U),(Z=G.$$prototype).secret=Z.success=Z.failure=Z.critical=Z.fumble=$,a(B=r.get_singleton_class(G),"$success",function(P){return p(this.$new(),"tap",[],function(k){var y=$;return null==k&&(k=$),p(k,"text=",E(y=[P])),M(y.length,1),p(k,"success=",E(y=[!0])),y[M(y.length,1)]},1)},1),a(B,"$failure",function(P){return p(this.$new(),"tap",[],function(k){var y=$;return null==k&&(k=$),p(k,"text=",E(y=[P])),M(y.length,1),p(k,"failure=",E(y=[!0])),y[M(y.length,1)]},1)},1),a(B,"$critical",function(P){return p(this.$new(),"tap",[],function(k){var y=$;return null==k&&(k=$),p(k,"text=",E(y=[P])),M(y.length,1),p(k,"critical=",E(y=[!0])),M(y.length,1),p(k,"success=",E(y=[!0])),y[M(y.length,1)]},1)},1),a(B,"$fumble",function(P){return p(this.$new(),"tap",[],function(k){var y=$;return null==k&&(k=$),p(k,"text=",E(y=[P])),M(y.length,1),p(k,"fumble=",E(y=[!0])),M(y.length,1),p(k,"failure=",E(y=[!0])),y[M(y.length,1)]},1)},1),a(B,"$nothing",function(){return"nothing"},0),a(G,"$initialize",function(m){var f=this;return null==m&&(m=$),f.text=m,f.rands=$,f.detailed_rands=$,f.secret=!1,f.success=!1,f.failure=!1,f.critical=!1,f.fumble=!1},-1),G.$attr_accessor("text","rands","detailed_rands"),G.$attr_writer("secret","success","failure","critical","fumble"),a(G,"$secret?",function(){return this.secret},0),a(G,"$success?",function(){return this.success},0),a(G,"$failure?",function(){return this.failure},0),a(G,"$critical?",function(){return this.critical},0),a(G,"$fumble?",function(){return this.fumble},0),a(G,"$condition=",function(m){return this.success=m,this.failure=m["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var w,u,d,$=[],t=r.$r($),e=r.nil,p=r.$$$,E=r.module,M=r.klass,a=r.truthy,I=r.const_set,C=r.defs,x=r.gvars,q=r.rb_lt,K=r.send,W=r.to_a,U=r.rb_minus,G=r.def,X=r.to_ary,Z=r.neqeq,B=r.rb_plus,m=r.eqeq,f=r.rb_ge,P=r.rb_gt,V=r.eqeqeq,H=r.rb_le,k=r.rb_times;return w=$,u=[E($[0],"Racc")].concat(w),d=r.$r(u),M(u[0],d("StandardError"),"ParseError"),a(p("::","ParseError","skip_raise")?"constant":e)||I($[0],"ParseError",p(t("Racc"),"ParseError")),function(y,w){var n,i,v,g,b,d=[E(y,"Racc")].concat(w),o=r.$r(d);return a(o("Racc_No_Extensions","skip_raise")?"constant":e)||I(d[0],"Racc_No_Extensions",!1),n=d,v=[i=M(d[0],null,"Parser")].concat(n),g=r.$r(v),(b=i.$$prototype).yydebug=b.racc_debug_out=b.racc_error_status=b.racc_t=b.racc_vstack=b.racc_val=b.racc_state=b.racc_tstack=e,I(v[0],"Racc_Runtime_Version","1.4.6"),I(v[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),I(v[0],"Racc_Runtime_Core_Version_R","1.4.6"),I(v[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),I(v[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),I(v[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),I(v[0],"Racc_Runtime_Core_Version",g("Racc_Runtime_Core_Version_R")),I(v[0],"Racc_Runtime_Core_Revision",g("Racc_Runtime_Core_Revision_R")),I(v[0],"Racc_Runtime_Type","ruby"),C(g("Parser"),"$racc_runtime_type",function(){return g("Racc_Runtime_Type")},0),G(i,"$_racc_setup",function(){var T,L,s=this,j=e,R=e,ie=e;return null==x.stderr&&(x.stderr=e),a(p(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),a(null!=(T=s.yydebug)&&T!==e?"instance-variable":e)||(s.yydebug=!1),a(s.yydebug)&&(a(null!=(L=s.racc_debug_out)&&L!==e?"instance-variable":e)||(s.racc_debug_out=x.stderr),s.racc_debug_out=a(j=s.racc_debug_out)?j:x.stderr),R=p(s.$class(),"Racc_arg"),a(q(R.$size(),14))&&(K(R,"[]=",W(ie=[13,!0])),U(ie.length,1)),R},0),G(i,"$_racc_init_sysvars",function(){var T=this;return T.racc_state=[0],T.racc_tstack=[],T.racc_vstack=[],T.racc_t=e,T.racc_val=e,T.racc_read_next=!0,T.racc_user_yyerror=!1,T.racc_error_status=0},0),G(i,"$do_parse",function(){return this.$__send__(g("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),G(i,"$next_token",function(){return this.$raise(g("NotImplementedError"),this.$class()+"#next_token is not defined")},0),G(i,"$_racc_do_parse_rb",function(T,L){var s,R=this,ie=e,le=e,_e=e,oe=e,$e=e,z=e,re=e,S=e;return s=X(T),ie=null==s[0]?e:s[0],le=null==s[1]?e:s[1],_e=null==s[2]?e:s[2],oe=null==s[3]?e:s[3],$e=null==s[10]?e:s[10],R.$_racc_init_sysvars(),z=re=S=e,K(R,"catch",["racc_end_parse"],function N(){var F,O,h=null==N.$$s?this:N.$$s,D=e;for(null==h.racc_state&&(h.racc_state=e),null==h.racc_read_next&&(h.racc_read_next=e),null==h.racc_t&&(h.racc_t=e),null==h.yydebug&&(h.yydebug=e),null==h.racc_val&&(h.racc_val=e);a(!0);)for(a(S=oe["$[]"](h.racc_state["$[]"](-1)))?(a(h.racc_read_next)&&Z(h.racc_t,0)&&(O=h.$next_token(),F=X(O),z=null==F[0]?e:F[0],h.racc_val=null==F[1]?e:F[1],h.racc_t=a(z)?a(D=$e["$[]"](z))?D:1:0,a(h.yydebug)&&h.$racc_read_token(h.racc_t,z,h.racc_val),h.racc_read_next=!1),S=B(S,h.racc_t),a(f(S,0))&&a(re=ie["$[]"](S))&&m(le["$[]"](S),h.racc_state["$[]"](-1))||(re=_e["$[]"](h.racc_state["$[]"](-1)))):re=_e["$[]"](h.racc_state["$[]"](-1));a(re=h.$_racc_evalact(re,T)););},{$$arity:0,$$s:R})},2),G(i,"$yyparse",function(T,L){return this.$__send__(g("Racc_YY_Parse_Method"),T,L,this.$_racc_setup(),!0)},2),G(i,"$_racc_yyparse_rb",function(T,L,s,j){var R,_e=e,oe=e,ue=e,$e=e,re=e,S=e,N=e;return R=X(s),_e=null==R[0]?e:R[0],oe=null==R[1]?e:R[1],ue=null==R[2]?e:R[2],$e=null==R[3]?e:R[3],re=null==R[10]?e:R[10],this.$_racc_init_sysvars(),S=e,N=e,K(this,"catch",["racc_end_parse"],function ne(){var h=null==ne.$$s?this:ne.$$s;for(null==h.racc_state&&(h.racc_state=e);!a(N=$e["$[]"](h.racc_state["$[]"](-1)));)for(;a(S=h.$_racc_evalact(ue["$[]"](h.racc_state["$[]"](-1)),s)););return K(T,"__send__",[L],function D(ee,ae){var J=null==D.$$s?this:D.$$s,Q=e,fe=e;for(null==J.racc_t&&(J.racc_t=e),null==J.racc_state&&(J.racc_state=e),null==J.racc_read_next&&(J.racc_read_next=e),null==ee&&(ee=e),null==ae&&(ae=e),J.racc_t=a(ee)?a(Q=re["$[]"](ee))?Q:1:0,J.racc_val=ae,J.racc_read_next=!1,N=B(N,J.racc_t),a(f(N,0))&&a(S=_e["$[]"](N))&&m(oe["$[]"](N),J.racc_state["$[]"](-1))||(S=ue["$[]"](J.racc_state["$[]"](-1)));a(S=J.$_racc_evalact(S,s)););for(;a(a(Q=a(fe=(N=$e["$[]"](J.racc_state["$[]"](-1)))["$!"]())?fe:J.racc_read_next["$!"]())?Q:J.racc_t["$=="](0));)for(a(N)&&a(N=B(N,J.racc_t))&&a(f(N,0))&&a(S=_e["$[]"](N))&&m(oe["$[]"](N),J.racc_state["$[]"](-1))||(S=ue["$[]"](J.racc_state["$[]"](-1)));a(S=J.$_racc_evalact(S,s)););},{$$arity:2,$$s:h})},{$$arity:0,$$s:this})},4),G(i,"$_racc_evalact",function(T,L){var s,ue,R=this,ie=e,le=e,oe=e,$e=e,z=e,re=e,S=e;if(ie=null==(s=X(L))[0]?e:s[0],le=null==s[1]?e:s[1],oe=null==s[3]?e:s[3],ue=null==s[11]?e:s[11],$e=null==s[12]?e:s[12],a(P(T,0))&&a(q(T,ue)))a(P(R.racc_error_status,0))&&(m(R.racc_t,1)||(R.racc_error_status=U(R.racc_error_status,1))),R.racc_vstack.$push(R.racc_val),R.racc_state.$push(T),R.racc_read_next=!0,a(R.yydebug)&&(R.racc_tstack.$push(R.racc_t),R.$racc_shift(R.racc_t,R.racc_tstack,R.racc_vstack));else if(a(q(T,0))&&a(P(T,$e["$-@"]()))){if(z=K(R,"catch",["racc_jump"],function N(){var ne=null==N.$$s?this:N.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(L,T)),!1},{$$arity:0,$$s:R}),a(z)){if(V(1,re=z))return R.racc_user_yyerror=!0,$e["$-@"]();if(V(2,re))return ue;R.$raise("[Racc Bug] unknown jump code")}}else if(m(T,ue))a(R.yydebug)&&R.$racc_accept(),R.$throw("racc_end_parse",R.racc_vstack["$[]"](0));else{if(m(T,$e["$-@"]())){for(V(0,re=R.racc_error_status)?a(L["$[]"](21))||R.$on_error(R.racc_t,R.racc_val,R.racc_vstack):V(3,re)&&(m(R.racc_t,0)&&R.$throw("racc_end_parse",e),R.racc_read_next=!0),R.racc_user_yyerror=!1,R.racc_error_status=3;a(!0)&&!(a(S=oe["$[]"](R.racc_state["$[]"](-1)))&&(S=B(S,1),a(f(S,0))&&a(T=ie["$[]"](S))&&m(le["$[]"](S),R.racc_state["$[]"](-1))));)a(H(R.racc_state.$size(),1))&&R.$throw("racc_end_parse",e),R.racc_state.$pop(),R.racc_vstack.$pop(),a(R.yydebug)&&(R.racc_tstack.$pop(),R.$racc_e_pop(R.racc_state,R.racc_tstack,R.racc_vstack));return T}R.$raise("[Racc Bug] unknown action "+T.$inspect())}return a(R.yydebug)&&R.$racc_next_state(R.racc_state["$[]"](-1),R.racc_state),e},2),G(i,"$_racc_do_reduce",function(T,L){var s,$e,re,h,D,ee,J,R=this,le=e,_e=e,oe=e,ue=e,z=e,S=e,N=e,ne=e,F=e,O=e,ae=e,te=e,se=e,Q=e;return le=null==(s=X(T))[4]?e:s[4],_e=null==s[5]?e:s[5],oe=null==s[6]?e:s[6],ue=null==s[7]?e:s[7],$e=null==s[8]?e:s[8],z=null==s[9]?e:s[9],re=null==s[13]?e:s[13],S=R.racc_state,N=R.racc_vstack,ne=R.racc_tstack,F=k(L,-3),O=z["$[]"](F),h=z["$[]"](B(F,1)),D=z["$[]"](B(F,2)),ee=[],a(R.yydebug)&&(ae=ne["$[]"](O["$-@"](),O)),te=N["$[]"](O["$-@"](),O),a(R.yydebug)&&(se=[O["$-@"](),O,ee],K(ne,"[]=",W(se)),U(se.length,1)),se=[O["$-@"](),O,ee],K(N,"[]=",W(se)),U(se.length,1),se=[O["$-@"](),O,ee],K(S,"[]=",W(se)),U(se.length,1),a(re)?N.$push(R.$__send__(D,te,N,te["$[]"](0))):N.$push(R.$__send__(D,te,N)),ne.$push(h),a(R.yydebug)&&R.$racc_reduce(ae,h,ne,N),J=U(h,$e),a(F=ue["$[]"](J))&&(F=B(F,S["$[]"](-1)),a(f(F,0))&&a(Q=le["$[]"](F))&&m(_e["$[]"](F),J))?Q:oe["$[]"](J)},2),G(i,"$on_error",function(T,L,s){var R,j=this;return j.$raise(g("ParseError"),j.$sprintf("\nparse error on value %s (%s)",L.$inspect(),a(R=j.$token_to_str(T))?R:"?"))},3),G(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),G(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),G(i,"$yyerrok",function(){return this.racc_error_status=0},0),G(i,"$racc_read_token",function(T,L,s){var j=this;return j.racc_debug_out.$print("read    "),j.racc_debug_out.$print(L.$inspect(),"(",j.$racc_token2str(T),") "),j.racc_debug_out.$puts(s.$inspect()),j.racc_debug_out.$puts()},3),G(i,"$racc_shift",function(T,L,s){var j=this;return j.racc_debug_out.$puts("shift   "+j.$racc_token2str(T)),j.$racc_print_stacks(L,s),j.racc_debug_out.$puts()},3),G(i,"$racc_reduce",function(T,L,s,j){var R=this,ie=e;return(ie=R.racc_debug_out).$print("reduce "),a(T["$empty?"]())?ie.$print(" <none>"):K(T,"each",[],function le(_e){return null==_e&&(_e=e),ie.$print(" ",(null==le.$$s?this:le.$$s).$racc_token2str(_e))},{$$arity:1,$$s:R}),ie.$puts(" --\x3e "+R.$racc_token2str(L)),R.$racc_print_stacks(s,j),R.racc_debug_out.$puts()},4),G(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),G(i,"$racc_e_pop",function(T,L,s){var j=this;return j.racc_debug_out.$puts("error recovering mode: pop token"),j.$racc_print_states(T),j.$racc_print_stacks(L,s),j.racc_debug_out.$puts()},3),G(i,"$racc_next_state",function(T,L){var s=this;return s.racc_debug_out.$puts("goto    "+T),s.$racc_print_states(L),s.racc_debug_out.$puts()},2),G(i,"$racc_print_stacks",function(T,L){var j=e;return(j=this.racc_debug_out).$print("        ["),K(T,"each_index",[],function R(ie){return null==ie&&(ie=e),j.$print(" (",(null==R.$$s?this:R.$$s).$racc_token2str(T["$[]"](ie))," ",L["$[]"](ie).$inspect(),")")},{$$arity:1,$$s:this}),j.$puts(" ]")},2),G(i,"$racc_print_states",function(T){var s=e;return(s=this.racc_debug_out).$print("        ["),K(T,"each",[],function(R){return null==R&&(R=e),s.$print(" ",R)},1),s.$puts(" ]")},1),G(i,"$racc_token2str",function(T){var s;return a(s=p(this.$class(),"Racc_token_to_s_table")["$[]"](T))?s:this.$raise("[Racc Bug] can't convert token "+T+" to string")},1),G(i,"$token_to_str",function(T){return p(this.$class(),"Racc_token_to_s_table")["$[]"](T)},1)}($[0],$)},Opal.modules["bcdice/arithmetic/node"]=function(r){var U,B,V,u,d,k,y,f,X,Y=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,E=r.def,M=r.send2,a=r.find_super,I=r.eqeq,C=r.const_set,x=r.eqeqeq,q=r.rb_divide,K=r.alias;return U=Y,B=X=[e(Y[0],"BCDice")].concat(U),V=f=[e(X[0],"Arithmetic")].concat(B),k=[e(f[0],"Node")].concat(V),y=r.$r(k),(d=(u=p(k[0],null,"BinaryOp")).$$prototype).lhs=d.rhs=d.op=$,E(u,"$initialize",function(_,c,n){var i=this;return i.lhs=_,i.op=c,i.rhs=n},3),E(u,"$eval",function(_){var i,c=this,n=$;return n=c.lhs.$eval(_),i=c.rhs.$eval(_),n.$send(c.op,i)},1),E(u,"$output",function(){var _=this;return""+_.lhs.$output()+_.op+_.rhs.$output()},0),E(u,"$s_exp",function(){var _=this;return"("+_.$op_for_s_exp()+" "+_.lhs.$s_exp()+" "+_.rhs.$s_exp()+")"},0),E(u,"$op_for_s_exp",function(){return this.op},0),function(w,A,u){var d=p(w,A,"DivideBase"),o=[d].concat(u),_=r.$r(o),c=d.$$prototype;c.lhs=c.rhs=c.op=$,E(d,"$initialize",function n(i,v){return delete n.$$p,M(this,a(this,"initialize",n,!1,!0),"initialize",[i,"/",v],null)},2),E(d,"$eval",function(i){var g,b,v=this;return g=v.lhs.$eval(i),b=v.rhs.$eval(i),I(b,0)&&v.$raise(_("ZeroDivisionError")),v.$divide_and_round(g,b,i)},1),E(d,"$output",function n(){var i=n.$$p||$,v=this;return delete n.$$p,""+M(v,a(v,"output",n,!1,!0),"output",[],i)+v.$rounding_method()},0),d.$private(),E(d,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")},0),E(d,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),E(d,"$divide_and_round",function(i,v,g){return this.$raise(_("NotImplementedError"))},3)}(k[0],y("BinaryOp"),k),function(w,A,u){var d=p(w,A,"DivideWithGameSystemDefault"),o=[d].concat(u),_=r.$r(o);C(o[0],"ROUNDING_METHOD",""),d.$private(),E(d,"$divide_and_round",function(n,i,v){var g;return x(t(_("RoundType"),"CEIL"),g=v)?q(n.$to_f(),i).$ceil():x(t(_("RoundType"),"ROUND"),g)?q(n.$to_f(),i).$round():q(n,i).$floor()},3)}(k[0],y("DivideBase"),k),function(w,A,u){var d=p(w,A,"DivideWithCeil"),o=[d].concat(u);C(o[0],"ROUNDING_METHOD","C"),d.$private(),E(d,"$divide_and_round",function(c,n,i){return q(c.$to_f(),n).$ceil()},3)}(k[0],y("DivideBase"),k),function(w,A,u){var d=p(w,A,"DivideWithRound"),o=[d].concat(u);C(o[0],"ROUNDING_METHOD","R"),d.$private(),E(d,"$divide_and_round",function(c,n,i){return q(c.$to_f(),n).$round()},3)}(k[0],y("DivideBase"),k),function(w,A,u){var d=p(w,A,"DivideWithFloor"),o=[d].concat(u);C(o[0],"ROUNDING_METHOD","F"),d.$private(),E(d,"$divide_and_round",function(c,n,i){return q(c,n).$to_i()},3)}(k[0],y("DivideBase"),k),function(w,A){var u=p(w,null,"Negative");u.$$prototype.body=$,E(u,"$initialize",function(_){return this.body=_},1),E(u,"$eval",function(_){return this.body.$eval(_)["$-@"]()},1),E(u,"$output",function(){return"-"+this.body.$output()},0),E(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(k[0]),function(w,A){var u=p(w,null,"Parenthesis");u.$$prototype.expr=$,E(u,"$initialize",function(_){return this.expr=_},1),E(u,"$eval",function(_){return this.expr.$eval(_)},1),E(u,"$output",function(){return"("+this.expr.$output()+")"},0),E(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(k[0]),function(w,A){var u=p(w,null,"Number");return u.$$prototype.value=$,E(u,"$initialize",function(_){return this.value=_},1),E(u,"$eval",function(_){return this.value},1),E(u,"$output",function(){return this.value.$to_s()},0),K(u,"s_exp","output")}(k[0])},Opal.modules.strscan=function(r){var W,U,G,X,Z,Y=[],$=r.nil,e=r.def,p=r.truthy,E=r.eqeqeq,M=r.Opal,a=r.send,I=r.to_a,C=r.rb_minus,x=r.alias;return W=Y,G=[U=(0,r.klass)(Y[0],null,"StringScanner")].concat(W),X=r.$r(G),(Z=U.$$prototype).pos=Z.string=Z.working=Z.matched=Z.prev_pos=Z.match=$,U.$attr_reader("pos","matched"),e(U,"$initialize",function(m){var f=this;return f.string=m,f.pos=0,f.matched=$,f.working=m,f.match=[]},1),U.$attr_reader("string"),e(U,"$beginning_of_line?",function(){var m=this;return 0===m.pos||"\n"===m.string.charAt(m.pos-1)},0),e(U,"$scan",function(m){var f=this,P=(m=f.$anchor(m)).exec(f.working);return null==P?f.matched=$:"object"==typeof P?(f.prev_pos=f.pos,f.pos+=P[0].length,f.working=f.working.substring(P[0].length),f.matched=P[0],f.match=P,P[0]):"string"==typeof P?(f.pos+=P.length,f.working=f.working.substring(P.length),P):$},1),e(U,"$scan_until",function(m){var f=this;m=f.$anchor(m);for(var H,P=f.pos,V=f.working;;){if(H=m.exec(V),P+=1,V=V.substr(1),null!=H)return f.matched=f.string.substr(f.pos,P-f.pos-1+H[0].length),f.match=H,f.prev_pos=P-1,f.pos=P,f.working=V.substr(H[0].length),f.matched;if(0===V.length)return f.match=[],f.matched=$}},1),e(U,"$[]",function(m){var P;if(p(this.match["$empty?"]()))return $;E(X("Symbol"),P=m)?m=m.$to_s():E(X("String"),P)||(m=M["$coerce_to!"](m,X("Integer"),"to_int"));var V=this.match;return m<0&&(m+=V.length),m<0||m>=V.length||null==V[m]?$:V[m]},1),e(U,"$check",function(m){var f=this,P=(m=f.$anchor(m)).exec(f.working);return f.matched=null==P?$:P[0]},1),e(U,"$check_until",function(m){var f=this,P=f.prev_pos,V=f.pos,H=f.$scan_until(m);return H!==$&&(f.matched=H.substr(-1),f.working=f.string.substr(V)),f.prev_pos=P,f.pos=V,H},1),e(U,"$peek",function(m){return this.working.substring(0,m)},1),e(U,"$eos?",function(){return 0===this.working.length},0),e(U,"$exist?",function(m){var P=m.exec(this.working);return null==P?$:0==P.index?0:P.index+1},1),e(U,"$skip",function(m){var f=this,P=(m=f.$anchor(m)).exec(f.working);if(null==P)return f.match=[],f.matched=$;var V=P[0],H=V.length;return f.matched=V,f.match=P,f.prev_pos=f.pos,f.pos+=H,f.working=f.working.substring(H),H},1),e(U,"$skip_until",function(m){var P=this.$scan_until(m);return P===$?$:(this.matched=P.substr(-1),P.length)},1),e(U,"$get_byte",function(){var m=this,f=$;return m.pos<m.string.length?(m.prev_pos=m.pos,m.pos+=1,f=m.matched=m.working.substring(0,1),m.working=m.working.substring(1)):m.matched=$,f},0),e(U,"$match?",function(m){var f=this,P=(m=f.$anchor(m)).exec(f.working);return null==P?$:(f.prev_pos=f.pos,P[0].length)},1),e(U,"$pos=",function(m){var f=this;return m<0&&(m+=f.string.$length()),f.pos=m,f.working=f.string.slice(m)},1),e(U,"$matched_size",function(){return this.matched===$?$:this.matched.length},0),e(U,"$post_match",function(){var m=this;return m.matched===$?$:m.string.substr(m.pos)},0),e(U,"$pre_match",function(){var m=this;return m.matched===$?$:m.string.substr(0,m.prev_pos)},0),e(U,"$reset",function(){var m=this;return m.working=m.string,m.matched=$,m.pos=0},0),e(U,"$rest",function(){return this.working},0),e(U,"$rest?",function(){return 0!==this.working.length},0),e(U,"$rest_size",function(){return this.$rest().$size()},0),e(U,"$terminate",function(){var f,m=this;return m.match=$,f=[m.string.$length()],a(m,"pos=",I(f)),f[C(f.length,1)]},0),e(U,"$unscan",function(){var m=this;return m.pos=m.prev_pos,m.prev_pos=$,m.match=$,m},0),x(U,"bol?","beginning_of_line?"),x(U,"getch","get_byte"),U.$private(),e(U,"$anchor",function(m){var f=m.toString().match(/\/([^\/]+)$/);return f=f?f[1]:void 0,new RegExp("^(?:"+m.source+")",f)},1)},Opal.modules["bcdice/normalize"]=function(r){var a,q,C,Y=[],$=r.nil,t=r.module,e=r.eqeqeq,p=r.def,E=r.eqeq;return a=Y,C=[t(Y[0],"BCDice")].concat(a),(q=t(C[0],"Normalize")).$module_function(),p(q,"$comparison_operator",function(W){var U;return e(/<=|=</,U=W)?"<=":e(/>=|=>/,U)?">=":e(/<>|!=|=!/,U)?"!=":e(/</,U)?"<":e(/>/,U)?">":e(/=/,U)?"==":$},1),p(q,"$target_number",function(W){return E(W,"?")?W:W.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var q,G,f,P,V,H,k,Z,W,Y=r.top,$=[],t=r.nil,e=r.module,p=r.klass,E=r.const_set,M=r.hash2,a=r.truthy,I=r.send,C=r.def;return Y.$require("strscan"),Y.$require("bcdice/normalize"),q=$,G=W=[e($[0],"BCDice")].concat(q),f=Z=[e(W[0],"Command")].concat(G),V=[P=p(Z[0],null,"Lexer")].concat(f),H=r.$r(V),(k=P.$$prototype).scanner=k.notations=t,E(V[0],"SYMBOLS",M(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),C(P,"$initialize",function(w,A){var u,d,_;return w=a(_=(d=(u=w)===t||null==u?t:I(u,"split",[" ",2]))===t||null==d?t:I(d,"first",[]))?_:"",this.scanner=H("StringScanner").$new(w),this.notations=I(A,"map",[],function(n){return null==n&&(n=t),a(n["$is_a?"](H("String")))?H("Regexp").$new(n):n},1)},2),C(P,"$next_token",function(){try{var w=this,A=t,u=t,o=t,_=t;return a(w.scanner["$eos?"]())?[!1,"$"]:(I(w.notations,"each",[],function c(n){var v,i=null==c.$$s?this:c.$$s;if(null==i.scanner&&(i.scanner=t),null==n&&(n=t),v=i.scanner.$scan(n),!a(v))return t;r.ret(["NOTATION",v])},{$$arity:1,$$s:w}),a(A=w.scanner.$scan(/\d+/))?["NUMBER",A.$to_i()]:a(u=w.scanner.$scan(/[<>!=]+/))?(u=H("Normalize").$comparison_operator(u),[a(u)?"CMP_OP":"ILLEGAL",u]):(o=w.scanner.$getch().$upcase(),[a(_=H("SYMBOLS")["$[]"](o))?_:o.$to_sym(),o]))}catch(c){if(c===r.returner)return c.$v;throw c}},0),C(P,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var I,K,Z,B,m,f,P,U,x,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.truthy,M=r.eqeqeq;return I=Y,K=x=[t(Y[0],"BCDice")].concat(I),Z=U=[t(x[0],"Command")].concat(K),m=[B=e(U[0],null,"Parsed")].concat(Z),f=r.$r(m),(P=B.$$prototype).question_target=P.critical=P.fumble=P.dollar=P.modify_number=P.target_number=P.prefix_number=P.command=P.suffix_number=P.cmp_op=$,B.$attr_accessor("command"),B.$attr_accessor("prefix_number"),B.$attr_accessor("suffix_number"),B.$attr_accessor("critical"),B.$attr_accessor("fumble"),B.$attr_accessor("dollar"),B.$attr_accessor("modify_number"),B.$attr_accessor("cmp_op"),B.$attr_accessor("target_number"),B.$attr_writer("question_target"),p(B,"$initialize",function(){var H=this;return H.prefix_number=$,H.suffix_number=$,H.critical=$,H.fumble=$,H.dollar=$,H.cmp_op=$,H.target_number=$,H.question_target=!1},0),p(B,"$question_target?",function(){return this.question_target},0),p(B,"$to_s",function(H){var o,k=this,y=$,w=$,A=$,u=$,d=$;return null==H&&(H="after_command"),y=E(k.critical)?"@"+k.critical:$,w=E(k.fumble)?"#"+k.fumble:$,A=E(k.dollar)?"$"+k.dollar:$,u=f("Format").$modifier(k.modify_number),d=E(k.question_target)?"?":k.target_number,M("after_command",o=H)?[k.prefix_number,k.command,k.suffix_number,y,w,A,u,k.cmp_op,d].$join():M("after_modify_number",o)?[k.prefix_number,k.command,k.suffix_number,u,y,w,A,k.cmp_op,d].$join():M("after_target_number",o)?[k.prefix_number,k.command,k.suffix_number,u,k.cmp_op,d,y,w,A].$join():$},-1)},Opal.modules["bcdice/command/parser"]=function(r){var f,k,o,i,v,g,b,l,T,L,s,j,le,_,c,n,ue,w,A,V,Y=r.top,$=[],t=r.$r($),e=r.nil,p=r.$$$,E=r.klass,M=r.module,a=r.hash2,I=r.send2,C=r.find_super,x=r.def,q=r.send,K=r.to_a,W=r.rb_minus,U=r.eqeq,G=r.hash,X=r.const_set,Z=r.truthy,B=r.to_ary;return Y.$require("racc/parser.rb"),Y.$require("bcdice/arithmetic/node"),Y.$require("bcdice/command/lexer"),Y.$require("bcdice/command/parsed"),E(p(t("BCDice"),"Command"),p(t("Racc"),"Parser"),"Parser"),f=$,k=V=[M($[0],"BCDice")].concat(f),w=[M(V[0],"Command")].concat(k),A=r.$r(w),o=w,c=[_=E(w[0],p(A("Racc"),"Parser"),"Parser")].concat(o),n=r.$r(c),(ue=_.$$prototype).notations=ue.lexer=ue.modifier=ue.suffix_number=ue.prefix_number=ue.need_suffix_number=ue.need_prefix_number=ue.critical=ue.fumble=ue.dollar=ue.allowed_cmp_op=ue.question_target=e,x(_,"$initialize",function $e(z,re){var S,N,ne,F,h=this;if(delete $e.$$p,S=r.slice.call(arguments),null==(N=r.extract_kwargs(S)))N=a([],{});else if(!N.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=S,!r.hasOwnProperty.call(N.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return F=N.$$smap.round_type,I(h,C(h,"initialize",$e,!1,!0),"initialize",[],null),h.notations=ne,h.round_type=F,h.prefix_number=!1,h.suffix_number=!1,h.need_prefix_number=!1,h.need_suffix_number=!1,h.modifier=!0,h.critical=!1,h.fumble=!1,h.dollar=!1,h.allowed_cmp_op=[e,">=",">","<=","<","==","!="],h.question_target=!1},-2),x(_,"$disable_modifier",function(){return this.modifier=!1,this},0),x(_,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),x(_,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),x(_,"$has_prefix_number",function(){var z=this;return z.prefix_number=!0,z.need_prefix_number=!0,z},0),x(_,"$has_suffix_number",function(){var z=this;return z.suffix_number=!0,z.need_suffix_number=!0,z},0),x(_,"$enable_critical",function(){return this.critical=!0,this},0),x(_,"$enable_fumble",function(){return this.fumble=!0,this},0),x(_,"$enable_dollar",function(){return this.dollar=!0,this},0),x(_,"$restrict_cmp_op_to",function(z){var re,N=this;return re=r.slice.call(arguments),N.allowed_cmp_op=re,N},-1),x(_,"$enable_question_target",function(){return this.question_target=!0,this},0),x(_,"$parse",function(z){try{return this.lexer=n("Lexer").$new(z,this.notations),this.$do_parse()}catch(S){if(!r.rescue(S,[n("ParseError"),n("ZeroDivisionError")]))throw S;try{return e}finally{r.pop_exception()}}},1),_.$private(),x(_,"$parsed",function(z,re,S,N){return q(n("Parsed").$new(),"tap",[],function F(O){var h,D,ee,ae,te,se,J=null==F.$$s?this:F.$$s,Q=e;return null==J.round_type&&(J.round_type=e),null==O&&(O=e),Q=[z["$[]"]("command")],q(O,"command=",K(Q)),W(Q.length,1),Q=[(h=z["$[]"]("prefix"),h===e||null==h?e:q(h,"eval",[J.round_type]))],q(O,"prefix_number=",K(Q)),W(Q.length,1),Q=[(D=z["$[]"]("suffix"),D===e||null==D?e:q(D,"eval",[J.round_type]))],q(O,"suffix_number=",K(Q)),W(Q.length,1),Q=[(ee=re["$[]"]("critical"),ee===e||null==ee?e:q(ee,"eval",[J.round_type]))],q(O,"critical=",K(Q)),W(Q.length,1),Q=[(ae=re["$[]"]("fumble"),ae===e||null==ae?e:q(ae,"eval",[J.round_type]))],q(O,"fumble=",K(Q)),W(Q.length,1),Q=[(te=re["$[]"]("dollar"),te===e||null==te?e:q(te,"eval",[J.round_type]))],q(O,"dollar=",K(Q)),W(Q.length,1),Q=[S.$eval(J.round_type)],q(O,"modify_number=",K(Q)),W(Q.length,1),Q=[N["$[]"]("cmp_op")],q(O,"cmp_op=",K(Q)),W(Q.length,1),U(N["$[]"]("target"),"?")?(q(O,"question_target=",K(Q=[!0])),W(Q.length,1),q(O,"target_number=",K(Q=[0])),Q[W(Q.length,1)]):(q(O,"question_target=",K(Q=[!1])),W(Q.length,1),Q=[(se=N["$[]"]("target"),se===e||null==se?e:q(se,"eval",[J.round_type]))],q(O,"target_number=",K(Q)),Q[W(Q.length,1)])},{$$arity:1,$$s:this})},4),x(_,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],v=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],g=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],b=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],l=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],T=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],L=[e,6,13,3,9,-1,27,-15,-10,-1,-38],s=[e,e,e,e,e,e,19,16,15,e,e],j=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],le=G(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),X(c[0],"Racc_arg",[i,v,b,g,l,T,s,L,19,j,le,58,35,!0]),X(c[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),X(c[0],"Racc_debug_parser",!1),x(_,"$_reduce_1",function(z,re,S){var N,F=this;return Z(F.modifier)||F.$raise(n("ParseError")),N=B(z),F.$parsed(null==N[0]?e:N[0],null==N[1]?e:N[1],null==N[2]?e:N[2],null==N[3]?e:N[3])},3),x(_,"$_reduce_2",function(z,re,S){var N,F=this;return Z(F.modifier)||F.$raise(n("ParseError")),N=B(z),F.$parsed(null==N[0]?e:N[0],null==N[2]?e:N[2],null==N[1]?e:N[1],null==N[3]?e:N[3])},3),x(_,"$_reduce_3",function(z,re,S){var N,D;return D=null==(N=B(z))[2]?e:N[2],this.$parsed(null==N[0]?e:N[0],null==N[1]?e:N[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),D)},3),x(_,"$_reduce_4",function(z,re,S){var N=this;return Z(N.prefix_number)&&Z(N.suffix_number)||N.$raise(n("ParseError")),a(["command","prefix","suffix"],{command:z["$[]"](1),prefix:z["$[]"](0),suffix:z["$[]"](2)})},3),x(_,"$_reduce_5",function(z,re,S){var N=this;return Z(N.prefix_number)||N.$raise(n("ParseError")),Z(N.need_suffix_number)&&N.$raise(n("ParseError")),a(["command","prefix"],{command:z["$[]"](1),prefix:z["$[]"](0)})},3),x(_,"$_reduce_6",function(z,re,S){var N=this;return Z(N.suffix_number)||N.$raise(n("ParseError")),Z(N.need_prefix_number)&&N.$raise(n("ParseError")),a(["command","suffix"],{command:z["$[]"](0),suffix:z["$[]"](1)})},3),x(_,"$_reduce_7",function(z,re,S){var N=this;return(Z(N.need_prefix_number)||Z(N.need_suffix_number))&&N.$raise(n("ParseError")),a(["command"],{command:z["$[]"](0)})},3),x(_,"$_reduce_8",function(z,re,S){return a([],{})},3),x(_,"$_reduce_9",function(z,re,S){var N,D,ee,O=e;return O=null==(N=B(z))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.critical)&&Z(O["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",K(ee=["critical",D])),W(ee.length,1),O},3),x(_,"$_reduce_10",function(z,re,S){var N,D,ee,O=e;return O=null==(N=B(z))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.fumble)&&Z(O["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",K(ee=["fumble",D])),W(ee.length,1),O},3),x(_,"$_reduce_11",function(z,re,S){var N,D,ee,O=e;return O=null==(N=B(z))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.dollar)&&Z(O["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",K(ee=["dollar",D])),W(ee.length,1),O},3),x(_,"$_reduce_12",function(z,re,S){return z["$[]"](1)},3),x(_,"$_reduce_13",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),x(_,"$_reduce_14",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),x(_,"$_reduce_15",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),x(_,"$_reduce_16",function(z,re,S){return Z(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),a([],{})},3),x(_,"$_reduce_17",function(z,re,S){var N,O,h;return h=null==(N=B(z))[1]?e:N[1],Z(this.allowed_cmp_op["$include?"](O=null==N[0]?e:N[0]))||this.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:O,target:h})},3),x(_,"$_reduce_18",function(z,re,S){var ne,N=this;return ne=z["$[]"](0),Z(N.question_target)||N.$raise(n("ParseError")),Z(N.allowed_cmp_op["$include?"](ne))||N.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),x(_,"$_reduce_19",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),x(_,"$_reduce_20",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),x(_,"$_reduce_22",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"*",z["$[]"](2))},3),x(_,"$_reduce_23",function(z,re,S){return z["$[]"](3).$new(z["$[]"](0),z["$[]"](2))},3),x(_,"$_reduce_25",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),x(_,"$_reduce_26",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(_,"$_reduce_27",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(_,"$_reduce_28",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),x(_,"$_reduce_29",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),x(_,"$_reduce_30",function(z,re,S){return z["$[]"](1)},3),x(_,"$_reduce_31",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),x(_,"$_reduce_33",function(z,re,S){return z["$[]"](1)},3),x(_,"$_reduce_34",function(z,re,S){return p(p(n("Arithmetic"),"Node"),"Number").$new(z["$[]"](0))},3),x(_,"$_reduce_none",function(z,re,S){return z["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var I,K,X,Z,B,m,U,x,Y=[],$=r.nil,t=r.module,e=r.send,p=r.eqeqeq,E=r.truthy,M=r.def;return I=Y,K=x=[t(Y[0],"BCDice")].concat(I),X=U=[t(x[0],"Deprecated")].concat(K),B=[Z=t(U[0],"Checker")].concat(X),m=r.$r(B),Z.$private(),M(Z,"$check_result_legacy",function(P,V,H,k){var u,y=this,w=$,A=$,d=$,o=$;return w=e(V,"map",[],"sides".$to_proc()),u=(A=e(V,"map",[],"value".$to_proc())).$sum(),d=p([100],o=w)?y.$check_1D100(P,u,H,k):p([20],o)?y.$check_1D20(P,u,H,k):p([6,6],o)?y.$check_2D6(P,u,A,H,k):$,(E(d["$nil?"]())||E(d["$empty?"]()))&&(d=p([10],o=w.$uniq())?y.$check_nD10(P,u,A,H,k):p([6],o)?y.$check_nD6(P,u,A,H,k):$,E(d["$nil?"]())||E(d["$empty?"]()))?$:m("Result").$new(d.$delete_prefix(" \uff1e "))},4),M(Z,"$check_1D100",function(P,V,H,k){return $},4),M(Z,"$check_1D20",function(P,V,H,k){return $},4),M(Z,"$check_nD10",function(P,V,H,k,y){return $},5),M(Z,"$check_2D6",function(P,V,H,k,y){return $},5),M(Z,"$check_nD6",function(P,V,H,k,y){return $},5)},Opal.modules["bcdice/base"]=function(r){var V,A,c,i,v,u,d,o,_,k,Y=r.top,$=[],t=r.$r($),e=r.nil,p=r.$$$,E=r.module,M=r.klass,a=r.truthy,I=r.def,C=r.regexp,x=r.rb_plus,q=r.send,K=r.to_a,W=r.rb_minus,U=r.eqeqeq,G=r.eqeq,X=r.range,Z=r.rb_divide,B=r.rb_times,m=r.rb_ge,f=e;return Y.$require("i18n"),Y.$require("i18n/backend/fallbacks"),Y.$require("bcdice/randomizer"),Y.$require("bcdice/dice_table"),Y.$require("bcdice/enum"),Y.$require("bcdice/translate"),Y.$require("bcdice/result"),Y.$require("bcdice/command/parser"),Y.$require("bcdice/deprecated/checker"),V=$,A=k=[E($[0],"BCDice")].concat(V),d=[u=M(k[0],null,"Base")].concat(A),o=r.$r(d),(_=u.$$prototype).sort_add_dice=_.sort_barabara_dice=_.enabled_d9=_.raw_input=_.randomizer=_.enabled_upcase_input=_.debug=e,i=[c=r.get_singleton_class(u)].concat(d),v=r.$r(i),c.$attr_reader("prefixes"),I(c,"$register_prefix",function(b){var T,L=this,s=e;return null==L.prefixes&&(L.prefixes=e),T=r.slice.call(arguments),L.prefixes=a(s=L.prefixes)?s:[],L.prefixes.$concat(T.$flatten())},-1),I(c,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),I(c,"$prefixes_pattern",function(){var b=this,l=e;return null==b.prefixes_pattern&&(b.prefixes_pattern=e),null==b.prefixes&&(b.prefixes=e),b.prefixes_pattern=a(l=b.prefixes_pattern)?l:e,a(b.prefixes_pattern)?b.prefixes_pattern:(b.prefixes=a(l=b.prefixes)?l:[],b.prefixes.$freeze(),b.prefixes_pattern=(a(b.prefixes["$empty?"]())?/(?!)/:C(["^(S)?(",b.prefixes.$join("|"),")"],"i")).$freeze())},0),I(c,"$command_pattern",function(){var b=this,l=e,T=e;return null==b.command_pattern&&(b.command_pattern=e),null==b.prefixes&&(b.prefixes=e),b.command_pattern=a(l=b.command_pattern)?l:e,a(b.command_pattern)?b.command_pattern:(b.prefixes=a(l=b.prefixes)?l:[],b.prefixes.$freeze(),T=x(q(p(v("CommonCommand"),"COMMANDS"),"map",[],function(s){return null==s&&(s=e),p(s,"PREFIX_PATTERN").$source()},1),b.prefixes),b.command_pattern=C(["^S?(",T.$join("|"),")"],"i").$freeze())},0),I(c,"$eval",function(b){return this.$new(b).$eval()},1),u.$include(o("Translate")),u.$include(p(o("Deprecated"),"Checker")),I(u,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=p(o("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=p(o("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=p(o("BCDice"),"Randomizer").$new(),i.debug=!1},1),u.$attr_accessor("randomizer"),u.$attr_reader("d66_sort_type"),u.$attr_reader("round_type"),u.$attr_reader("sides_implicit_d"),u.$attr_reader("upper_dice_reroll_threshold"),u.$attr_reader("reroll_dice_reroll_threshold"),u.$attr_reader("default_cmp_op"),u.$attr_reader("default_target_number"),I(u,"$sort_add_dice?",function(){return this.sort_add_dice},0),I(u,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),I(u,"$enabled_d9?",function(){return this.enabled_d9},0),I(u,"$enable_debug",function(){return this.debug=!0},0),I(u,"$eval",function(){var i,v,g,n=this,b=e;return i=p(o("BCDice"),"Preprocessor").$process(n.raw_input,n),v=a(g=n.$dice_command(i))?g:n.$eval_common_command(n.raw_input),a(v)?(b=[n.randomizer.$rand_results()],q(v,"rands=",K(b)),W(b.length,1),b=[n.randomizer.$detailed_rand_results()],q(v,"detailed_rands=",K(b)),W(b.length,1),v):e},0),I(u,"$change_text",function(n){return n},1),I(u,"$check_result",function(n,i,v,g){var b=this,l=e,T=e,L=e,s=e,j=e;return l=b.$check_result_legacy(n,i,v,g),a(l)?l:(T=q(i,"map",[],"sides".$to_proc()),s=(L=q(i,"map",[],"value".$to_proc())).$sum(),l=U([100],j=T)?b.$result_1d100(n,s,v,g):U([20],j)?b.$result_1d20(n,s,v,g):U([6,6],j)?b.$result_2d6(n,s,L,v,g):e,G(l,o("Result").$nothing())?e:a(l)?l:(l=U([10],j=T.$uniq())?b.$result_nd10(n,s,L,v,g):U([6],j)?b.$result_nd6(n,s,L,v,g):e,G(l,o("Result").$nothing())?e:a(l)?l:b.$result_ndx(n,v,g)))},4),I(u,"$grich_text",function(n,i,v){return e},3),u.$private(),I(u,"$eval_common_command",function(n){try{return n=this.$change_text(n),q(p(o("CommonCommand"),"COMMANDS"),"each",[],function v(g){var l,b=null==v.$$s?this:v.$$s;if(null==b.randomizer&&(b.randomizer=e),null==g&&(g=e),l=g.$eval(n,b,b.randomizer),!a(l))return e;r.ret(l)},{$$arity:1,$$s:this}),e}catch(v){if(v===r.returner)return v.$v;throw v}},1),I(u,"$dice_command",function(n){var i=this,v=e,g=e,b=e,l=e,T=e;return a(i.enabled_upcase_input)&&(n=n.$upcase()),v=i.$class().$prefixes_pattern().$match(n),a(v)?(g=v["$[]"](1)["$nil?"]()["$!"](),a(g)&&(n=n["$[]"](X(1,-1,!1))),b=i.$eval_game_system_specific_command(n),a(b["$is_a?"](o("Result")))?(l=[a(T=b["$secret?"]())?T:g],q(b,"secret=",K(l)),W(l.length,1),b):a(b["$nil?"]())||a(b["$empty?"]())||G(b,"1")?e:q(o("Result").$new(),"tap",[],function(s){return null==s&&(s=e),l=[b.$to_s()],q(s,"text=",K(l)),W(l.length,1),q(s,"secret=",K(l=[g])),l[W(l.length,1)]},1)):e},1),I(u,"$eval_game_system_specific_command",function(n){return e},1),I(u,"$result_ndx",function(n,i,v){return a(v["$is_a?"](o("String")))?e:a(n.$send(i,v))?o("Result").$success(this.$translate("success")):o("Result").$failure(this.$translate("failure"))},3),I(u,"$result_1d100",function(n,i,v,g){return e},4),I(u,"$result_1d20",function(n,i,v,g){return e},4),I(u,"$result_nd10",function(n,i,v,g,b){return e},5),I(u,"$result_2d6",function(n,i,v,g,b){return e},5),I(u,"$result_nd6",function(n,i,v,g,b){return e},5),I(u,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),I(u,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),I(u,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),I(u,"$get_table_by_nDx",function(n,i,v){var b,l=e;return b=this.randomizer.$roll_sum(i,v),l=this.$get_table_value(n["$[]"](W(b,i))),a(l["$nil?"]())?["1",0]:[l,b]},3),I(u,"$get_table_by_1d3",function(n){var g,b,i=this,l=e;return i.$debug("get_table_by_1d3"),g=i.randomizer.$roll_sum(1,6),i.$debug("num",g),b=Z(W(g,1),2).$to_i(),i.$debug("index",b),l=n["$[]"](b),a(l["$nil?"]())?["1",0]:[l,g]},1),I(u,"$get_table_by_d66_swap",function(n){var v;return v=this.randomizer.$roll_d66(p(o("D66SortType"),"ASC")),[this.$get_table_by_number(v,n),v]},1),I(u,"$get_table_by_d66",function(n){var v,g,b,T,l=e;return v=this.randomizer.$roll_once(6),g=this.randomizer.$roll_once(6),b=x(B(W(v,1),6),W(g,1)),l=n["$[]"](b),T=""+v+g,a(l["$nil?"]())?["1",T]:[l,T]},1),I(u,"$get_table_by_number",function(n,i,v){try{return null==v&&(v="1"),q(i,"each",[],function b(l){var L,T=null==b.$$s?this:b.$$s;if(null==l&&(l=e),L=l["$[]"](0),!a(m(L,n)))return e;r.ret(T.$get_table_value(l["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(v)}catch(b){if(b===r.returner)return b.$v;throw b}},-3),I(u,"$get_table_value",function(n){return a(n["$is_a?"](o("Proc")))?n.$call():n},1),I(u,"$roll_tables",function(n,i){var g=e;return g=i["$[]"](n),a(g)?g.$roll(this.randomizer).$to_s():e},2),I(u,"$debug",function(n,i){var g,b=this,l=e,T=e;return g=r.slice.call(arguments,1),a(b.debug)?(l=a(n["$is_a?"](o("String")))?n:n.$inspect(),a(g["$empty?"]())?b.$warn(l):(T=q(g,"map",[],function(s){return null==s&&(s=e),a(s["$is_a?"](o("String")))?'"'+s+'"':s.$inspect()},1),b.$warn(l+": "+T.$join(", ")))):e},-2),p(p(t("I18n"),"Backend"),"Simple").$include(p(p(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),f=["ja_jp"],q(t("I18n"),"default_locale=",K(f)),W(f.length,1),f=[["ja_jp"]],q(t("I18n").$fallbacks(),"defaults=",K(f)),f[W(f.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(r){var q,G,P,w,A,u,d,H,Z,B,W,$=[],t=r.nil,e=r.module,p=r.klass,E=r.const_set,M=r.hash2,a=r.truthy,I=r.send,C=r.def;return r.top.$require("strscan"),q=$,G=W=[e($[0],"BCDice")].concat(q),Z=[e(W[0],"GameSystem")].concat(G),B=r.$r(Z),P=Z,w=H=[p(Z[0],B("Base"),"SwordWorld")].concat(P),u=[A=p(H[0],null,"RatingLexer")].concat(w),d=r.$r(u),A.$$prototype.scanner=t,E(u[0],"SYMBOLS",M(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),C(A,"$initialize",function(c){var n,i,g;return c=a(g=(i=(n=c)===t||null==n?t:I(n,"split",[" ",2]))===t||null==i?t:I(i,"first",[]))?g:"",this.scanner=d("StringScanner").$new(c)},1),C(A,"$next_token",function(){var c=this,n=t,i=t,g=t;return a(c.scanner["$eos?"]())?[!1,"$"]:a(n=c.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:(i=c.scanner.$getch().$upcase(),[a(g=d("SYMBOLS")["$[]"](i))?g:i.$to_sym(),i])},0),C(A,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(r){var K,X,V,A,u,d,o,_,k,B,m,U,Y=[],$=r.nil,t=r.module,e=r.klass,p=r.def,E=r.truthy,M=r.rb_lt,a=r.rb_plus,I=r.eqeq,C=r.rb_gt,x=r.neqeq;return K=Y,X=U=[t(Y[0],"BCDice")].concat(K),B=[t(U[0],"GameSystem")].concat(X),m=r.$r(B),V=B,A=k=[e(B[0],m("Base"),"SwordWorld")].concat(V),d=[u=e(k[0],null,"RatingParsed")].concat(A),o=r.$r(d),(_=u.$$prototype).modifier_after_half=_.critical=_.semi_fixed_val=_.kept_modify=_.first_modify=_.first_to=_.rateup=_.tmp_fixed_val=_.rate=_.greatest_fortune=_.modifier=$,u.$attr_accessor("rate"),u.$attr_writer("critical"),u.$attr_writer("kept_modify"),u.$attr_writer("first_to"),u.$attr_writer("first_modify"),u.$attr_writer("rateup"),u.$attr_accessor("greatest_fortune"),u.$attr_writer("semi_fixed_val"),u.$attr_writer("tmp_fixed_val"),u.$attr_accessor("modifier"),u.$attr_writer("modifier_after_half"),p(u,"$initialize",function(){var n=this;return n.critical=$,n.min_critical=$,n.kept_modify=$,n.first_to=$,n.first_modify=$,n.greatest_fortune=!1,n.rateup=$,n.semi_fixed_val=$,n.tmp_fixed_val=$},0),p(u,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()},0),p(u,"$critical",function(){var i;return E(i=this.critical)?i:E(this.$half())?13:10},0),p(u,"$min_critical",function(){var n=this,i=$;return i=3,E(n.semi_fixed_val["$nil?"]())||(E(n.kept_modify["$nil?"]())?E(M(i,a(n.semi_fixed_val,2)))&&(i=a(n.semi_fixed_val,2)):E(M(i,a(a(n.semi_fixed_val,n.kept_modify),2)))&&(i=a(a(n.semi_fixed_val,n.kept_modify),2)),I(n.semi_fixed_val,1)&&(i=3)),E(C(i,13))&&(i=13),i},0),p(u,"$first_modify",function(){var i;return E(i=this.first_modify)?i:0},0),p(u,"$first_to",function(){var i;return E(i=this.first_to)?i:0},0),p(u,"$rateup",function(){var i;return E(i=this.rateup)?i:0},0),p(u,"$semi_fixed_val",function(){var v,i=$;return i=E(v=this.semi_fixed_val)?v:0,E(C(i,6))&&(i=6),i},0),p(u,"$tmp_fixed_val",function(){var v,i=$;return i=E(v=this.tmp_fixed_val)?v:0,E(C(i,6))&&(i=6),i},0),p(u,"$kept_modify",function(){var i;return E(i=this.kept_modify)?i:0},0),p(u,"$modifier_after_half",function(){var i;return E(i=this.modifier_after_half)?i:0},0),p(u,"$to_s",function(){var n=this,i=$;return i="KeyNo."+n.rate,E(M(n.$critical(),13))&&(i=a(i,"c["+n.$critical()+"]")),x(n.$first_modify(),0)&&(i=a(i,"m["+o("Format").$modifier(n.$first_modify())+"]")),x(n.$first_to(),0)&&(i=a(i,"m["+n.$first_to()+"]")),x(n.$rateup(),0)&&(i=a(i,"r["+n.$rateup()+"]")),E(n.greatest_fortune)&&(i=a(i,"gf")),x(n.$semi_fixed_val(),0)&&(i=a(i,"sf["+n.$semi_fixed_val()+"]")),x(n.$tmp_fixed_val(),0)&&(i=a(i,"tf["+n.$tmp_fixed_val()+"]")),x(n.$kept_modify(),0)&&(i=a(i,"a["+o("Format").$modifier(n.$kept_modify())+"]")),x(n.modifier,0)&&(i=a(i,o("Format").$modifier(n.modifier))),i},0),p(u,"$infinite_roll?",function(){return M(this.$critical(),this.$min_critical())},0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(r){var m,H,d,v,T,L,s,j,R,ie,le,_e,oe,z,g,b,l,N,_,c,y,w,P,Y=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,E=r.klass,M=r.hash2,a=r.send2,I=r.find_super,C=r.def,x=r.send,q=r.to_a,K=r.rb_minus,W=r.hash,U=r.const_set,G=r.to_ary,X=r.truthy,Z=r.eqeq;return Y.$require("racc/parser.rb"),Y.$require("bcdice/arithmetic/node"),Y.$require("bcdice/enum"),Y.$require("bcdice/game_system/sword_world/rating_lexer"),Y.$require("bcdice/game_system/sword_world/rating_parsed"),m=$,H=P=[p($[0],"BCDice")].concat(m),y=[p(P[0],"GameSystem")].concat(H),w=r.$r(y),d=y,_=[E(y[0],w("Base"),"SwordWorld")].concat(d),c=r.$r(_),v=_,b=[g=E(_[0],e(c("Racc"),"Parser"),"RatingParser")].concat(v),l=r.$r(b),(N=g.$$prototype).lexer=N.version=t,C(g,"$initialize",function ne(F){var O,h;if(delete ne.$$p,null==F)F=M([],{});else if(!F.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(O=F.$$smap.version)&&(O="v1_0"),null==(h=F.$$smap.round_type)&&(h=e(l("RoundType"),"CEIL")),a(this,I(this,"initialize",ne,!1,!0),"initialize",[],null),this.version=O,this.round_type=h},-1),C(g,"$set_debug",function(){return this.yydebug=!0,this},0),C(g,"$parse",function(F){try{return this.lexer=l("RatingLexer").$new(F),this.$do_parse()}catch(h){if(!r.rescue(h,[l("ParseError"),l("ZeroDivisionError")]))throw h;try{return t}finally{r.pop_exception()}}},1),g.$private(),C(g,"$parsed",function(F,O,h){return x(l("RatingParsed").$new(),"tap",[],function ee(ae){var te,se,J,Q,fe=null==ee.$$s?this:ee.$$s,ce=t;return null==fe.round_type&&(fe.round_type=t),null==ae&&(ae=t),x(ae,"rate=",q(ce=[F])),K(ce.length,1),ce=[(te=h["$[]"]("critical"),te===t||null==te?t:x(te,"eval",[fe.round_type]))],x(ae,"critical=",q(ce)),K(ce.length,1),ce=[(se=h["$[]"]("kept_modify"),se===t||null==se?t:x(se,"eval",[fe.round_type]))],x(ae,"kept_modify=",q(ce)),K(ce.length,1),ce=[h["$[]"]("first_to")],x(ae,"first_to=",q(ce)),K(ce.length,1),ce=[h["$[]"]("first_modify")],x(ae,"first_modify=",q(ce)),K(ce.length,1),ce=[(J=h["$[]"]("rateup"),J===t||null==J?t:x(J,"eval",[fe.round_type]))],x(ae,"rateup=",q(ce)),K(ce.length,1),ce=[h.$fetch("greatest_fortune",!1)],x(ae,"greatest_fortune=",q(ce)),K(ce.length,1),ce=[h["$[]"]("semi_fixed_val")],x(ae,"semi_fixed_val=",q(ce)),K(ce.length,1),ce=[h["$[]"]("tmp_fixed_val")],x(ae,"tmp_fixed_val=",q(ce)),K(ce.length,1),ce=[O.$eval(fe.round_type)],x(ae,"modifier=",q(ce)),K(ce.length,1),ce=[(Q=h["$[]"]("modifier_after_half"),Q===t||null==Q?t:x(Q,"eval",[fe.round_type]))],x(ae,"modifier_after_half=",q(ce)),ce[K(ce.length,1)]},{$$arity:1,$$s:this})},3),C(g,"$next_token",function(){return this.lexer.$next_token()},0),T=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],L=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],s=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],j=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],R=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],ie=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],le=[t,5,11,0,t,-11,-11,-23,t],_e=[t,t,t,t,10,42,t,t,28],oe=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],z=W(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),U(b[0],"Racc_arg",[T,L,j,s,R,ie,_e,le,21,oe,z,64,33,!0]),U(b[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),U(b[0],"Racc_debug_parser",!1),C(g,"$_reduce_1",function(F,O,h){var D,te,J,Q,se=t;return te=null==(D=G(F))[0]?t:D[0],J=X(Q=(se=null==D[1]?t:D[1])["$[]"]("modifier"))?Q:e(e(l("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(te,J,se)},3),C(g,"$_reduce_2",function(F,O,h){var D,se,Q,ce,J=t,fe=t;return se=null==(D=G(F))[1]?t:D[1],X((J=null==D[2]?t:D[2])["$[]"]("modifier_after_half"))||(fe=["modifier_after_half",e(e(l("Arithmetic"),"Node"),"Number").$new(0)],x(J,"[]=",q(fe)),K(fe.length,1)),ce=X(Q=J["$[]"]("modifier"))?Q:e(e(l("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(se,ce,J)},3),C(g,"$_reduce_3",function(F,O,h){return F["$[]"](1).$to_i()},3),C(g,"$_reduce_4",function(F,O,h){return M([],{})},3),C(g,"$_reduce_5",function(F,O,h){var D,se,J,te=t;return se=null==(D=G(F))[1]?t:D[1],X((te=null==D[0]?t:D[0])["$[]"]("modifier")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(J=["modifier",se])),K(J.length,1),te},3),C(g,"$_reduce_6",function(F,O,h){var D,J,Q,te=t;return J=null==(D=G(F))[2]?t:D[2],X((te=null==D[0]?t:D[0])["$[]"]("critical")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(Q=["critical",J])),K(Q.length,1),te},3),C(g,"$_reduce_7",function(F,O,h){var D,J,Q,te=t;return J=null==(D=G(F))[2]?t:D[2],X((te=null==D[0]?t:D[0])["$[]"]("critical")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(Q=["critical",J])),K(Q.length,1),te},3),C(g,"$_reduce_8",function(F,O,h){var D,Q,te=t,J=t;return J=null==(D=G(F))[2]?t:D[2],X((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&X(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_to",J.$to_i()],x(te,"[]=",q(Q)),K(Q.length,1),te},3),C(g,"$_reduce_9",function(F,O,h){var D,Q,te=t,J=t;return J=null==(D=G(F))[3]?t:D[3],X((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&X(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_modify",J.$to_i()],x(te,"[]=",q(Q)),K(Q.length,1),te},3),C(g,"$_reduce_10",function(F,O,h){var D,Q,te=t,J=t;return J=null==(D=G(F))[3]?t:D[3],X((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&X(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_modify",J.$to_i()["$-@"]()],x(te,"[]=",q(Q)),K(Q.length,1),te},3),C(g,"$_reduce_11",function(F,O,h){var D,J,te=t;return D=G(F),X((te=null==D[0]?t:D[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(l("ParseError")),J=["modifier_after_half",e(e(l("Arithmetic"),"Node"),"Number").$new(0)],x(te,"[]=",q(J)),K(J.length,1),te},3),C(g,"$_reduce_12",function(F,O,h){var D,J,Q,te=t;return J=null==(D=G(F))[2]?t:D[2],X((te=null==D[0]?t:D[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(Q=["modifier_after_half",J])),K(Q.length,1),te},3),C(g,"$_reduce_13",function(F,O,h){var D,J,Q,te=t;return te=null==(D=G(F))[0]?t:D[0],J=null==D[2]?t:D[2],X(["v2_5","v2_0"]["$include?"](this.version))&&X(te["$[]"]("rateup")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(Q=["rateup",J])),K(Q.length,1),te},3),C(g,"$_reduce_14",function(F,O,h){var D,J,ae=this,te=t;return te=null==(D=G(F))[0]?t:D[0],X(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),X(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),x(te,"[]=",q(J=["greatest_fortune",!0])),K(J.length,1),te},3),C(g,"$_reduce_15",function(F,O,h){var D,Q,ae=this,te=t,J=t;return te=null==(D=G(F))[0]?t:D[0],J=null==D[3]?t:D[3],X(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),X(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),Q=["semi_fixed_val",J.$to_i()],x(te,"[]=",q(Q)),K(Q.length,1),te},3),C(g,"$_reduce_16",function(F,O,h){var D,Q,ae=this,te=t,J=t;return te=null==(D=G(F))[0]?t:D[0],J=null==D[3]?t:D[3],X(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),X(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),X(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),Q=["tmp_fixed_val",J.$to_i()],x(te,"[]=",q(Q)),K(Q.length,1),te},3),C(g,"$_reduce_17",function(F,O,h){var D,J,Q,te=t;return te=null==(D=G(F))[0]?t:D[0],J=null==D[2]?t:D[2],Z(this.version,"v2_5")&&X(te["$[]"]("kept_modify")["$nil?"]())||this.$raise(l("ParseError")),x(te,"[]=",q(Q=["kept_modify",J])),K(Q.length,1),te},3),C(g,"$_reduce_18",function(F,O,h){return F["$[]"](1)},3),C(g,"$_reduce_19",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"Negative").$new(F["$[]"](1))},3),C(g,"$_reduce_20",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(F["$[]"](0),"+",F["$[]"](2))},3),C(g,"$_reduce_21",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(F["$[]"](0),"-",F["$[]"](2))},3),C(g,"$_reduce_22",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(F["$[]"](0),"+",F["$[]"](2))},3),C(g,"$_reduce_23",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(F["$[]"](0),"-",F["$[]"](2))},3),C(g,"$_reduce_25",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(F["$[]"](0),"*",F["$[]"](2))},3),C(g,"$_reduce_26",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(F["$[]"](0),F["$[]"](2))},3),C(g,"$_reduce_28",function(F,O,h){return F["$[]"](1)},3),C(g,"$_reduce_29",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"Negative").$new(F["$[]"](1))},3),C(g,"$_reduce_31",function(F,O,h){return F["$[]"](1)},3),C(g,"$_reduce_32",function(F,O,h){return e(e(l("Arithmetic"),"Node"),"Number").$new(F["$[]"](0))},3),C(g,"$_reduce_none",function(F,O,h){return F["$[]"](0)},3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(r){var k,u,i,v,g,b,l,o,_,w,Y=r.top,$=[],t=r.nil,e=r.module,p=r.klass,E=r.const_set,M=r.send2,a=r.find_super,I=r.def,C=r.truthy,x=r.rb_ge,q=r.rb_le,K=r.eqeq,W=r.neqeq,U=r.rb_minus,G=r.rb_gt,X=r.send,Z=r.to_ary,B=r.rb_plus,m=r.rb_lt,f=r.rb_times,P=r.to_a,V=r.rb_divide;return Y.$require("bcdice/base"),Y.$require("bcdice/game_system/sword_world/rating_parser"),k=$,u=w=[e($[0],"BCDice")].concat(k),o=[e(w[0],"GameSystem")].concat(u),_=r.$r(o),i=o,g=[v=p(o[0],_("Base"),"SwordWorld")].concat(i),b=r.$r(g),(l=v.$$prototype).rating_table=l.randomizer=t,E(g[0],"ID","SwordWorld"),E(g[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),E(g[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),E(g[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),v.$register_prefix("H?K"),I(v,"$initialize",function T(L){var j=this;return delete T.$$p,M(j,a(j,"initialize",T,!1,!0),"initialize",[L],null),j.rating_table=0},1),I(v,"$result_2d6",function(L,s,j,R,ie){return C(x(s,12))?b("Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):C(q(s,2))?b("Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):W(R,">=")||K(ie,"?")?t:C(x(L,ie))?b("Result").$success("\u6210\u529f"):b("Result").$failure("\u5931\u6557")},5),I(v,"$eval_game_system_specific_command",function(L){return this.$rating(L)},1),v.$private(),I(v,"$rating_parser",function(){return b("RatingParser").$new()},0),I(v,"$rating",function(L){var s,j,R=this,ie=t,le=t,_e=t,oe=t,ue=t,$e=t,z=t,re=t,S=t,N=t,ne=t,F=t,O=t,h=t,ee=t,ae=t;return R.$debug("rating string",L),ie=R.$rating_parser().$parse(L),C(ie)?(le=R.$getSW2_0_RatingTable(),_e=U(le.$length(),1),R.$debug("keyMax",_e),C(G(ie.$rate(),_e))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+_e+"\u307e\u3067\u3067\u3059":C(ie["$infinite_roll?"]())?b("Result").$new("C\u5024\u3092"+ie.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(oe=R.$getNewRates(le),ue=ie+" \uff1e ",$e=[],z=[],re=[],S=0,N=0,ne=0,F=0,O=ie.$first_to(),h=ie.$first_modify(),function(){var te=r.new_brk();try{X(R,"loop",[],function se(){var J,Q,ve,de,fe=null==se.$$s?this:se.$$s,ce=t,me=t;if(Q=fe.$rollDice(ie,F),me=null==(J=Z(Q))[1]?t:J[1],S=ce=null==J[0]?t:J[0],W(O,0)?(S=ce=O,O=0):W(h,0)&&(S=B(S,h),h=0),C(q(ce,2))&&($e["$<<"](ce.$to_s()),z["$<<"](me.$to_s()),re["$<<"]("**"),F=B(F,1),r.brk(t,te)),W(ie.$kept_modify(),0)&&W(S,2)&&(S=B(S,ie.$kept_modify())),C(m(S,2))&&(S=2),C(G(S,12))&&(S=12),ve=[B(ie.$rate(),f(F,ie.$rateup())),_e].$min(),fe.$debug("currentKey",ve),de=oe["$[]"](S)["$[]"](ve),fe.$debug("rateValue",de),ne=B(ne,de),N=B(N,S),$e["$<<"](S.$to_s()),z["$<<"](me.$to_s()),re["$<<"](C(G(S,2))?de:"**"),F=B(F,1),C(x(S,ie.$critical())))return t;r.brk(t,te)},{$$arity:0,$$s:R,$$brk:te})}catch(se){if(se===te)return se.$v;throw se}}(),j=R.$getResultText(ne,ie,z,$e,re,N,F),s=Z(j),ee=null==s[1]?t:s[1],ae=null==s[2]?t:s[2],ue=B(ue,null==s[0]?t:s[0]),X(b("Result").$new(),"tap",[],function(se){var J=t;return null==se&&(se=t),X(se,"text=",P(J=[ue])),U(J.length,1),X(se,"critical=",P(J=[ee])),U(J.length,1),X(se,"fumble=",P(J=[ae])),J[U(J.length,1)]},1))):(R.$debug("not matched"),"1")},1),I(v,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},0),I(v,"$getNewRates",function(L){var j=t,R=t,ie=t,le=t,_e=t,oe=t,ue=t,$e=t,z=t,re=t,S=t,N=t;return j=[],R=[],ie=[],le=[],_e=[],oe=[],ue=[],$e=[],z=[],re=[],S=[],X(L,"each",[],function(O){var h=t;return null==O&&(O=t),h=O.$split(/,/),S.$push(0),j.$push(h["$[]"](1).$to_i()),R.$push(h["$[]"](2).$to_i()),ie.$push(h["$[]"](3).$to_i()),le.$push(h["$[]"](4).$to_i()),_e.$push(h["$[]"](5).$to_i()),oe.$push(h["$[]"](6).$to_i()),ue.$push(h["$[]"](7).$to_i()),$e.$push(h["$[]"](8).$to_i()),z.$push(h["$[]"](9).$to_i()),re.$push(h["$[]"](10).$to_i())},1),K(this.rating_table,1)&&(N=[31,(N=[32,(N=[33,10],X(re,"[]=",P(N)),N[U(N.length,1)])],X(re,"[]=",P(N)),N[U(N.length,1)])],X(re,"[]=",P(N)),U(N.length,1)),[S,S,S,j,R,ie,le,_e,oe,ue,$e,z,re]},1),I(v,"$rollDice",function(L,s){var R=t;return[(R=this.randomizer.$roll_barabara(2,6)).$sum(),R.$join(",")]},2),I(v,"$getResultText",function(L,s,j,R,ie,le,_e){var oe=t,ue=t,$e=t,z=t,re=t;return(oe=[]).$push("2D:["+j.$join(" ")+"]="+R.$join(",")),C(q(le,2))?(oe.$push(ie.$join(",")),oe.$push("\u81ea\u52d5\u7684\u5931\u6557"),[oe.$join(" \uff1e "),!1,!0]):(C(G(ie.$size(),1))||W(s.$modifier(),0)?(ue=B(ie.$join(","),b("Format").$modifier(s.$modifier())),C(s.$half())&&(ue="("+ue+")/2",W(s.$modifier_after_half(),0)&&(ue=B(ue,b("Format").$modifier(s.$modifier_after_half())))),oe.$push(ue)):C(s.$half())&&(ue=ie.$first()+"/2",W(s.$modifier_after_half(),0)&&(ue=B(ue,b("Format").$modifier(s.$modifier_after_half()))),oe.$push(ue)),C(G(_e,1))&&($e=U(_e,1)+"\u56de\u8ee2",oe.$push($e)),z=B(L,s.$modifier()),C(s.$half())&&(z=V(z,2).$ceil(),W(s.$modifier_after_half(),0)&&(z=B(z,s.$modifier_after_half()))),re=z.$to_s(),oe.$push(re),[oe.$join(" \uff1e "),G(_e,1),!1])},7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(r){var Z,P,A,c,n,i,v,g,d,H,k,m,$=[],t=r.nil,e=r.module,p=r.klass,E=r.const_set,M=r.hash2,a=r.def,I=r.truthy,C=r.rb_lt,x=r.not,q=r.rb_ge,K=r.rb_plus,W=r.send,U=r.to_a,G=r.rb_minus;return r.top.$require("bcdice/result"),Z=$,P=m=[e($[0],"BCDice")].concat(Z),H=[e(m[0],"GameSystem")].concat(P),k=r.$r(H),A=H,c=d=[p(H[0],k("SwordWorld"),"SwordWorld2_0")].concat(A),i=[n=p(d[0],null,"TranscendentTest")].concat(c),v=r.$r(i),(g=n.$$prototype).modifier=g.critical_value=g.expression=g.modifier_str=g.target=g.cmp_op=t,E(i[0],"RESULT_STR",M(["success","failure","super_success","critical","fumble"],{success:"\u6210\u529f",failure:"\u5931\u6557",super_success:"\u8d85\u6210\u529f",critical:"\u81ea\u52d5\u7684\u6210\u529f",fumble:"\u81ea\u52d5\u7684\u5931\u6557"}).$freeze()),a(n,"$initialize",function(l,T,L,s){var j=this;return j.critical_value=l,j.modifier=T,j.cmp_op=L,j.target=s,j.modifier_str=v("Format").$modifier(j.modifier),j.expression=j.$node_expression()},4),a(n,"$execute",function(l){var R,ie,le,L=this,s=t,j=t,_e=t,oe=t,ue=t;if(I(C(L.critical_value,3)))return"("+L.expression+") \uff1e \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u30023\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002";if(j=[s=l.$roll_barabara(2,6)],R=s["$=="]([1,1]),ie=s["$=="]([6,6]),x(R)&&x(ie))for(;I(q(L.$sum_of_dice(j.$last()),L.critical_value));)j.$push(l.$roll_barabara(2,6));return le=L.$sum_of_dice(j),_e=K(le,L.modifier),oe=L.$result_status(_e,j.$length(),R,ie),ue=["("+L.expression+")",""+L.$dice_str(j,le)+L.modifier_str,_e,v("RESULT_STR")["$[]"](oe)].$compact(),W(v("Result").$new(),"tap",[],function(z){var re=t;return null==z&&(z=t),re=[ue.$join(" \uff1e ")],W(z,"text=",U(re)),G(re.length,1),re=[oe["$=="]("fumble")],W(z,"fumble=",U(re)),G(re.length,1),re=[oe["$=="]("critical")],W(z,"critical=",U(re)),G(re.length,1),re=[["success","super_success","critical"]["$include?"](oe)],W(z,"success=",U(re)),G(re.length,1),re=[["failure","fumble"]["$include?"](oe)],W(z,"failure=",U(re)),re[G(re.length,1)]},1)},1),n.$private(),a(n,"$node_expression",function(){var T,l=this;return T="2D6@"+l.critical_value+l.modifier_str,I(l.target)?""+T+l.cmp_op+l.target:T},0),a(n,"$sum_of_dice",function(l){return l.$flatten().$sum()},1),a(n,"$dice_str",function(l,T){return""+T+W(l,"map",[],function(j){return null==j&&(j=t),"["+j.$join(",")+"]"},1).$join()},2),a(n,"$result_status",function(l,T,L,s){var j=this;return I(j.target)?I(L)?"fumble":I(s)?"critical":I(l.$send(j.cmp_op,j.target))?I(q(T,2))&&I(q(l,41))?"super_success":"success":"failure":"no_target"},4)},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(r){var V,w,c,n,i,v,u,d,k,Y=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,E=r.klass,M=r.const_set,a=r.send2,I=r.find_super,C=r.def,x=r.eqeqeq,q=r.truthy,K=r.hash2,W=r.rb_gt,U=r.rb_plus,G=r.eqeq,X=r.rb_times,Z=r.send,B=r.neqeq,m=r.rb_minus,f=r.to_ary;return Y.$require("bcdice/arithmetic_evaluator"),Y.$require("bcdice/game_system/SwordWorld"),Y.$require("bcdice/game_system/sword_world/transcendent_test"),V=$,w=k=[p($[0],"BCDice")].concat(V),u=[p(k[0],"GameSystem")].concat(w),d=r.$r(u),c=u,i=[n=E(u[0],d("SwordWorld"),"SwordWorld2_0")].concat(c),v=r.$r(i),n.$$prototype.randomizer=t,M(i[0],"ID","SwordWorld2.0"),M(i[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),M(i[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),M(i[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),n.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),C(n,"$initialize",function b(l){var L=this;return delete b.$$p,a(L,I(L,"initialize",b,!1,!0),"initialize",[l],null),L.rating_table=2},1),C(n,"$eval_game_system_specific_command",function b(l){var s,L=this,R=t;return delete b.$$p,x(/^Gr(\d+)?/i,s=l)?q(l["$=~"](/^Gr(\d+)/i))?L.$growth(v("Regexp").$last_match(1).$to_i()):L.$growth():x(/^2D6?@\d+/i,s)?(R=e(v("Command"),"Parser").$new(/2D6?/i,K(["round_type"],{round_type:e(e(v("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(t,">=",">").$parse(l),q(R)?v("TranscendentTest").$new(R.$critical(),R.$modify_number(),R.$cmp_op(),R.$target_number()).$execute(L.randomizer):t):x("FT",s)?L.$get_fumble_table():x("TT",s)?L.$get_tangle_table():a(L,I(L,"eval_game_system_specific_command",b,!1,!0),"eval_game_system_specific_command",[l],null)},1),C(n,"$rating_parser",function(){return v("RatingParser").$new(K(["version"],{version:"v2_0"}))},0),C(n,"$rollDice",function b(l,T){var s=this,j=t;return delete b.$$p,q(W(l.$semi_fixed_val(),0))?(j=s.randomizer.$roll_once(6),[U(j,l.$semi_fixed_val()),j+","+l.$semi_fixed_val()]):G(T,0)&&q(W(l.$tmp_fixed_val(),0))?(j=s.randomizer.$roll_once(6),[U(j,l.$tmp_fixed_val()),j+","+l.$tmp_fixed_val()]):q(l.$greatest_fortune())?q(l.$greatest_fortune())?(j=s.randomizer.$roll_once(6),[X(j,2),j+","+j]):t:a(s,I(s,"rollDice",b,!1,!0),"rollDice",[l,T],null)},2),C(n,"$growth",function(l){return null==l&&(l=1),Z(r.Range.$new(1,l,!1),"map",[],function L(){return(null==L.$$s?this:L.$$s).$growth_step()},{$$arity:0,$$s:this}).$join(" | ")},-1),C(n,"$growth_step",function(){var T,L,s,j,l=this;return T=l.randomizer.$roll_once(6),L=l.randomizer.$roll_once(6),s=l.$get_ability_by_dice(T),j=l.$get_ability_by_dice(L),B(s,j)?"["+T+","+L+"]->("+s+" or "+j+")":"["+T+","+L+"]->("+s+")"},0),C(n,"$get_ability_by_dice",function(l){return["\u5668\u7528\u5ea6","\u654f\u6377\u5ea6","\u7b4b\u529b","\u751f\u547d\u529b","\u77e5\u529b","\u7cbe\u795e\u529b"]["$[]"](m(l,1))},1),C(n,"$get_fumble_table",function(){var l,T;return T=this.$get_table_by_1d6(["\u3053\u306e\u8868\u30922\u56de\u632f\u308a\u3001\u305d\u306e\u4e21\u65b9\u3092\u9069\u7528\u3059\u308b\u3002\uff08\u540c\u3058\u51fa\u76ee\u306b\u3088\u308b\u5f71\u97ff\u306f\u7d2f\u7a4d\u3057\u306a\u3044\uff09\u3002\u3053\u306e\u81ea\u52d5\u5931\u6557\u306b\u3088\u308a\u5f97\u3089\u308c\u308b\u7d4c\u9a13\u70b9\u306f\u3001+50\u70b9\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u3092\u5f37\u5316\u3057\u3066\u3044\u308b\u300c\u5263\u306e\u304b\u3051\u3089\u300d\u306e\u6570\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u306e\u300c\u30ec\u30d9\u30eb\u300d\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u6c7a\u5b9a\u30922\u56de\u884c\u3044\u3001\u3088\u308a\u9ad8\u3044\u65b9\u3092\u63a1\u7528\u3059\u308b","\u5408\u7b97\u30c0\u30e1\u30fc\u30b8\u30922\u500d\u3059\u308b","\u9632\u8b77\u70b9\u7121\u52b9"]),"\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868("+(null==(l=f(T))[1]?t:l[1])+") \u2192 "+(null==l[0]?t:l[0])},0),C(n,"$get_tangle_table",function(){var l,T;return T=this.$get_table_by_1d6(["\u982d\u3084\u9854\uff1a\u7259\u3084\u565b\u307f\u3064\u304d\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u53ca\u3073\u3001\u9b54\u6cd5\u306e\u884c\u4f7f\u3084\u30d6\u30ec\u30b9\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u6b66\u5668\u3084\u76fe\uff1a\u6b66\u5668\u306e\u4f7f\u7528\u4e0d\u53ef\u3001\u53c8\u306f\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u8155\u3084\u624b\uff1a\u6b66\u5668\u3084\u722a\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u76fe\u3092\u6301\u3064\u8155\u65b9\u306e\u8155\u306a\u3089\u305d\u306e\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u811a\u3084\u8db3\uff1a\u79fb\u52d5\u4e0d\u53ef\u3001\u66f4\u306b\u56de\u907f\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b \u203b\u4e21\u8db3\u306b\u7d61\u3093\u3067\u3082\u7d2f\u7a4d\u3057\u306a\u3044","\u80f4\u4f53\uff1a\u751f\u547d\u30fb\u7cbe\u795e\u62b5\u6297\u529b\u3092\u57fa\u6e96\u5024\u306b\u7528\u3044\u308b\u5224\u5b9a\u3092\u9664\u304d\u3001\u3042\u3089\u3086\u308b\u884c\u70ba\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u7279\u6b8a\uff1a\u5c3b\u5c3e\u3084\u7ffc\u306a\u3069\u306b\u547d\u4e2d\u3002\u7d61\u3081\u3089\u308c\u305f\u90e8\u4f4d\u3092\u4f7f\u7528\u3059\u308b\u5224\u5b9a\u306b\u304a\u3044\u3066-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u307e\u305f\u306f\u305d\u3053\u304c\u4f7f\u3048\u3066\u3044\u305f\u3053\u3068\u306b\u3088\u308b\u30dc\u30fc\u30ca\u30b9\u4fee\u6b63\u3092\u5931\u3046 \u203b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u6c7a\u3081\u76f4\u3057"]),"\u7d61\u307f\u52b9\u679c\u8868("+(null==(l=f(T))[1]?t:l[1])+") \u2192 "+(null==l[0]?t:l[0])},0)},Opal.queue(function(r){var Z,P,A,u,d,o,H,k,m,$=[],t=r.nil,e=r.$$$,p=r.module,E=r.klass,M=r.const_set,a=r.eqeqeq,I=r.send,C=r.hash2,x=r.truthy,q=r.send2,K=r.find_super,W=r.def,U=r.range,G=r.rb_plus;return r.top.$require("bcdice/game_system/SwordWorld2_0"),Z=$,P=m=[p($[0],"BCDice")].concat(Z),H=[p(m[0],"GameSystem")].concat(P),k=r.$r(H),A=H,d=[u=E(H[0],k("SwordWorld2_0"),"SwordWorld2_5")].concat(A),o=r.$r(d),u.$$prototype.randomizer=t,M(d[0],"ID","SwordWorld2.5"),M(d[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"),M(d[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5"),M(d[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u5fc5\u6bba\u653b\u6483\u7528\uff09\n\u3000\u300c\uff03\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u7d99\u7d9a\u3055\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09K20#1\u3000\u3000\u3000k10-5@9#2\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r5\n\u3000\u4f8b\uff09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30c9\u30eb\u30a4\u30c9\u306e\u7269\u7406\u9b54\u6cd5\u7528\u8868\u3000(Dru[2-6\u306e\u5024,7-9\u306e\u5024,10-12\u306e\u5024])\n\u3000\u4f8b\uff09Dru[0,3,6]+10-3\n\n\u30fb\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3000(ABT)\n\u3000\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),u.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT","Dru","ABT"),M(d[0],"ABYSS_CURSE_TABLE",e(o("DiceTable"),"D66GridTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868",[["\u300c\u81ea\u50b7\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u3053\u306e\u6b66\u5177\u3092\u88c5\u5099\u4e2d\u306b\u88c5\u5099\u8005\u304c\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3092\u767a\u751f\u3055\u305b\u305f\u6642\u3001\u88c5\u5099\u8005\u306eHP\u304c5\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u5606\u304d\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u8fd1\u304f\u306b\u6575\u304c\u3044\u305f\u308a\u3001\u9577\u3044\u7dca\u5f35\u72b6\u614b\u304c\u7d9a\u304f\u3068\u6d99\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6226\u95d8\u4e2d\u306a\u3089\u300c\u5c04\u7a0b\uff1a\u8853\u8005\uff08\u81ea\u8eab\uff09\u300d\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u4ee5\u5916\u306e\u52b9\u679c\u3067\u5bfe\u8c61\u3092\u9078\u3079\u306a\u304f\u306a\u308b\u3002","\u300c\u512a\u3057\u304d\u300d\u3000\u88c5\u5099\u6642\u3000\u6575\u306b\u540c\u60c5\u3057\u3066\u3057\u307e\u3046\u3002\u6575\u5bfe\u3059\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5bfe\u8c61\u306b\u3059\u308b\u5834\u5408\u3001\u5bfe\u8c61\u306eHP\u304c1\u70b9\u4ee5\u4e0a\u6e1b\u5c11\u3057\u3066\u3044\u308b\u306a\u3089\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u5dee\u5225\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5206\u985e\u306b\u5bfe\u3057\u3066\u4e0e\u3048\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u30fb\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\u3002\u5206\u985e\u306f\u300c\u5206\u985e\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u8106\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u305f\u3073\u3001\u305d\u306e\u30c0\u30e1\u30fc\u30b8\u304c+1\u70b9\u3055\u308c\u308b\u3002","\u300c\u7121\u8b00\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9632\u8b77\u70b9\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e0\uff09\u3002"],["\u300c\u91cd\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u5f37\u5316\u3057\u305f\u6b66\u5177\u306e\u5fc5\u8981\u7b4b\u529b\u304c+2\u3055\u308c\u308b\u3002\u5a01\u529b\u3001\u9632\u8b77\u70b9\u306a\u3069\u306f\u5909\u5316\u306a\u3057\u3002","\u300c\u96e3\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u3044\u304b\u306a\u308b\u5a01\u529b\u8868\u4f7f\u7528\u6642\u3067\u3082\u3001\u2462\u2463\u6b04\u306e\u6570\u5024\u304c\u5a01\u529b\u306b\u95a2\u4fc2\u306a\u304f\u300c0\u300d\u306b\u306a\u308b\uff08\u81ea\u52d5\u5931\u6557\u3067\u306f\u306a\u3044\uff09\u3002","\u300c\u8edf\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u75c5\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u751f\u547d\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u904e\u654f\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5c5e\u6027\u304b\u3089\u53d7\u3051\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u3001\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u4e0a\u6607\u3059\u308b\u3002\u5c5e\u6027\u306f\u300c\u5c5e\u6027\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u967d\u6c17\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u5224\u5b9a\u306b\u5931\u6557\u3059\u308b\u305f\u3073\u3001\u7b11\u3044\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u884c\u52d5\u5224\u5b9a\uff08\u300e\u2160\u300f123\u9801\uff09\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3053\u306e\u52b9\u679c\u306f\u7d2f\u7a4d\u3059\u308b\u3002"],["\u300c\u305f\u3069\u305f\u3069\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u8a71\u3092\u3059\u308b\u6642\u306b\u8a00\u8449\u306b\u8a70\u307e\u3063\u305f\u308a\u3001\u8a00\u3044\u9593\u9055\u3048\u305f\u308a\u3057\u3084\u3059\u304f\u306a\u308b\u3002\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4ee3\u5f01\u3059\u308b\u300d\u3000\u88c5\u5099\u6642\u3000\u81ea\u8eab\u306e\u4f1a\u8a71\u306f\u3001\u305d\u306e\u307e\u307e\u6b66\u5177\u304c\u9b54\u6cd5\u6587\u660e\u8a9e\u306e\u805e\u304d\u53d6\u308a\u3065\u3089\u3044\u58f0\u3067\u8a71\u3059\u3002\u88c5\u5099\u4e2d\u306f\u9b54\u6cd5\u6587\u660e\u8a9e\u4ee5\u5916\u306e\u8a00\u8a9e\u3067\u4f1a\u8a71\u306f\u884c\u3048\u305a\u3001\u5996\u7cbe\u9b54\u6cd5\u3001\u9b54\u52d5\u6a5f\u8853\u3092\u884c\u4f7f\u3067\u304d\u306a\u304f\u306a\u308b\u3002","\u300c\u65bd\u3057\u306f\u53d7\u3051\u306a\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u6226\u95d8\u4e2d\u3001\u300c\u62b5\u6297\uff1a\u4efb\u610f\u300d\u306e\u52b9\u679c\u3092\u53d7\u3051\u5165\u308c\u305f\u5834\u5408\u3001\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6b7b\u306b\u8fd1\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5e38\u306b\u751f\u6b7b\u5224\u5b9a\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u3068\u540c\u3058\u5024\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u304a\u3057\u3083\u308c\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u3092\u5e38\u306b\u83ef\u7f8e\u306b\u98fe\u308a\u305f\u304f\u306a\u308b\u3002\u53ce\u5165\u3092\u5f97\u308b\u305f\u3073\u3001\u305d\u306e1\u5272\u4ee5\u4e0a\u3092\u3053\u306e\u6b66\u5177\u306e\u88c5\u98fe\u306b\u8cbb\u3084\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\uff08\u52b9\u679c\u306a\u3069\u306b\u5909\u5316\u306f\u306a\u3044\uff09\u3002","\u300c\u30de\u30ca\u3092\u5438\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u9b54\u6cd5\u3084\u7df4\u6280\u306a\u3069\u3001\u81ea\u8eab\u306e\u610f\u601d\u3067MP\u3092\u6d88\u8cbb\u3059\u308b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001\u3059\u3079\u3066\u306eMP\u6d88\u8cbb\u304c1\u70b9\u4e0a\u6607\u3059\u308b\u3002"],["\u300c\u920d\u91cd\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u79fb\u52d5\u529b\u304c\u534a\u5206\uff08\u7aef\u6570\u5207\u308a\u4e0a\u3052\uff09\u306b\u306a\u308b\u3002","\u300c\u5b9a\u307e\u3089\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u300a\u30bf\u30fc\u30b2\u30c3\u30c6\u30a3\u30f3\u30b0\u300b\u3068\u305d\u308c\u3092\u524d\u63d0\u3068\u3057\u305f\u6226\u95d8\u7279\u6280\u3092\u7fd2\u5f97\u3057\u3066\u3044\u306a\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u3046\u3002","\u300c\u932f\u4e71\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u8fd1\u63a5\u653b\u6483\u3092\u542b\u3080\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u306e\u5bfe\u8c61\u306b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u969b\u3001\u5bfe\u8c61\u306f\u540c\u3058\u4f4d\u7f6e\uff08\u30a8\u30ea\u30a2\u3001\u5ea7\u6a19\uff09\u306e\u5168\u3066\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff08\u6575\u5473\u65b9\u542b\u3080\uff09\u304b\u3089\u7121\u4f5c\u70ba\u306b\u9078\u3070\u308c\u308b\u3002","\u300c\u8db3\u7d61\u307f\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u305d\u306e\u5834\u3067\u5373\u5ea7\u306b\u8ee2\u5012\u3059\u308b\u3002\u624b\u756a\u4e2d\u306b\u306f\u8d77\u304d\u4e0a\u304c\u308c\u306a\u3044\u3002","\u300c\u6ed1\u308a\u843d\u3061\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u624b\u306b\u88c5\u5099\u307e\u305f\u306f\u4fdd\u6301\u3057\u3066\u3044\u308b\u3082\u306e\u3092\u3059\u3079\u3066\u305d\u306e\u5834\u306b\u843d\u3068\u3059\uff08\u305d\u306e\u624b\u756a\u306e\u4e3b\u52d5\u4f5c\u3067\u62fe\u3046\u4e8b\u306f\u53ef\u80fd\uff09\u3002","\u300c\u60aa\u81ed\u653e\u3064\u300d\u3000\u643a\u884c\u6642\u3000\u5f37\u3044\u60aa\u81ed\u3092\u653e\u3064\u3002\u6240\u6301\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e0d\u5feb\u611f\u3092\u4e0e\u3048\u3001\u96a0\u5bc6\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002"],["\u300c\u919c\u60aa\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6b66\u5177\u306e\u898b\u305f\u76ee\u304c\u60aa\u304f\u3001\u9b45\u529b\u304c\u306a\u3044\u3002\u58f2\u5374\u3059\u308b\u969b\u3001\u57fa\u672c\u53d6\u5f15\u4fa1\u683c\u306e4\u5206\u306e1\u306e\u4fa1\u683c\u3067\u58f2\u5374\u3059\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002","\u300c\u5538\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u304b\u3089\u5e38\u306b\u7fbd\u866b\u304c\u98db\u3073\u4ea4\u3046\u3088\u3046\u306a\u97f3\u304c\u97ff\u304f\u3002\u96a0\u5bc6\u5224\u5b9a\u3001\u5371\u967a\u611f\u77e5\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u3075\u3084\u3051\u305f\u300d\u3000\u643a\u884c\u6642\u3000\u6c34\u3092\u5438\u3063\u305f\u3088\u3046\u306b\u3075\u3084\u3051\u305f\u8cea\u611f\u3092\u3057\u3066\u3044\u308b\u3002\u8ffd\u52a0\u30c0\u30e1\u30fc\u30b8-1\uff08\u6b66\u5668\uff09\u3001\u9632\u8b77\u70b9-1\uff08\u93a7\u3001\u76fe\uff09\u3002\u75c5\u6c17\u5c5e\u6027\u306e\u52b9\u679c\u306b\u5bfe\u3059\u308b\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u53e4\u50b7\u306e\u300d\u3000\u643a\u884c\u6642\u3000HP\u3092\u56de\u5fa9\u3059\u308b\u52b9\u679c\uff08\u4f11\u606f\u306b\u3088\u308b\u56de\u5fa9\u3092\u542b\u3080\uff09\u3092\u53d7\u3051\u305f\u5834\u5408\u3001\u305d\u306e\u56de\u5fa9\u91cf\u304c1\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u307e\u3070\u3086\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5149\u306a\u3069\u3092\u5f3e\u3044\u3066\u5f37\u304f\u8f1d\u304f\u3002\u81ea\u8eab\u306f\u5e38\u306b\u8996\u754c\u304c\u60aa\u3044\u4e8b\u306b\u3088\u308b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6804\u5149\u306a\u304d\u300d\u3000\u643a\u884c\u6642\u3000\u884c\u70ba\u5224\u5b9a\u3067\u81ea\u52d5\u6210\u529f\u3057\u305f\u969b\u3001\u81ea\u52d5\u6210\u529f\u3068\u306f\u6271\u308f\u305a\u30012d\u3092\u632f\u308a\u76f4\u3057\u3001\u305d\u306e\u5f8c\u306e\u51fa\u76ee\u306b\u5f93\u3046\u3002\u3053\u306e\u52b9\u679c\u306f1\u65e5\u306b1\u56de\u306e\u307f\u767a\u63ee\u3055\u308c\u308b\u3002"],["\u300c\u6b63\u76f4\u8005\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u5618\u3001\u65b9\u4fbf\u304c\u3059\u3050\u3070\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u771f\u507d\u5224\u5b9a\u306e\u5bfe\u8c61\u3068\u306a\u308b\u5834\u5408\u3001-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4e57\u308a\u7269\u9154\u3044\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u63fa\u308c\u306b\u5f31\u304f\u306a\u308b\u3002\u81ea\u8eab\u306e\u8db3\u4ee5\u5916\u306e\u624b\u6bb5\u306710\u5206\u4ee5\u4e0a\u79fb\u52d5\u3057\u305f\u5f8c\u30011\u6642\u9593\u3001\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u78a7\u3092\u53ad\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u81ea\u7136\u306e\u4e2d\u3067\u306f\u843d\u3061\u7740\u304b\u306a\u304f\u306a\u308b\u3002\u81ea\u7136\u74b0\u5883\uff08\u300e\u2160\u300f108\u9801\uff09\u3067\u306f\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6211\u6162\u3067\u304d\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u30bb\u30c3\u30b7\u30e7\u30f3\u4e2d\u306b1\u65e5\u306e\u59cb\u307e\u308a\u3092\u8fce\u3048\u308b\u305f\u3073\u3001\u8da3\u5473\u3084\u55dc\u597d\u54c1\u306a\u3069\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\xd710\u300d\u30ac\u30e1\u30eb\u3092\u51fa\u8cbb\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\u8da3\u5473\u3084\u55dc\u597d\u54c1\u304c\u6d88\u8cbb\u3067\u304d\u306a\u3044\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u7fcc\u65e5\u306e\u671d\u307e\u3067\u6700\u5927HP\u3001\u6700\u5927MP\u304c\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u3064\u304d\u307e\u3068\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u3053\u306e\u6b66\u5177\u304c\u6c17\u304c\u3064\u3051\u3070\u8eab\u306e\u56de\u308a\u306b\u3042\u308b\u3002\u3053\u306e\u6b66\u5177\u4ee5\u5916\u3067\u306e\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\uff08\u6b66\u5668\uff09\u3001\u56de\u907f\u529b\u5224\u5b9a\uff08\u93a7\u3001\u76fe\uff09\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u306e\u308d\u307e\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u958b\u59cb\u51e6\u7406\u306e\u300c\u6226\u95d8\u6e96\u5099\u300d\u3092\u3044\u3063\u3055\u3044\u884c\u3048\u306a\u304f\u306a\u308b\u3002"]])),M(d[0],"ABYSS_CURSE_CATEGORY_TABLE",e(o("DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5206\u985e\u6c7a\u5b9a\u8868",["\u86ee\u65cf","\u52d5\u7269","\u690d\u7269","\u30a2\u30f3\u30c7\u30c3\u30c9","\u9b54\u6cd5\u751f\u7269","\u300c\u86ee\u65cf\u300d\u300c\u52d5\u7269\u300d\u300c\u690d\u7269\u300d\u300c\u30a2\u30f3\u30c7\u30c3\u30c9\u300d\u300c\u9b54\u6cd5\u751f\u7269\u300d\u304b\u3089\u4efb\u610f"],["\u9b54\u52d5\u6a5f","\u5e7b\u7363","\u5996\u7cbe","\u9b54\u795e","\u4eba\u65cf","\u300c\u9b54\u52d5\u6a5f\u300d\u300c\u5e7b\u7363\u300d\u300c\u5996\u7cbe\u300d\u300c\u9b54\u795e\u300d\u300c\u4eba\u65cf\u300d\u304b\u3089\u4efb\u610f"])),M(d[0],"ABYSS_CURSE_ATTR_TABLE",e(o("DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5c5e\u6027\u6c7a\u5b9a\u8868",["\u571f","\u6c34\u30fb\u6c37","\u708e","\u98a8","\u96f7","\u7d14\u7c8b\u30a8\u30cd\u30eb\u30ae\u30fc"],["\u65ad\u7a7a","\u885d\u6483","\u6bd2","\u75c5\u6c17","\u546a\u3044","\u7cbe\u795e\u52b9\u679c"])),W(u,"$eval_game_system_specific_command",function c(n){var g,v=this,b=t,T=t;return delete c.$$p,a(/^dru\[(\d+),(\d+),(\d+)\]/i,g=n)?(b=I(o("Regexp").$last_match().$captures(),"map",[],"to_i".$to_proc()),T=e(o("Command"),"Parser").$new(/dru\[\d+,\d+,\d+\]/i,C(["round_type"],{round_type:e(e(o("BCDice"),"RoundType"),"CEIL")})).$parse(n),x(T)?v.$druid_dice(T,b):t):a("ABT",g)?v.$get_abyss_curse_table():q(v,K(v,"eval_game_system_specific_command",c,!1,!0),"eval_game_system_specific_command",[n],null)},1),W(u,"$rating_parser",function(){return o("RatingParser").$new(C(["version"],{version:"v2_5"}))},0),W(u,"$druid_dice",function(n,i){var b,l,T,L,s,g=t;return b=(g=this.randomizer.$roll_barabara(2,6)).$sum(),l=a(U(2,6,!1),T=b)?0:a(U(7,9,!1),T)?1:a(U(10,12,!1),T)?2:t,L=i["$[]"](l),s=G(L,n.$modify_number()),["("+n.$command().$capitalize()+o("Format").$modifier(n.$modify_number())+")","2D["+g.$join(",")+"]="+b,""+L+o("Format").$modifier(n.$modify_number()),s].$join(" \uff1e ")},2),W(u,"$get_abyss_curse_table",function(){var g,n=this,i=t,v=t;return i=o("ABYSS_CURSE_TABLE").$roll(n.randomizer),v=a(14,g=i.$value())?o("ABYSS_CURSE_CATEGORY_TABLE").$roll(n.randomizer).$to_s():a(25,g)?o("ABYSS_CURSE_ATTR_TABLE").$roll(n.randomizer).$to_s():t,[i.$to_s(),v].$compact().$join("\n")},0)})}}]);